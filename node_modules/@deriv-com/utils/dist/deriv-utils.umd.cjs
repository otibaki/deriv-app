(function(s,p){typeof exports=="object"&&typeof module<"u"?p(exports):typeof define=="function"&&define.amd?define(["exports"],p):(s=typeof globalThis<"u"?globalThis:s||self,p(s["@deriv/utils"]={}))})(this,function(s){"use strict";const p={real:"green.derivws.com",demo:"blue.derivws.com"},P={"deriv.app":"16929","app.deriv.com":"16929","staging-app.deriv.com":"16303","app.deriv.me":"1411","staging-app.deriv.me":"1411","app.deriv.be":"30767","staging-app.deriv.be":"31186","binary.com":"1","test-app.deriv.com":"51072","p2p.deriv.com":"61859","staging-p2p.deriv.com":"62019","api.deriv.com":"36544","staging-api.deriv.com":"36545","smarttrader.deriv.com":"22168","staging-smarttrader.deriv.com":"22169","staging-dbot.deriv.com":"29934","staging-dbot.deriv.me":"29934","staging-dbot.deriv.be":"29934","dbot.deriv.com":"65555","dbot.deriv.be":"65556","dbot.deriv.me":"65557"},D="deriv",q=Object.freeze(Object.defineProperty({__proto__:null,appBrand:D,domainAppId:P,environments:p},Symbol.toStringTag,{value:"Module"})),C={AAD:2,AED:2,AFN:2,ALL:2,AMD:2,ANG:2,AOA:2,ARS:2,AUD:2,AWG:2,AZN:2,BAM:2,BBD:2,BCH:8,BDT:2,BGN:2,BHD:3,BIF:0,BMD:2,BND:2,BOB:2,BOV:2,BRL:2,BSD:2,BTC:8,BTN:2,BUSD:2,BWP:2,BYN:2,BZD:2,CAD:2,CDF:2,CHE:2,CHF:2,CHW:2,CLF:4,CLP:0,CNY:2,COP:2,COU:2,CRC:2,CUC:2,CUP:2,CVE:2,CZK:2,DAI:2,DJF:0,DKK:2,DOP:2,DZD:2,EGP:2,ERN:2,ETB:2,ETC:8,ETH:8,EUR:2,EURS:2,eUSDT:2,FJD:2,FKP:2,GBP:2,GEL:2,GHS:2,GIP:2,GMD:2,GNF:0,GTQ:2,GYD:2,HKD:2,HNL:2,HRK:2,HTG:2,HUF:2,IDK:0,IDR:2,ILS:2,INR:2,IQD:3,IRR:2,ISK:0,JMD:2,JOD:3,JPY:0,KES:2,KGS:2,KHR:2,KMF:0,KPW:2,KRW:0,KWD:3,KYD:2,KZT:2,LAK:2,LBP:2,LKR:2,LRD:2,LSL:2,LTC:8,LYD:3,MAD:2,MDL:2,MGA:2,MKD:2,MMK:2,MNT:2,MOP:2,MRU:2,MUR:2,MVR:2,MWK:2,MXN:2,MXV:2,MYR:2,MZN:2,NAD:2,NGN:2,NIO:2,NOK:2,NPR:2,NZD:2,OMR:3,PAB:2,PAX:2,PEN:2,PGK:2,PHP:2,PKR:2,PLN:2,PYG:0,QAR:2,RON:2,RSD:2,RUB:2,RWF:0,SAR:2,SBD:2,SCR:2,SDG:2,SEK:2,SGD:2,SHP:2,SLL:2,SOS:2,SRD:2,SSP:2,STN:2,SVC:2,SYP:2,SZL:2,THB:2,TJS:2,TMT:2,TND:3,TOP:2,TRY:2,TTD:2,TUSD:2,tUSDT:2,TWD:2,TZS:2,UAH:2,UGX:0,USB:2,USD:2,USDC:2,USDK:2,UST:2,USN:2,UYI:0,UYU:2,UYW:4,UZS:2,VES:2,VND:0,VUV:0,WST:2,XAF:0,XCD:2,XOF:0,XPF:0,YER:2,ZAR:2,ZMW:2,ZWL:2},ee=Object.freeze(Object.defineProperty({__proto__:null,precision:C},Symbol.toStringTag,{value:"Module"})),O=["PNG","JPG","JPEG","GIF","PDF"],te=Object.freeze(Object.defineProperty({__proto__:null,supportedDocumentFormats:O},Symbol.toStringTag,{value:"Module"})),T="client.active_loginid",re="client.account_list",ne="client.verify_email",R="config.app_id",U="config.server_url",S="i18n_language",oe=Object.freeze(Object.defineProperty({__proto__:null,accountList:re,activeLoginid:T,configAppId:R,configServerURL:U,i18nLanguage:S,lastVerifyEmail:ne,p2pArchiveMessage:"should_not_show_auto_archive_message_again",p2pOrderIds:"order_ids",p2pShowFollowUserGuide:"should_show_p2p_follow_user_guide",p2pShowGuide:"should_show_p2p_guide",traderLayout:"trader.layout",uiExpandAccountSwitcher:"ui.expand_account_switcher",uiShowReportsDrawer:"ui.show_report_drawer",uiTheme:"ui.theme"},Symbol.toStringTag,{value:"Module"})),v="deriv.com",M="deriv.me",N="deriv.be",$=[v,N,M],y=typeof window<"u"&&window.location.hostname.split("app.")[1],l=$.includes(y)?y:v,ae=`https://bot.${l}`,ie=`https://staging-bot.${l}`,se=`https://app.${l}`,ce=`https://staging-app.${l}`,E=`https://${l}`,B=`https://eu.${l}`,de=`https://staging.${l}`,le=l,ue=`https://smarttrader.${l}`,ge=`https://staging-smarttrader.${l}`,me=`https://p2p.${l}`,pe=`https://staging-p2p.${l}`,fe="https://wa.me/35699578341",Se={lang:"lang",action:"action"},j="https://www.cloudflare.com/cdn-cgi/trace",he=Object.freeze(Object.defineProperty({__proto__:null,baseDomain:y,binaryBotProduction:ae,binaryBotStaging:ie,cloudflareTrace:j,deriv:v,derivAppProduction:se,derivAppStaging:ce,derivBe:N,derivComProduction:E,derivComProductionEU:B,derivComStaging:de,derivHost:le,derivMe:M,derivP2pProduction:me,derivP2pStaging:pe,domain:l,queryParameters:Se,smartTraderProduction:ue,smartTraderStaging:ge,supportedDomains:$,whatsApp:fe},Symbol.toStringTag,{value:"Module"})),Ae={addressPermittedSpecialCharacters:". , ' : ; ( ) ° @ # / -"},De={address:/^[\p{L}\p{Nd}\s'’.,:;()\\x{b0}@#/-]{0,70}$/u,addressCity:new RegExp("^\\p{L}[\\p{L}\\s'.-]{0,49}$","u"),addressState:/^[\p{L}\p{Nd}\s'.,(),-;]{0,100}$/u,barrier:/^(?=.{1,20}$)[+-]?[0-9]+\.?[0-9]*$/,decimal:/^\d*(\.\d+)?$/,integer:/^\d+$/,postalOfficeBoxNumber:/p[.\s]+o[.\s]+box/i,email:/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,63}$/,password:/^(?=.*[a-z])(?=.*\d)(?=.*[A-Z])[!-~]{8,25}$/,affilliatePassword:/^(?=.*[a-z])(?=.*[0-9])(?=.*[A-Z])[ -~]{6,50}$/,paymentAgentEmail:/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{1,255}$/,postalCode:/^([A-Za-z0-9][A-Za-z0-9\s-]{0,20})?$/,taxIdentificationNumber:/^(?!^$|\s+)[A-Za-z0-9.\/\s-]{0,25}$/,phoneNumber:/^\+((-|\s)*[0-9]){9,20}$/,fileType:/(image|application)\/(jpe?g|pdf|png)$/,formattedCardNumber:/(^\d{4})\s(\d{2}X{2})\s(X{4})\s(\d{4}$)/,invalidFormattedCardNumberCharacters:/[^\dX\s]/,tradingPlatformInvestorPassword:/^(?=.*[a-z])(?=.*[0-9])(?=.*[A-Z])(?=.*[!@#$%^&*()+\-=\[\]{};':\"|,\.<>\?_~])[ -~]{8,16}$/,letterSymbols:/^[A-Za-z]+([a-zA-Z.' -])*[a-zA-Z.' -]+$/,name:/^(?!.*\s{2,})(?!\s)[\p{L}\s'.-]{1,50}$/u,general:/[`~!@#$%^&*)(_=+[}{\]\\/";:?><|]+/,lowercase:/[a-z]/,number:/\d/,specialCharacter:/\W/,uppercase:/[A-Z]/,between8and16Characters:/^.{8,16}$/,between8and25Characters:/^.{8,25}$/},ve=Object.freeze(Object.defineProperty({__proto__:null,messagesHints:Ae,patterns:De},Symbol.toStringTag,{value:"Module"})),F={brandName:"Deriv",domainName:"Deriv.com"},G={fx:"Deriv (FX) Ltd",maltainvest:"Deriv Investments (Europe) Limited",svg:"Deriv (SVG) LLC",v:"Deriv (V) Ltd"},I={trader:"Deriv Trader",dBot:"Deriv Bot",mt5:"Deriv MT5",cTrader:"Deriv cTrader",derivX:"Deriv X",smartTrader:"SmartTrader",bBot:"Binary Bot",go:"Deriv GO"},ye=Object.freeze(Object.defineProperty({__proto__:null,brandConfig:F,landingCompanies:G,platforms:I},Symbol.toStringTag,{value:"Module"})),Y=/(ALP-|AMN-|ANA-|ANE-|ANG-|AQM-|ARS-|ART-|ATU-|BAC-|BLA-|BRQ-|CAG-|CAM-|CAN-|CAZ-|CDL-|CDY-|CLT-|CRO-|CUN-|DIG-|DRA-|DUA-|DUB-|DVC-|ELE-|ELS-|EML-|EVA-|EVR-|FIG-|FLA-|FRL-|GLK-|HMA-|HW-|HWI-|INE-|JAT-|JEF-|JER-|JKM-|JNY-|JSC-|LDN-|LIO-|LON-|LUA-|LYA-|LYO-|MAR-|MED-|MHA-|MLA-|MRD-|MYA-|NCE-|NEO-|NOH-|NOP-|OCE-|PAR-|PIC-|POT-|PPA-|PRA-|RNE-|SEA-|SLA-|SNE-|SPN-|STK-|TAH-|TAS-|TET-|TRT-|VCE-|VIE-|VKY-|VNS-|VOG-|VTR-|WAS-|WKG-|WLZ-|JAD-|MLD-|RTE-|NAM-|NEN-|BAL-|JLN-|YAL-|MGA-|FGD-|XYAO-|BON-|ALN-|ALT-|BRA-|DBY2-|STG-|MAO-|LEM-|GOA-|FOA-|MNA-|LNA-)/,_e=Object.freeze(Object.defineProperty({__proto__:null,huaweiDevicesRegex:Y},Symbol.toStringTag,{value:"Module"})),we=Object.freeze(Object.defineProperty({__proto__:null,formatMoney:(e,t)=>{try{const{locale:r="en-US",currency:n,decimalPlaces:o}=t||{},c=C[n??"USD"],a=o||c;return new Intl.NumberFormat(r,{minimumFractionDigits:a,maximumFractionDigits:a}).format(e)}catch{return e.toString()}},getAdjustedDate:(e,t="days",r="add")=>{if(e<0)throw new Error("Amount must be a positive number.");const n=new Date,o=r==="add"?e:-e;return t==="years"?n.setFullYear(n.getFullYear()+o):t==="days"&&n.setDate(n.getDate()+o),n},getFormattedDateString:(e,t)=>{let r;const{dateOptions:n={day:"2-digit",month:"2-digit",year:"numeric"},format:o="YYYY-MM-DD",unix:c=!1}=t||{},a={...n};if(typeof e=="number"&&c)r=new Date(e*1e3);else if(typeof e=="string"||e instanceof Date){if(r=new Date(e),isNaN(r.getTime()))throw new Error("Invalid date input")}else throw new Error("Invalid date input");switch(o){case"DD MMM YYYY":a.day="2-digit",a.month="short",a.year="numeric";break;case"MMM DD YYYY":return a.day="2-digit",a.month="short",a.year="numeric",r.toLocaleDateString("en-GB",a).replace(/(\d{2}) (\w{3}) (\d{4})/,"$2 $1 $3");case"DD-MM-YYYY":return a.day="2-digit",a.month="2-digit",a.year="numeric",r.toLocaleDateString("en-GB",a).replace(/(\d{2})\/(\d{2})\/(\d{4})/,"$1-$2-$3");default:a.year="numeric",a.month="2-digit",a.day="2-digit";break}const i=r.toLocaleDateString("en-GB",a).replace(/(\d{2}) (\w{3,4}) (\d{4})/,(d,g,u,f)=>`${g} ${u.slice(0,3)} ${f}`);return o==="YYYY-MM-DD"?i.replace(/(\d{2})\/(\d{2})\/(\d{4})/,"$3-$2-$1"):i},getFormattedTimeString:(e,t=!1)=>{let r;if(typeof e=="number"&&t)r=new Date(e*1e3);else if(typeof e=="string"||e instanceof Date){if(r=new Date(e),isNaN(r.getTime()))throw new Error("Invalid date input")}else throw new Error("Invalid date input");return`${r.getUTCHours().toString().padStart(2,"0")}:${r.getUTCMinutes().toString().padStart(2,"0")}:${r.getUTCSeconds().toString().padStart(2,"0")} GMT`},parseCryptoLongcode:e=>{const t=e.split(/,\s/),r=/:\s([0-9a-zA-Z]+.{25,28})/gm.exec(t[0]),n=r==null?void 0:r[1],o=/:\s([0-9a-zA-Z]+.{25,34})/gm.exec(t[1]),c=o==null?void 0:o[1];return{addressHash:n,blockchainHash:c,splitLongcode:t}}},Symbol.toStringTag,{value:"Module"})),z=2560,be=.9,Le=4,Z=({src:e,filename:t,options:r})=>{const{maxWidth:n=z,quality:o=be}=r||{};return new Promise((c,a)=>{const i=new Image;i.src=e,i.onload=()=>{const d=document.createElement("canvas"),g=d.getContext("2d");if(!g||!(g instanceof CanvasRenderingContext2D))return a(new Error("Failed to get 2D context"));if(i.naturalWidth>n){const u=z,f=u/i.naturalWidth;d.width=u,d.height=i.naturalHeight*f}else d.width=i.naturalWidth,d.height=i.naturalHeight;g.fillStyle="transparent",g.fillRect(0,0,d.width,d.height),g.save(),g.drawImage(i,0,0,d.width,d.height),d.toBlob(u=>{if(!u)return;const f=t.replace(/\.[^/.]+$/,".jpg"),L=new Blob([u],{type:"image/jpeg"});L.lastModifiedDate=Date.now(),L.name=f,c(L)},"image/jpeg",o)}})},K=e=>new Promise(t=>{const r=new FileReader;r.readAsDataURL(e),r.onloadend=()=>{var n;t({src:((n=r.result)==null?void 0:n.toString())||"",filename:e.name})}}),H=e=>e?O.some(t=>e.toUpperCase().endsWith(t)):!1,Pe=e=>new Promise(t=>{H(e.name)?K(e).then(r=>{Z(r).then(t)}):t(e)});function Ce(e,t=Le){const r=new Uint8Array(t);return new DataView(r.buffer).setUint32(0,e),r}const Oe=Object.freeze(Object.defineProperty({__proto__:null,compressImage:Z,compressImageFile:Pe,convertToBase64:K,generateChunks:(e,{chunkSize:t=16384})=>{const r=[];for(let n=0;n<e.length;n++){const o=e[n];n%t===0?r.push([o]):r[r.length-1].push(o)}return r.map(n=>new Uint8Array(n)).concat(new Uint8Array([]))},isSupportedImageFormat:H,numToUint8Array:Ce,readFile:e=>{const t=new FileReader;return new Promise(r=>{t.onload=()=>{const n={filename:e.name,buffer:t.result,fileSize:e.size};r(n)},t.onerror=()=>{r({message:`Unable to read file ${e.name}`})},t.readAsArrayBuffer(e)})}},Symbol.toStringTag,{value:"Module"})),m=e=>{const t=localStorage.getItem(e);if(t!=="undefined"){if(t===null||t==="null")return null;try{return JSON.parse(t)}catch{return null}}},Te=Object.freeze(Object.defineProperty({__proto__:null,getValue:m,setValue:(e,t)=>{localStorage.setItem(e,JSON.stringify(t))}},Symbol.toStringTag,{value:"Module"})),W=e=>Object.keys(e).sort().reduce((t,r)=>(t[r]=e[r],t),{}),Re=async e=>{const t=new TextEncoder().encode(JSON.stringify(W(e))),r=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(r)).map(c=>("00"+c.toString(16)).slice(-2)).join("")},V=(e,t)=>Array.isArray(e)&&Array.isArray(t)?t.map((r,n)=>V(e[n],r)):typeof e=="object"&&e!==null&&typeof t=="object"&&t!==null?k(e,t):t,k=(e,...t)=>{for(const r of t)for(const n in r)r[n]===null||r[n]===void 0||(e[n]=V(e[n],r[n]));return e},Ue=Object.freeze(Object.defineProperty({__proto__:null,hashObject:Re,merge:k,sortObjectByKeys:W},Symbol.toStringTag,{value:"Module"}));function Me(){let e,t;return{promise:new Promise((n,o)=>{e=n,t=o}),resolve:e,reject:t}}const Ne=Object.freeze(Object.defineProperty({__proto__:null,createPromise:Me},Symbol.toStringTag,{value:"Module"})),J=()=>{const t=new URLSearchParams(window.location.search).get("acct1");return m(T)||t},x=e=>e&&!/^VR/.test(e)?"real":"demo",_=()=>{const e=m(R);if(e)return e;const t=window.location.hostname,r=P[t];return r||"36300"},$e=Object.freeze(Object.defineProperty({__proto__:null,getActiveLoginid:J,getAppId:_,getEnvironmentFromLoginid:x},Symbol.toStringTag,{value:"Module"})),Ee=()=>{const e=[],t=[],r=new URLSearchParams(window.location.search);for(const[o,c]of r.entries()){const a=o.match(/^acct(\d+)/),i=o.match(/^token(\d+)/),d=o.match(/^cur(\d+)/);a&&(e[+a[1]-1]={...e[+a[1]-1]||{},loginid:c}),i&&(e[+i[1]-1]={...e[+i[1]-1]||{},token:c}),d&&(e[+d[1]-1]={...e[+d[1]-1]||{},currency:c}),(/acct/.test(o)||/token/.test(o)||/cur/.test(o))&&t.push(o)}return{loginInfo:e.filter(o=>["loginid","token","currency"].every(c=>Object.keys(o).includes(c))),paramsToDelete:t}},Be=e=>{if(e!=null&&e.length)return e.find(t=>/^VR/.test(t.loginid))||e[0]},je=e=>{const t=new URLSearchParams(window.location.search);e.forEach(n=>t.delete(n));const r=`${window.location.pathname}${t.toString()?`?${t.toString()}`:""}`;window.history.pushState(null,"",r)},Fe=()=>{const e=m(S)??"EN";return`https://oauth.deriv.com/oauth2/authorize?app_id=${_()}&l=${e}&brand=${D}`},X=()=>{const e=m(U);if(e)return e;const t=J();return p[x(t)]},Ge=()=>{const e=X(),t=m(S)??"EN";return`wss://${e}/websockets/v3?app_id=${_()}&l=${t}&brand=${D}`},Ie=e=>new URLSearchParams(window.location.search).get(e),w=e=>e.replace(/(^\/|\/$|[^a-zA-Z0-9-_./()#])/g,""),Ye=Object.freeze(Object.defineProperty({__proto__:null,filterSearchParams:je,getDefaultActiveAccount:Be,getDerivStaticURL:(e,t)=>{var o;const r=t!=null&&t.isEU?B:E;let n=((o=m(S))==null?void 0:o.toLowerCase())??"en";return n=n==="en"?"":`/${n.replace("_","-")}`,t!=null&&t.isDocument?`${r}/${w(e)}`:`${r}${n}/${w(e)}`},getLoginInfoFromURL:Ee,getOauthURL:Fe,getQueryParameter:Ie,getServerURL:X,getWebsocketURL:Ge,isDomainAllowed:e=>/^(((.*)\.)?(localhost:8443|pages.dev|binary\.(sx|com)|deriv.(com|me|be|dev)))$/.test(e),normalizePath:w},Symbol.toStringTag,{value:"Module"})),ze=Object.freeze(Object.defineProperty({__proto__:null,getBrandWebsiteName:()=>F.domainName,getLegalLandingCompany:e=>G[e],getPlatformName:e=>I[e]},Symbol.toStringTag,{value:"Module"})),Q=e=>Y.test(e),Ze=Object.freeze(Object.defineProperty({__proto__:null,mobileOSDetectAsync:async()=>{const e=window,t=navigator,r=t.userAgent??e.opera??"";if(/windows phone/i.test(r))return"Windows Phone";if(/android/i.test(r)){if(t.userAgentData){const n=await t.userAgentData.getHighEntropyValues(["model"]);if(Q((n==null?void 0:n.model)||""))return"huawei"}else if(Q(r)||/huawei/i.test(r))return"huawei";return"Android"}return/iPad|iPhone|iPod/.test(r)&&!e.MSStream?"iOS":"unknown"}},Symbol.toStringTag,{value:"Module"}));/*! js-cookie v3.0.5 | MIT */function h(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}var Ke={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function b(e,t){function r(o,c,a){if(!(typeof document>"u")){a=h({},t,a),typeof a.expires=="number"&&(a.expires=new Date(Date.now()+a.expires*864e5)),a.expires&&(a.expires=a.expires.toUTCString()),o=encodeURIComponent(o).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var d in a)a[d]&&(i+="; "+d,a[d]!==!0&&(i+="="+a[d].split(";")[0]));return document.cookie=o+"="+e.write(c,o)+i}}function n(o){if(!(typeof document>"u"||arguments.length&&!o)){for(var c=document.cookie?document.cookie.split("; "):[],a={},i=0;i<c.length;i++){var d=c[i].split("="),g=d.slice(1).join("=");try{var u=decodeURIComponent(d[0]);if(a[u]=e.read(g,u),o===u)break}catch{}}return o?a[o]:a}}return Object.create({set:r,get:n,remove:function(o,c){r(o,"",h({},c,{expires:-1}))},withAttributes:function(o){return b(this.converter,h({},this.attributes,o))},withConverter:function(o){return b(h({},this.converter,o),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var He=b(Ke,{path:"/"});let A=null;const We=Object.freeze(Object.defineProperty({__proto__:null,getCountry:async()=>{var t;if(A)return A;const e=(t=JSON.parse(He.get("website_status")||"{}"))==null?void 0:t.clients_country;return A=(async()=>{var r;try{const n=await fetch(j).catch(()=>null);if(!n)return e||"";const o=await n.text().catch(()=>"");return o?((r=Object.fromEntries(o.split(`
`).map(a=>a.split("=",2))).loc)==null?void 0:r.toLowerCase())||e||"":e||""}catch{return e||""}})(),A}},Symbol.toStringTag,{value:"Module"}));s.AppIDConstants=q,s.BrandConstants=ye,s.BrandUtils=ze,s.CountryUtils=We,s.CurrencyConstants=ee,s.DocumentConstants=te,s.FormatUtils=we,s.ImageUtils=Oe,s.LocalStorageConstants=oe,s.LocalStorageUtils=Te,s.MobileDevicesConstants=_e,s.OSDetectionUtils=Ze,s.ObjectUtils=Ue,s.PromiseUtils=Ne,s.URLConstants=he,s.URLUtils=Ye,s.ValidationConstants=ve,s.WebSocketUtils=$e,Object.defineProperty(s,Symbol.toStringTag,{value:"Module"})});
