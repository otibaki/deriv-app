{"version":3,"file":"GrowthBookClient.js","names":["SDK_VERSION","loadSDKVersion","GrowthBookClient","constructor","options","version","_options","debug","ready","_features","_experiments","log","bind","setPayload","payload","_payload","data","decryptPayload","decryptionKey","_decryptedPayload","features","experiments","savedGroups","initSync","encryptedExperiments","encryptedFeatures","Error","startStreaming","init","cacheSettings","configureCache","success","source","res","_refresh","allowStale","refreshFeatures","getApiInfo","getApiHosts","apiHost","getClientKey","clientKey","getPayload","getFeatures","getDecryptedPayload","timeout","skipCache","streaming","instance","disableCache","backgroundSync","getGlobalAttributes","globalAttributes","setGlobalAttributes","attributes","destroy","unsubscribe","undefined","runInlineExperiment","experiment","userContext","result","runExperiment","_getEvalContext","user","global","_getGlobalContext","stack","evaluatedFeatures","Set","enabled","qaMode","forcedFeatureValues","forcedVariations","trackingCallback","onFeatureUsage","isOn","key","evalFeature","on","isOff","off","getFeatureValue","defaultValue","value","id","_evalFeature","msg","ctx","console","setTrackingCallback","callback","applyStickyBuckets","partialContext","stickyBucketService","stickyBucketAssignmentDocs","getAllStickyBucketAssignmentDocs","saveStickyBucketAssignmentDoc","doc","saveAssignments","createScopedInstance","UserScopedGrowthBook","gb","_gb","_userContext"],"sources":["../../src/GrowthBookClient.ts"],"sourcesContent":["import type {\n  ApiHost,\n  ClientKey,\n  Experiment,\n  FeatureApiResponse,\n  FeatureResult,\n  RefreshFeaturesOptions,\n  Result,\n  WidenPrimitives,\n  EvalContext,\n  InitOptions,\n  InitResponse,\n  InitSyncOptions,\n  GlobalContext,\n  UserContext,\n  ClientOptions,\n  FeatureDefinitions,\n  AutoExperiment,\n  TrackingCallbackWithUser,\n  Attributes,\n} from \"./types/growthbook\";\nimport { loadSDKVersion } from \"./util\";\nimport {\n  configureCache,\n  refreshFeatures,\n  startStreaming,\n  unsubscribe,\n} from \"./feature-repository\";\nimport {\n  runExperiment,\n  evalFeature as _evalFeature,\n  getAllStickyBucketAssignmentDocs,\n  decryptPayload,\n  getApiHosts,\n} from \"./core\";\nimport { StickyBucketService } from \"./sticky-bucket-service\";\n\nconst SDK_VERSION = loadSDKVersion();\n\nexport class GrowthBookClient<\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  AppFeatures extends Record<string, any> = Record<string, any>\n> {\n  public debug: boolean;\n  public ready: boolean;\n  public version: string;\n\n  // Properties and methods that start with \"_\" are mangled by Terser (saves ~150 bytes)\n  private _options: ClientOptions;\n\n  private _features: FeatureDefinitions;\n  private _experiments: AutoExperiment[];\n  private _payload: FeatureApiResponse | undefined;\n  private _decryptedPayload: FeatureApiResponse | undefined;\n\n  constructor(options?: ClientOptions) {\n    options = options || {};\n    // These properties are all initialized in the constructor instead of above\n    // This saves ~80 bytes in the final output\n    this.version = SDK_VERSION;\n    this._options = options;\n    this.debug = !!options.debug;\n    this.ready = false;\n    this._features = {};\n    this._experiments = [];\n\n    this.log = this.log.bind(this);\n  }\n\n  public async setPayload(payload: FeatureApiResponse): Promise<void> {\n    this._payload = payload;\n    const data = await decryptPayload(payload, this._options.decryptionKey);\n    this._decryptedPayload = data;\n    if (data.features) {\n      this._features = data.features;\n    }\n    if (data.experiments) {\n      this._experiments = data.experiments;\n    }\n    if (data.savedGroups) {\n      this._options.savedGroups = data.savedGroups;\n    }\n    this.ready = true;\n  }\n\n  public initSync(options: InitSyncOptions): GrowthBookClient<AppFeatures> {\n    const payload = options.payload;\n\n    if (payload.encryptedExperiments || payload.encryptedFeatures) {\n      throw new Error(\"initSync does not support encrypted payloads\");\n    }\n\n    this._payload = payload;\n    this._decryptedPayload = payload;\n    if (payload.features) {\n      this._features = payload.features;\n    }\n    if (payload.experiments) {\n      this._experiments = payload.experiments;\n    }\n\n    this.ready = true;\n\n    startStreaming(this, options);\n\n    return this;\n  }\n\n  public async init(options?: InitOptions): Promise<InitResponse> {\n    options = options || {};\n\n    if (options.cacheSettings) {\n      configureCache(options.cacheSettings);\n    }\n\n    if (options.payload) {\n      await this.setPayload(options.payload);\n      startStreaming(this, options);\n      return {\n        success: true,\n        source: \"init\",\n      };\n    } else {\n      const { data, ...res } = await this._refresh({\n        ...options,\n        allowStale: true,\n      });\n      startStreaming(this, options);\n      await this.setPayload(data || {});\n      return res;\n    }\n  }\n\n  public async refreshFeatures(\n    options?: RefreshFeaturesOptions\n  ): Promise<void> {\n    const res = await this._refresh({\n      ...(options || {}),\n      allowStale: false,\n    });\n    if (res.data) {\n      await this.setPayload(res.data);\n    }\n  }\n\n  public getApiInfo(): [ApiHost, ClientKey] {\n    return [this.getApiHosts().apiHost, this.getClientKey()];\n  }\n  public getApiHosts() {\n    return getApiHosts(this._options);\n  }\n  public getClientKey(): string {\n    return this._options.clientKey || \"\";\n  }\n  public getPayload(): FeatureApiResponse {\n    return (\n      this._payload || {\n        features: this.getFeatures(),\n        experiments: this._experiments || [],\n      }\n    );\n  }\n  public getDecryptedPayload(): FeatureApiResponse {\n    return this._decryptedPayload || this.getPayload();\n  }\n\n  private async _refresh({\n    timeout,\n    skipCache,\n    allowStale,\n    streaming,\n  }: RefreshFeaturesOptions & {\n    allowStale?: boolean;\n    streaming?: boolean;\n  }) {\n    if (!this._options.clientKey) {\n      throw new Error(\"Missing clientKey\");\n    }\n    // Trigger refresh in feature repository\n    return refreshFeatures({\n      instance: this,\n      timeout,\n      skipCache: skipCache || this._options.disableCache,\n      allowStale,\n      backgroundSync: streaming ?? true,\n    });\n  }\n\n  public getFeatures() {\n    return this._features || {};\n  }\n\n  public getGlobalAttributes(): Attributes {\n    return this._options.globalAttributes || {};\n  }\n  public setGlobalAttributes(attributes: Attributes) {\n    this._options.globalAttributes = attributes;\n  }\n\n  public destroy() {\n    unsubscribe(this);\n\n    // Release references to save memory\n    this._features = {};\n    this._experiments = [];\n    this._decryptedPayload = undefined;\n    this._payload = undefined;\n    this._options = {};\n  }\n\n  public runInlineExperiment<T>(\n    experiment: Experiment<T>,\n    userContext: UserContext\n  ): Result<T> {\n    const { result } = runExperiment(\n      experiment,\n      null,\n      this._getEvalContext(userContext)\n    );\n    return result;\n  }\n\n  private _getEvalContext(userContext: UserContext): EvalContext {\n    if (this._options.globalAttributes) {\n      userContext = {\n        ...userContext,\n        attributes: {\n          ...this._options.globalAttributes,\n          ...userContext.attributes,\n        },\n      };\n    }\n\n    return {\n      user: userContext,\n      global: this._getGlobalContext(),\n      stack: {\n        evaluatedFeatures: new Set(),\n      },\n    };\n  }\n\n  private _getGlobalContext(): GlobalContext {\n    return {\n      features: this._features,\n      experiments: this._experiments,\n      log: this.log,\n      enabled: this._options.enabled,\n      qaMode: this._options.qaMode,\n      savedGroups: this._options.savedGroups,\n      forcedFeatureValues: this._options.forcedFeatureValues,\n      forcedVariations: this._options.forcedVariations,\n      trackingCallback: this._options.trackingCallback,\n      onFeatureUsage: this._options.onFeatureUsage,\n    };\n  }\n\n  public isOn<K extends string & keyof AppFeatures = string>(\n    key: K,\n    userContext: UserContext\n  ): boolean {\n    return this.evalFeature(key, userContext).on;\n  }\n\n  public isOff<K extends string & keyof AppFeatures = string>(\n    key: K,\n    userContext: UserContext\n  ): boolean {\n    return this.evalFeature(key, userContext).off;\n  }\n\n  public getFeatureValue<\n    V extends AppFeatures[K],\n    K extends string & keyof AppFeatures = string\n  >(key: K, defaultValue: V, userContext: UserContext): WidenPrimitives<V> {\n    const value = this.evalFeature<WidenPrimitives<V>, K>(key, userContext)\n      .value;\n    return value === null ? (defaultValue as WidenPrimitives<V>) : value;\n  }\n\n  public evalFeature<\n    V extends AppFeatures[K],\n    K extends string & keyof AppFeatures = string\n  >(id: K, userContext: UserContext): FeatureResult<V | null> {\n    return _evalFeature(id, this._getEvalContext(userContext));\n  }\n\n  log(msg: string, ctx: Record<string, unknown>) {\n    if (!this.debug) return;\n    if (this._options.log) this._options.log(msg, ctx);\n    else console.log(msg, ctx);\n  }\n\n  public setTrackingCallback(callback: TrackingCallbackWithUser) {\n    this._options.trackingCallback = callback;\n  }\n\n  public async applyStickyBuckets(\n    partialContext: Omit<\n      UserContext,\n      \"stickyBucketService\" | \"stickyBucketAssignmentDocs\"\n    >,\n    stickyBucketService: StickyBucketService\n  ): Promise<UserContext> {\n    const ctx = this._getEvalContext(partialContext);\n\n    const stickyBucketAssignmentDocs = await getAllStickyBucketAssignmentDocs(\n      ctx,\n      stickyBucketService\n    );\n\n    const userContext: UserContext = {\n      ...partialContext,\n      stickyBucketAssignmentDocs,\n      saveStickyBucketAssignmentDoc: (doc) =>\n        stickyBucketService.saveAssignments(doc),\n    };\n\n    return userContext;\n  }\n\n  public createScopedInstance(userContext: UserContext) {\n    return new UserScopedGrowthBook(this, userContext);\n  }\n}\n\nexport class UserScopedGrowthBook<\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  AppFeatures extends Record<string, any> = Record<string, any>\n> {\n  private _gb: GrowthBookClient;\n  private _userContext: UserContext;\n\n  constructor(gb: GrowthBookClient<AppFeatures>, userContext: UserContext) {\n    this._gb = gb;\n    this._userContext = userContext;\n  }\n\n  public runInlineExperiment<T>(experiment: Experiment<T>): Result<T> {\n    return this._gb.runInlineExperiment(experiment, this._userContext);\n  }\n\n  public isOn<K extends string & keyof AppFeatures = string>(key: K): boolean {\n    return this._gb.isOn(key, this._userContext);\n  }\n\n  public isOff<K extends string & keyof AppFeatures = string>(key: K): boolean {\n    return this._gb.isOff(key, this._userContext);\n  }\n\n  public getFeatureValue<\n    V extends AppFeatures[K],\n    K extends string & keyof AppFeatures = string\n  >(key: K, defaultValue: V): WidenPrimitives<V> {\n    return this._gb.getFeatureValue(key, defaultValue, this._userContext);\n  }\n\n  public evalFeature<\n    V extends AppFeatures[K],\n    K extends string & keyof AppFeatures = string\n  >(id: K): FeatureResult<V | null> {\n    return this._gb.evalFeature(id, this._userContext);\n  }\n}\n"],"mappings":"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"}