"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3225],{289881:(e,t,r)=>{r.r(t),r.d(t,{default:()=>q});var n=r(286326),i=r(824223),s=r(597598),o=r.n(s),a=r(57886),c=r(488814),l=r(189137),u=r(679955),d=r(414646),p=r(33118),_=r(281476),f=r(391289),b=r(836870);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){v(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const h=e=>{let{class_prefix:t,errors:r,touched:s,setFieldValue:o,citizenship_list:c}=e;return(0,b.jsxs)("div",{className:`${t}__residence-selection`,children:[(0,b.jsx)(i.Field,{name:"citizenship",children:e=>{let{field:t}=e;return(0,b.jsx)(n.Fragment,{children:(0,b.jsx)(a.Autocomplete,m(m({},t),{},{autoComplete:"off",input_id:"dt_core_set-citizenship-form_signup-citizenship-select",type:"text",label:(0,p.localize)("Citizenship"),error:s.citizenship&&r.citizenship,required:!0,list_items:c,onItemSelection:e=>{let{value:t,text:r}=e;return o("citizenship",t?r:"",!0)}}))})}}),(0,b.jsx)(a.Text,{as:"p",size:"xxs",className:"account-signup__subtext",color:"less-prominent",children:(0,b.jsx)(p.Localize,{i18n_default_text:"Select your citizenship/nationality as it appears on your passport or other government-issued ID."})})]})};h.propTypes={class_prefix:o().string,citizenship_list:o().arrayOf(o().object),errors:o().object,setFieldTouched:o().func,setFieldValue:o().func,touched:o().object};const w=h;var y=r(255530),j=r.n(y);const x=e=>{let{children:t}=e;return(0,b.jsx)("div",{className:"signup-separator-container",children:t})};x.Line=e=>{let{is_invisible:t}=e;return(0,b.jsx)("div",{className:j()("signup-separator-container__line",{"signup-separator-container__line--invisible":t})})};const O=x;function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function z(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const E=(0,u.observer)((e=>{let{api_error:t,errors:r,handleBlur:s,handleChange:o,isModalVisible:c,isSubmitting:u,touched:_,pw_input:f,setFieldTouched:g,updatePassword:m,values:v}=e;const{ui:h}=(0,d.A)(),{is_mobile:w}=h;return n.useEffect((()=>{l.cacheTrackEvents.loadEvent([{event:{name:"ce_virtual_signup_form",properties:{action:"password_screen_opened",form_name:w?"virtual_signup_web_mobile_default":"virtual_signup_web_desktop_default"}}}])}),[w]),(0,b.jsxs)("div",{className:"account-signup__password-selection",children:[(0,b.jsx)(a.Text,{as:"p",size:w?"xs":"s",weight:"bold",className:"account-signup__heading",align:"center",children:(0,b.jsx)(p.Localize,{i18n_default_text:"Keep your account secure with a password"})}),(0,b.jsx)(i.Field,{name:"password",children:e=>{let{field:t}=e;return(0,b.jsx)(a.PasswordMeter,{input:f,has_error:!(!_.password||!r.password),custom_feedback_messages:(0,l.getErrorMessages)().password_warnings,children:(0,b.jsx)(a.PasswordInput,P(P({},t),{},{autoComplete:"new-password",className:"account-signup__password-field",label:(0,p.localize)("Create a password"),error:_.password&&r.password,required:!0,value:v.password,onBlur:s,onChange:e=>{const t=e.target;g("password",!0),t&&m(t.value),o(e)},input_id:"dt_core_account-signup-modal_account-signup-password-field"}))})}}),(0,b.jsx)(a.Text,{as:"p",size:"xxs",className:"account-signup__subtext",align:"center",children:(0,b.jsx)(p.Localize,{i18n_default_text:"Strong passwords contain at least 8 characters, combine uppercase and lowercase letters, numbers, and symbols."})}),(0,b.jsx)(O,{}),t?(0,b.jsxs)(n.Fragment,{children:[(0,b.jsx)(a.Text,{as:"p",size:"xxs",color:"loss-danger",className:"account-signup__subtext account-signup__subtext--error",align:"center",children:t}),(0,b.jsxs)("div",{className:"account-signup__error-wrapper",children:[(0,b.jsx)(a.Button,{large:!0,secondary:!0,text:(0,p.localize)("Cancel"),type:"button",onClick:()=>c(!1)}),(0,b.jsx)(a.Button,{large:!0,primary:!0,text:(0,p.localize)("Create new account"),type:"button",onClick:()=>(0,l.redirectToSignUp)()})]})]}):(0,b.jsx)("div",{className:"account-signup__footer",children:(0,b.jsx)(a.Button,{className:j()("account-signup__btn",{"account-signup__btn--disabled":!v.password||r.password||u}),id:"dt_core_account-signup-modal_submit-btn",type:"submit",is_disabled:!v.password||!!r.password||u,text:(0,p.localize)("Start trading"),large:!0,primary:!0})})]})})),C=e=>{var t,r;let{ab_questionnaire:i,handleSignup:s}=e;const o=!(null===(t=i[1].answers)||void 0===t||null===(t=t[0])||void 0===t||!t.header);n.useEffect((()=>{_.Analytics.trackEvent("ce_questionnaire_form",{action:"open"})}),[i]);return(0,b.jsxs)("div",{className:"questionnaire-modal",children:[(0,b.jsx)(a.Text,{as:"h2",size:"xs",weight:"bold",align:"center",children:i[1].question}),(0,b.jsx)("ul",{className:j()({"questionnaire-modal__answers":o,"questionnaire-modal__options":!o}),children:null===(r=i[1])||void 0===r||null===(r=r.answers)||void 0===r?void 0:r.map(((e,t)=>{let{code:r,text:n,header:c}=e;return(0,b.jsx)("li",{className:j()({"questionnaire-modal__answers_content":o,"questionnaire-modal__options_card":!o}),children:(0,b.jsxs)(a.Button,{"data-testid":`dt_questionnaire_${r}`,onClick:()=>{return e=r,n=t+1,window.dataLayer=[...window.dataLayer,{event:"ce_questionnaire_form",analyticsData:{action:"choose_answer",question:i[0].question,answer_content:i[0].answers.filter((t=>{let{code:r}=t;return r===e}))[0].text,answer_code:e,answer_index:n}}],void s();var e,n},transparent:!0,children:[c&&(0,b.jsx)(a.Text,{as:"p",size:"xs",weight:"bold",children:c}),(0,b.jsx)(a.Text,{as:"p",size:"xs",children:n})]})},`${r}_questionnaire`)}))})]})};var k=r(76958);const N=(e,t)=>{const r={};if((0,l.validLength)(e.password,{min:8,max:25})?(0,l.validPassword)(e.password)||(r.password=(0,l.getErrorMessages)().password()):r.password=(0,p.localize)("You should enter {{min_number}}-{{max_number}} characters.",{min_number:8,max_number:25}),e.residence){const n=t.findIndex((t=>t.text.toLowerCase()===e.residence.toLowerCase()));-1!==n&&"DISABLED"!==t[n].disabled||(r.residence=(0,p.localize)("Unfortunately, {{website_name}} is not available in your country.",{website_name:l.website_name}))}else r.residence=!0;if(e.citizenship){-1===t.findIndex((t=>t.text.toLowerCase()===e.citizenship.toLowerCase()))&&(r.citizenship=!0)}else r.citizenship=!0;return r};function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function A(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const D=e=>{let{enableApp:t,is_mobile:r,isModalVisible:s,clients_country:o,onSignup:u,residence_list:d,setIsFromSignupAccount:g}=e;const[m,v]=n.useState(!1),[h,y]=n.useState(!0),[j,x]=n.useState(""),O=n.useRef(),[S,P]=n.useState(""),[z,T]=n.useState(!1),A=n.useRef(!1),D=n.useRef(!1),[q,L]=n.useState(!1),[V,I]=n.useState(!1),[B,M]=n.useState(),[R,$]=n.useState({}),U=(0,p.getLanguage)(),[K]=(0,c.A)({featureFlag:"signup_flow_error",defaultValue:!0}),W=e=>{var t;return e&&"br"===(null===(t=d[J(e)])||void 0===t||null===(t=t.value)||void 0===t?void 0:t.toLowerCase())},Y=(e,t)=>!((!W(e.residence)||q)&&e.residence&&!t.residence&&e.citizenship&&!t.citizenship),G=e=>{P(e)};n.useEffect((()=>{l.cacheTrackEvents.loadEvent([{event:{name:"ce_virtual_signup_form",properties:{action:"country_selection_screen_opened",form_name:r?"virtual_signup_web_mobile_default":"virtual_signup_web_desktop_default"}},cache:!0}]),l.cacheTrackEvents.loadEvent([{event:{name:"ce_virtual_signup_form",properties:{action:"signup_confirmed",form_name:r?"virtual_signup_web_mobile_default":"virtual_signup_web_desktop_default"}},cache:!0}]),f.WS.wait("website_status","residence_list").then((()=>{o&&d&&x((0,l.getLocation)(d,o,"text")),y(!1)}));M((()=>{var e,t,r,n,i;let s=_.Analytics.getFeatureValue("questionnaire-config","inactive")||"inactive";const o=s;var a;(s=null!==(e=null!==(t=null===(r=s)||void 0===r?void 0:r[U])&&void 0!==t?t:null===(n=s)||void 0===n?void 0:n.EN)&&void 0!==e?e:s,null!==(i=s)&&void 0!==i&&i.show_answers_in_random_order)?s=[F({},null==o?void 0:o.default),F(F({},s),{},{answers:(0,l.shuffleArray)(null===(a=s)||void 0===a?void 0:a.answers)})]:"inactive"!==s&&(s=[F({},null==o?void 0:o.default),F({},s)]);return s})())}),[]);const H=(e,t,n)=>{const i=r?"virtual_signup_web_mobile_default":"virtual_signup_web_desktop_default";l.cacheTrackEvents.loadEvent([{event:{name:"ce_virtual_signup_form",properties:{action:e,form_name:i,error_message:t,screen_name:n}}}])};n.useEffect((()=>{A.current=z}),[z]),n.useEffect((()=>{l.cacheTrackEvents.trackConsoleErrors((e=>{if(K&&e){const t=A.current?"password_screen_opened":"country_selection_screen";"country_selection_screen"===t?D.current&&D.current===e||(H("signup_flow_error",e,t),D.current=e):"password_screen_opened"===t&&H("signup_flow_error",e,t)}}))}),[K]);const J=e=>d.findIndex((t=>t.text.toLowerCase()===(null==e?void 0:e.toLowerCase()))),Q=()=>u(R,X),X=e=>{e?(v(e),_.Analytics.trackEvent("ce_virtual_signup_form",{action:"signup_flow_error",form_name:r?"virtual_signup_web_mobile_default":"virtual_signup_web_desktop_default",error_message:e,screen_name:"password_screen_opened"})):(g(!0),s(!1),l.SessionStore.remove("signup_query_param"),t(),_.Analytics.trackEvent("ce_virtual_signup_form",{action:"signup_done",form_name:r?"virtual_signup_web_mobile_default":"virtual_signup_web_desktop_default"}))};return h||(0,l.setPerformanceValue)("signup_time"),(0,b.jsx)("div",{className:"account-signup",children:h?(0,b.jsx)(a.Loading,{is_fullscreen:!1}):(0,b.jsx)(i.Formik,{initialValues:{citizenship:"",password:"",residence:""},validate:e=>N(e,d),onSubmit:e=>{const t=J(e.residence),r=J(e.citizenship),n=F(F({},e),{},{residence:d[t].value,citizenship:d[r].value});$(n),"inactive"===B?u(n,X):I(!!B)},residence_list:d,children:e=>{let{isSubmitting:t,handleBlur:o,errors:c,handleChange:l,values:u,setFieldValue:_,setFieldTouched:f,touched:g}=e;return(0,b.jsx)(i.Form,{children:z?(0,b.jsx)(n.Fragment,{children:V?(0,b.jsx)(C,{ab_questionnaire:B,handleSignup:Q}):(0,b.jsx)(E,{api_error:m,errors:c,handleBlur:o,handleChange:l,isModalVisible:s,isSubmitting:t,touched:g,pw_input:S,setFieldTouched:f,updatePassword:G,values:u})}):(0,b.jsxs)("div",{className:"account-signup__location-selection",children:[(0,b.jsx)(a.Text,{as:"h1",size:r?"xs":"s",weight:"bold",className:"account-signup__heading",children:(0,p.localize)("Select your country and citizenship:")}),(0,b.jsx)(k.A,{class_prefix:"account-signup",errors:c,touched:g,onResidenceSelectionChanged:()=>L(!1),setFieldTouched:f,setFieldValue:_,residence_list:d,default_value:j,history_value:O.current}),(0,b.jsx)(w,{class_prefix:"account-signup",errors:c,touched:g,setFieldTouched:f,setFieldValue:_,citizenship_list:d}),W(u.residence)&&(0,b.jsx)(a.Checkbox,{checked:q,onChange:()=>L(!q),className:"account-signup__checkbox",classNameLabel:"account-signup__label",label:(0,p.localize)("I hereby confirm that my request for opening an account with Deriv to trade OTC products issued and offered exclusively outside Brazil was initiated by me. I fully understand that Deriv is not regulated by CVM and by approaching Deriv I intend to set up a relation with a foreign company.")}),(0,b.jsx)("div",{className:"account-signup__footer",children:(0,b.jsx)(a.Button,{className:"account-signup__btn",is_disabled:Y(u,c),type:"button",onClick:()=>{O.current=u,T(!0)},primary:!0,large:!0,text:(0,p.localize)("Next")})})]})})}})})};D.propTypes={clients_country:o().string,enableApp:o().func,onSignup:o().func,residence_list:o().array,is_mobile:o().bool,isModalVisible:o().func,setIsFromSignupAccount:o().func};const q=(0,u.observer)((()=>{const{ui:e,client:t}=(0,d.A)(),{onSignup:r,is_logged_in:i,residence_list:s,clients_country:o,logout:c}=t,{is_account_signup_modal_visible:l,toggleAccountSignupModal:u,enableApp:p,disableApp:_,is_loading:f,is_mobile:g,setIsFromSignupAccount:m}=e;return n.useEffect((()=>{l&&i&&c()}),[l,i,c]),(0,b.jsx)(a.Dialog,{className:"account-signup__dialog",is_visible:l,disableApp:_,enableApp:p,is_loading:f||!s.length,is_mobile_full_width:!1,children:(0,b.jsx)(D,{clients_country:o,onSignup:r,residence_list:s,is_mobile:g,isModalVisible:u,enableApp:p,setIsFromSignupAccount:m})})}))},76958:(e,t,r)=>{r.d(t,{A:()=>f});var n=r(286326),i=r(824223),s=r(597598),o=r.n(s),a=r(57886),c=r(33118),l=r(836870);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const _=e=>{var t;let{children:r,class_prefix:s="set-residence",default_value:o,history_value:u,errors:p,onResidenceSelectionChanged:_,touched:f,setFieldTouched:b,setFieldValue:g,residence_list:m}=e;return n.useEffect((()=>{o&&(b("residence",!0),g("residence",o,!0))}),[]),(0,l.jsxs)("div",{className:`${s}__residence-selection`,children:[(0,l.jsx)(i.Field,{name:"residence",children:e=>{let{field:t}=e;return(0,l.jsx)(n.Fragment,{children:(0,l.jsx)(a.Autocomplete,d(d({},t),{},{autoComplete:"off",input_id:"dt_core_set-residence-form_signup-residence-select",type:"text",label:(0,c.localize)("Country of residence"),historyValue:u,error:f.residence&&p.residence,required:!0,list_items:m,onItemSelection:e=>{let{value:t,text:r}=e;g("residence",t?r:"",!0),null==_||_()}}))})}}),!(null!=p&&null!==(t=p.residence)&&void 0!==t&&t.length)&&(0,l.jsx)(a.Text,{as:"p",size:"xxs",className:"account-signup__subtext",color:"less-prominent",children:(0,l.jsx)(c.Localize,{i18n_default_text:"Select the country where you currently live."})}),(0,l.jsx)("div",{className:`${s}__button_wrapper`,children:r})]})};_.propTypes={children:o().object,class_prefix:o().string,default_value:o().string,history_value:o().string,errors:o().object,onResidenceSelectionChanged:o().func,residence_list:o().arrayOf(o().object),setFieldTouched:o().func,setFieldValue:o().func,touched:o().object};const f=_}}]);
//# sourceMappingURL=core.account-signup-modal.9ede59356694504d3047.js.map