!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@deriv/components"),require("@deriv/hooks"),require("@deriv/shared"),require("@deriv/stores"),require("@deriv/translations"),require("formik"),require("react")):"function"==typeof define&&define.amd?define(["@deriv/components","@deriv/hooks","@deriv/shared","@deriv/stores","@deriv/translations","formik","react"],t):"object"==typeof exports?exports["@deriv/cfd"]=t(require("@deriv/components"),require("@deriv/hooks"),require("@deriv/shared"),require("@deriv/stores"),require("@deriv/translations"),require("formik"),require("react")):e["@deriv/cfd"]=t(e["@deriv/components"],e["@deriv/hooks"],e["@deriv/shared"],e["@deriv/stores"],e["@deriv/translations"],e.formik,e.react)}(self,((e,t,r,n,a,o,i)=>(()=>{"use strict";var l,s={"./src/Containers/mt5-migration-modal/index.ts":(e,t,r)=>{r.d(t,{default:()=>S});var n=r("react"),a=r.n(n),o=r("@deriv/components"),i=r("@deriv/translations"),l=r("@deriv/stores"),s=r("@deriv/shared"),c=r("@deriv/hooks");const m=function(){var e=(0,c.useMT5SVGEligibleToMigrate)(),t=e.eligible_svg_to_bvi_derived_accounts,r=e.eligible_svg_to_bvi_financial_accounts,n=e.eligible_svg_to_vanuatu_derived_accounts,l=e.eligible_svg_to_vanuatu_financial_accounts,s="Existing account",m="New account";return e.no_of_svg_accounts_to_migrate>1&&(s="Existing accounts",m="New accounts"),a().createElement("div",{className:"mt5-migration-modal__migration_content-items__list"},a().createElement("div",{className:"mt5-migration-modal__migration_content-items__list--container"},a().createElement(o.Text,{weight:"bold",size:"xs"},a().createElement(i.Localize,{i18n_default_text:"{{existing_account_title}}",values:{existing_account_title:s}})),a().createElement("div",{className:"mt5-migration-modal__migration_content-items__list--container__icons"},(t||n)&&a().createElement(o.Icon,{icon:"IcMt5SvgStandard",size:96,data_testid:"dt_migrate_from_svg_standard"}),(r||l)&&a().createElement(o.Icon,{icon:"IcMt5SvgFinancial",size:96,data_testid:"dt_migrate_from_svg_financial"}))),a().createElement("div",{className:"mt5-migration-modal__migration_content-items__list--container"},a().createElement(o.Text,{weight:"bold",size:"xs"},a().createElement(i.Localize,{i18n_default_text:"{{new_account_title}}",values:{new_account_title:m}})),a().createElement("div",{className:"mt5-migration-modal__migration_content-items__list--container__icons"},t&&a().createElement(o.Icon,{icon:"IcMt5BviStandard",size:96,data_testid:"dt_migrate_to_bvi_standard"}),r&&a().createElement(o.Icon,{icon:"IcMt5BviFinancial",size:96,data_testid:"dt_migrate_to_bvi_financial"}),n&&a().createElement(o.Icon,{icon:"IcMt5VanuatuStandard",size:96,data_testid:"dt_migrate_to_vanuatu_standard"}),l&&a().createElement(o.Icon,{icon:"IcMt5VanuatuFinancial",size:96,data_testid:"dt_migrate_to_vanuatu_financial"}))))};var u=a().createContext({show_modal_front_side:!1,setShowModalFrontSide:function(){return null}}),d=function(){return(0,n.useContext)(u)};function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t,r){return(t=function(e){var t=function(e){if("object"!=_(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==_(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const v=(0,l.observer)((function(){var e,t,r=(0,l.useStore)().ui,n=r.is_mobile,u=r.setMT5MigrationModalEnabled,_=d().setShowModalFrontSide,f=(0,c.useMT5SVGEligibleToMigrate)(),g=f.getEligibleAccountToMigrate,v=f.eligible_account_to_migrate_label,E=f.has_derived_mt5_to_migrate,b=f.has_derived_and_financial_mt5,y=function(){return b?{platform:(0,s.getCFDPlatformNames)(s.CFD_PLATFORMS.MT5),type_1:(0,s.getFormattedJurisdictionMarketTypes)(s.JURISDICTION_MARKET_TYPES.DERIVED),type_2:(0,s.getFormattedJurisdictionMarketTypes)(s.JURISDICTION_MARKET_TYPES.FINANCIAL),from_account:(0,s.getFormattedJurisdictionCode)(s.Jurisdiction.SVG)}:{platform:(0,s.getCFDPlatformNames)(s.CFD_PLATFORMS.MT5),type:(0,s.getFormattedJurisdictionMarketTypes)(E?s.JURISDICTION_MARKET_TYPES.DERIVED:s.JURISDICTION_MARKET_TYPES.FINANCIAL),from_account:(0,s.getFormattedJurisdictionCode)(s.Jurisdiction.SVG)}};return a().createElement(a().Fragment,null,a().createElement("div",{className:"mt5-migration-modal__container"},a().createElement("div",null,a().createElement(o.Text,{as:"p",size:n?"xs":"s",align:"center"},b?a().createElement(i.Localize,{i18n_default_text:"Enhance your trading experience by upgrading your <0>{{platform}} {{type_1}}</0> <1/>and <0>{{type_2}} {{from_account}}</0> account(s).",values:p({},y()),components:[a().createElement("strong",{key:0})]}):a().createElement(i.Localize,{i18n_default_text:"Enhance your trading experience by upgrading your <0/><1>{{platform}} {{type}} {{from_account}} </1> account(s).",values:p({},y()),components:[a().createElement("br",{key:0}),a().createElement("strong",{key:1})]}))),a().createElement("div",{className:"mt5-migration-modal__migration_content"},a().createElement("div",{className:"mt5-migration-modal__migration_content-items"},a().createElement(m,null))),a().createElement("div",{className:"mt5-migration-modal__migration_infobox"},a().createElement(o.HintBox,{icon:"IcInfoBlue",message:a().createElement(o.Text,{as:"p",size:n?"xxxs":"xxs"},b?a().createElement(i.Localize,{i18n_default_text:"Your existing <0>{{platform}} {{type_1}}</0> <1/>and <0>{{type_2}} {{from_account}}</0> account(s) will remain accessible.",values:p({},y()),components:[a().createElement("strong",{key:0})]}):a().createElement(i.Localize,{i18n_default_text:"Your existing <0>{{platform}} {{type}} {{from_account}}</0> account(s) will remain accessible.",values:p({},y()),components:[a().createElement("strong",{key:0})]})),is_info:!0})),a().createElement("div",null,a().createElement(o.Text,{as:"p",size:n?"xxs":"xs",align:"center"},b?a().createElement(i.Localize,{i18n_default_text:"By clicking on <0>Next</0> you agree to move your {{platform}} {{type_1}} and {{type_2}} {{from_account}} account(s) under Deriv {{account_to_migrate}} Ltd’s <1>terms and conditions</1>.",components:[a().createElement("strong",{key:0}),a().createElement(o.StaticUrl,{key:1,className:"link",href:null===(e=s.DBVI_COMPANY_NAMES[g()])||void 0===e?void 0:e.tnc_url})],values:p(p({},y()),{},{account_to_migrate:v})}):a().createElement(i.Localize,{i18n_default_text:"By clicking on <0>Next</0> you agree to move your {{platform}} {{type}} {{from_account}} account(s) under <2/>Deriv {{account_to_migrate}} Ltd’s <1>terms and conditions</1>.",components:[a().createElement("strong",{key:0}),a().createElement(o.StaticUrl,{key:1,className:"link",href:null===(t=s.DBVI_COMPANY_NAMES[g()])||void 0===t?void 0:t.tnc_url,is_document:!0}),n?null:a().createElement("br",{key:2})],values:p(p({},y()),{},{account_to_migrate:v})})))),a().createElement(o.Modal.Footer,{has_separator:!0},a().createElement(o.Button,{type:"button",has_effect:!0,large:!0,primary:!0,onClick:function(){_(!1),u(!0)}},a().createElement(i.Localize,{i18n_default_text:"Next"}))))}));var E=r("./src/Stores/Modules/CFD/Helpers/useCfdStores.tsx"),b=r("formik");const y=(0,l.observer)((function(){var e=(0,l.useStore)(),t=e.ui,r=e.common,n=e.client,m=t.toggleMT5MigrationModal,u=t.setMT5MigrationModalEnabled,d=t.is_mobile,_=n.email,f=r.setAppstorePlatform,p=(0,E.E)(),g=p.setJurisdictionSelectedShortcode,v=p.setSentEmailModalStatus,y=p.submitMt5Password,x=(0,c.useMT5SVGEligibleToMigrate)().getEligibleAccountToMigrate,h=a().useRef(null),M=d?"xxs":"xs",S=function(){u(!1),m(!1),s.WS.verifyEmail(_,"trading_platform_mt5_password_reset",{url_parameters:{redirect_to:10}}),v(!0)};return a().createElement(b.Formik,{initialValues:{password:""},enableReinitialize:!0,validate:function(e){var t,r={};return(0,s.validLength)(e.password,{min:8,max:25})?(0,s.validPassword)(e.password)||(r.password=(0,s.getErrorMessages)().password()):r.password=(0,i.localize)("You should enter {{min_number}}-{{max_number}} characters.",{min_number:8,max_number:25}),(null===(t=e.password)||void 0===t?void 0:t.toLowerCase())===_.toLowerCase()&&(r.password=(0,i.localize)("Your password cannot be the same as your email address.")),r},innerRef:h,validateOnMount:!0,onSubmit:function(e,t){y(e,t).then((function(){f(s.CFD_PLATFORMS.MT5),g(x()),m(!1)}))}},(function(e){var t=e.errors,r=e.handleBlur,n=e.handleChange,l=e.handleSubmit,s=e.isSubmitting,c=(e.touched,e.values);return a().createElement("form",{onSubmit:l},a().createElement("div",{className:"mt5-migration-modal__container"},a().createElement("div",{className:"mt5-migration-modal__password-header-container"},a().createElement(o.Text,{as:"p",size:M},a().createElement(i.Localize,{i18n_default_text:"Enter your Deriv MT5 password to upgrade your account(s)."}))),a().createElement("div",{className:"mt5-migration-modal__password-input-container"},a().createElement(o.PasswordInput,{autoComplete:"off",label:(0,i.localize)("Deriv MT5 password"),name:"password",value:c.password,onBlur:r,onChange:n})),a().createElement("div",{className:"mt5-migration-modal__password-hint"},a().createElement(o.InlineMessage,{type:"information",size:"sm"},a().createElement(o.Text,{as:"p",size:"xxs"},a().createElement(i.Localize,{i18n_default_text:"We've introduced additional password requirements to increase your account security. Your password should:"})),a().createElement("ul",{className:"mt5-migration-modal__password-hint-items"},a().createElement("li",null,a().createElement(o.Text,{as:"p",size:"xxs",weight:"bold"},a().createElement(i.Localize,{i18n_default_text:"Be between 8 to 16 characters."}))),a().createElement("li",null,a().createElement(o.Text,{as:"p",size:"xxs",weight:"bold"},a().createElement(i.Localize,{i18n_default_text:"Contain at least one special character."})))),a().createElement(o.Text,{as:"p",size:"xxs"},a().createElement(i.Localize,{i18n_default_text:"If your current password doesn't match these requirements, you'll need to create a new one in the next step."}))))),a().createElement(o.Modal.Footer,null,a().createElement(o.FormSubmitButton,{is_disabled:!!t.password||s,is_absolute:d,label:(0,i.localize)("Upgrade"),has_cancel:!0,onCancel:S,cancel_label:(0,i.localize)("Forgot password?"),is_loading:s})))}))})),x=(0,l.observer)((function(){var e=(0,l.useStore)().ui.is_mobile,t=d().show_modal_front_side;return a().createElement(o.Div100vhContainer,{className:"mt5-migration-modal__mobile-container",height_offset:"150px",is_bypassed:!e},t?a().createElement(v,null):a().createElement(y,null))}));function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,l=[],s=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return M(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?M(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const S=(0,l.observer)((function(){var e=(0,l.useStore)(),t=e.ui,r=e.modules.cfd,n=t.disableApp,s=t.enableApp,c=t.is_mt5_migration_modal_open,m=t.is_mobile,d=t.toggleMT5MigrationModal,_=t.setMT5MigrationModalEnabled,f=t.is_mt5_migration_modal_enabled,p=r.mt5_migration_error,g=r.setMT5MigrationError,v=r.setIsFromMt5MigrationModal,E=h(a().useState(!0),2),b=E[0],y=E[1],M=a().createElement(o.Text,{size:m?"xs":"s",weight:"bold"},b?a().createElement(i.Localize,{i18n_default_text:"Upgrade your MT5 account(s)"}):a().createElement(i.Localize,{i18n_default_text:"Enter your Deriv MT5 password"}));a().useEffect((function(){y(!f)}),[f,y,c]);var S=function(){_(!1),v(!1),d(!1)};return a().createElement("div",null,a().createElement(a().Suspense,{fallback:a().createElement(o.UILoader,null)},a().createElement(u.Provider,{value:{show_modal_front_side:b,setShowModalFrontSide:y}},a().createElement(o.Dialog,{title:(0,i.localize)("Sorry for the interruption"),confirm_button_text:(0,i.localize)("Try again"),onConfirm:function(){g(""),_(!1),d(!0)},disableApp:n,enableApp:s,has_close_icon:!0,className:"mt5-migration-modal__error-dialog",is_visible:!!p,onClose:function(){g(""),S()}},a().createElement(i.Localize,{i18n_default_text:"{{mt5_migration_error}}",values:{mt5_migration_error:p}})),a().createElement(o.DesktopWrapper,null,a().createElement(o.Modal,{className:"mt5-migration-modal",disableApp:n,enableApp:s,exit_classname:"cfd-modal--custom-exit",is_open:c&&!p,title:M,toggleModal:S,width:b?"58.8rem":"43.2rem",has_return_icon:!b,onReturn:function(){return y(!0)}},a().createElement(x,null))),a().createElement(o.MobileWrapper,null,a().createElement(o.PageOverlay,{is_open:c,header_classname:"mt5-migration-modal__mobile-header",portal_id:"deriv_app",header:M,onClickClose:S,has_return_icon:!b,onReturn:function(){return y(!0)}},a().createElement(x,null))))))}))},"@deriv/components":t=>{t.exports=e},"@deriv/hooks":e=>{e.exports=t},"@deriv/shared":e=>{e.exports=r},"@deriv/stores":e=>{e.exports=n},"@deriv/translations":e=>{e.exports=a},formik:e=>{e.exports=o},react:e=>{e.exports=i}},c={};function m(e){var t=c[e];if(void 0!==t)return t.exports;var r=c[e]={exports:{}};return s[e](r,r.exports,m),r.exports}m.m=s,l=[],m.O=(e,t,r,n)=>{if(!t){var a=1/0;for(c=0;c<l.length;c++){for(var[t,r,n]=l[c],o=!0,i=0;i<t.length;i++)(!1&n||a>=n)&&Object.keys(m.O).every((e=>m.O[e](t[i])))?t.splice(i--,1):(o=!1,n<a&&(a=n));if(o){l.splice(c--,1);var s=r();void 0!==s&&(e=s)}}return e}n=n||0;for(var c=l.length;c>0&&l[c-1][2]>n;c--)l[c]=l[c-1];l[c]=[t,r,n]},m.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return m.d(t,{a:t}),t},m.d=(e,t)=>{for(var r in t)m.o(t,r)&&!m.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},m.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={MT5MigrationModal:0};m.O.j=t=>0===e[t];var t=(t,r)=>{var n,a,[o,i,l]=r,s=0;if(o.some((t=>0!==e[t]))){for(n in i)m.o(i,n)&&(m.m[n]=i[n]);if(l)var c=l(m)}for(t&&t(r);s<o.length;s++)a=o[s],m.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return m.O(c)},r=self.webpackChunk_deriv_cfd=self.webpackChunk_deriv_cfd||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var u=m.O(void 0,["internalCFDStoreUsage"],(()=>m("./src/Containers/mt5-migration-modal/index.ts")));return(u=m.O(u)).default})()));