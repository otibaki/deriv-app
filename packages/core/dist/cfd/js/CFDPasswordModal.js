!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@deriv/account/dist/account/js/sent-email-modal"),require("@deriv/components"),require("@deriv/hooks"),require("@deriv/shared"),require("@deriv/stores"),require("@deriv/translations"),require("classnames"),require("formik"),require("react"),require("react-router")):"function"==typeof define&&define.amd?define(["@deriv/account/dist/account/js/sent-email-modal","@deriv/components","@deriv/hooks","@deriv/shared","@deriv/stores","@deriv/translations","classnames","formik","react","react-router"],t):"object"==typeof exports?exports["@deriv/cfd"]=t(require("@deriv/account/dist/account/js/sent-email-modal"),require("@deriv/components"),require("@deriv/hooks"),require("@deriv/shared"),require("@deriv/stores"),require("@deriv/translations"),require("classnames"),require("formik"),require("react"),require("react-router")):e["@deriv/cfd"]=t(e["@deriv/account/dist/account/js/sent-email-modal"],e["@deriv/components"],e["@deriv/hooks"],e["@deriv/shared"],e["@deriv/stores"],e["@deriv/translations"],e.classnames,e.formik,e.react,e["react-router"])}(self,((e,t,r,a,o,n,s,i,l,c)=>(()=>{"use strict";var d,u,m,_,f,p={"./src/Containers/cfd-password-modal.tsx":(e,t,r)=>{r.d(t,{default:()=>J});var a=r("react"),o=r.n(a),n=r("react-router"),s=r("formik"),i=r("../../node_modules/@deriv-com/ui/dist/hooks/useDevice.js"),l=r("@deriv/account/dist/account/js/sent-email-modal"),c=r.n(l),d=r("@deriv/components"),u=r("@deriv/shared"),m=r("@deriv/stores"),_=r("@deriv/translations"),f=r("./src/Helpers/cfd-config.ts");const p=(0,m.observer)((function(e){var t=e.platform,r=(0,m.useStore)().modules.cfd,a=r.account_title,n=r.account_type,s=function(){switch(t){case f.$_.CTRADER:case f.$_.DXTRADE:return n.category===f.XJ.REAL?"Real":"";default:return a}};return o().createElement(d.Text,{size:"xs",className:"dc-modal__container_cfd-password-modal__account-title"},t===f.$_.MT5?o().createElement(_.Localize,{i18n_default_text:"Enter your {{platform}} password to add an {{platform}} {{account}} account.",values:{platform:(0,u.getCFDPlatformNames)(t),account:s()}}):o().createElement(_.Localize,{i18n_default_text:"Enter your {{platform}} password to add a {{platform}} {{account}} account.",values:{platform:(0,u.getCFDPlatformLabel)(t),account:s()}}))}));var g=r("classnames"),v=r.n(g);function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},w.apply(null,arguments)}const b=function(e){var t=e.classNameMessage,r=void 0===t?"":t,a=e.has_cancel,n=void 0!==a&&a,s=e.has_submit,i=void 0===s||s,l=e.icon,c=e.message,u=e.onCancel,m=e.onSubmit,f=e.heading,p=e.icon_size,g=void 0===p?"large":p,b=e.text_submit,h=e.text_cancel,y=e.is_open,E=e.toggleModal,x=e.title,M=e.has_close_icon,C=e.width,P=void 0===C?"":C,T=e.is_medium_button;return o().createElement(d.Modal,{className:"cfd-success-dialog",is_open:y,toggleModal:E,has_close_icon:M,small:!x,title:x,width:P},o().createElement(d.Modal.Body,null,o().createElement("div",{className:v()("success-change__icon-area",{"success-change__icon-area--large":"large"===g,"success-change__icon-area--xlarge":"xlarge"===g}),"data-testid":"dt_cfd_success_modal_icon_wrapper"},l,o().createElement(d.Icon,{className:"bottom-right-overlay",icon:"IcCheckmarkCircle",custom_color:"var(--status-success)",size:24})),f?o().createElement(o().Fragment,null,f):o().createElement(d.Text,{as:"h2",weight:"bold",size:"s",className:"dc-modal-header__title"},o().createElement(_.Localize,{i18n_default_text:"Success!"})),o().isValidElement(c)&&c,!o().isValidElement(c)&&o().createElement("p",{className:r},c)),o().createElement(d.Modal.Footer,null,n&&u&&o().createElement(d.Button,w({onClick:u,has_effect:!0,text:h||(0,_.localize)("Maybe later"),secondary:!0},T?{medium:!0}:{large:!0})),i&&m&&o().createElement(d.Button,w({has_effect:!0,onClick:m,text:b,primary:!0},T?{medium:!0}:{large:!0}))))};var h=r("./src/Stores/Modules/CFD/Helpers/cfd-config.ts"),y=r("./src/Stores/Modules/CFD/Helpers/useCfdStores.tsx");function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){C(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e,t,r){return(t=function(e){var t=function(e){if("object"!=E(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=E(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==E(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const P=(0,m.observer)((function(e){var t=e.icon,r=e.eligible_account_to_migrate,a=e.jurisdiction_market_name,n=e.closePopupModal,s=(0,m.useStore)().ui.is_mobile,i=(0,u.getCFDPlatformNames)(u.CFD_PLATFORMS.MT5),l=s?"xxs":"xs",c=s?"xxxs":"xxs",f=function(){return a.length>1?{type_1:a[0],type_2:a[1]}:{type_1:a[0]}};return o().createElement("div",{className:"cfd-success-dialog-migration__modal-content"},o().createElement(d.Modal.Body,{className:v()("cfd-success-dialog-migration__body")},o().createElement("div",{className:"cfd-success-dialog-migration__icon-area"},t&&o().createElement(d.Icon,{icon:t,size:128})),o().createElement("div",null,o().createElement(d.Text,{as:"h2",weight:"bold",className:"cfd-success-dialog-migration__title"},o().createElement(_.Localize,{i18n_default_text:"Upgrade complete"})),o().createElement("div",{className:"cfd-success-dialog-migration__content-wrapper"},o().createElement(d.Text,{size:l,as:"p",align:"center"},a.length>1?o().createElement(_.Localize,{i18n_default_text:"Start trading with your new <0>{{platform}} {{type_1}}</0> and <0>{{type_2}} {{eligible_account_to_migrate}}</0> accounts.",values:M({platform:i,eligible_account_to_migrate:r},f()),components:[o().createElement("strong",{key:0})]}):o().createElement(_.Localize,{i18n_default_text:"Start trading with your new <0>{{platform}} {{type_1}} {{eligible_account_to_migrate}}</0> account.",values:M({platform:i,eligible_account_to_migrate:r},f()),components:[o().createElement("strong",{key:0})]})),o().createElement("div",{className:"cfd-success-dialog-migration__inline-msg"},o().createElement(d.InlineMessage,{type:"information",size:"sm",title:o().createElement(_.Localize,{i18n_default_text:"Important: Your <0>{{platform}} {{existing_account}}</0> account.",values:{platform:i,existing_account:(0,u.getFormattedJurisdictionCode)(u.Jurisdiction.SVG)},components:[o().createElement("strong",{key:0})]}),message:o().createElement(d.Text,{as:"ul",size:c,className:"cfd-success-dialog-migration__body-bullets--list"},o().createElement("li",null,o().createElement(_.Localize,{i18n_default_text:"You can manage your existing positions, but you can't start a new trade."})),o().createElement("li",null,o().createElement(_.Localize,{i18n_default_text:"We'll close accounts with no open positions after 60 days."})))}))))),o().createElement(d.Modal.Footer,{has_separator:!0,className:"cfd-success-dialog-migration-footer"},o().createElement(d.Button,{has_effect:!0,onClick:n,primary:!0,large:!0},o().createElement(_.Localize,{i18n_default_text:"OK"}))))})),T=(0,m.observer)((function(e){var t,r=e.is_open,a=e.closeModal,n=(0,m.useStore)().ui,s=n.is_mobile,i=n.setMT5MigrationModalEnabled,l=(0,y.E)(),c=l.migrated_mt5_accounts,_=l.setIsFromMt5MigrationModal,f=!!c.length,p=(0,h.j5)(null===(t=c.map((function(e){var t,r;return null===(t=Object.values(null!==(r=null==e?void 0:e.to_account)&&void 0!==r?r:{}))||void 0===t?void 0:t[0]})))||void 0===t?void 0:t[0]),g=c.map((function(e){var t,r;return(0,u.getFormattedJurisdictionMarketTypes)(null===(t=Object.keys(null!==(r=null==e?void 0:e.to_account)&&void 0!==r?r:{}))||void 0===t?void 0:t[0])})),v=function(){_(!1),i(!1),a()},w=function(){if(f){var e,t,r=(null===(e=Object.values(null===(t=c[0])||void 0===t?void 0:t.to_account))||void 0===e?void 0:e[0])||"";if(1===(null==c?void 0:c.length))switch(r){case u.Jurisdiction.BVI:return"IcMt5Bvi";case u.Jurisdiction.VANUATU:return"IcMt5Vanuatu";default:return""}else switch(r){case u.Jurisdiction.BVI:return"IcMt5StandardFinancialBvi";case u.Jurisdiction.VANUATU:return"IcMt5StandardFinancialVanuatu";default:return""}}},b=function(){return o().createElement(P,{closePopupModal:v,icon:w(),eligible_account_to_migrate:p,jurisdiction_market_name:g})};return s?o().createElement(d.PageOverlay,{is_open:r,header_classname:"cfd-success-dialog-migration",portal_id:"deriv_app",header:" ",onClickClose:v},o().createElement(b,null)):o().createElement(d.Modal,{className:"cfd-success-dialog-migration",is_open:r,toggleModal:v,has_close_icon:!0,title:" ",width:"58.8rem",should_header_stick_body:!1},o().createElement(b,null))}));function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function L(e,t,r){return(t=function(e){var t=function(e){if("object"!=S(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==S(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,o,n,s,i=[],l=!0,c=!1;try{if(n=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=n.call(r)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return O(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}var D=(0,u.makeLazyLoader)((function(){return(0,u.moduleLoader)((function(){return r.e("src_Containers_mt5-create-password_mt5-create-password_tsx").then(r.bind(r,"./src/Containers/mt5-create-password/mt5-create-password.tsx"))}))}),(function(){return o().createElement("div",null)}))(),z=(0,u.makeLazyLoader)((function(){return(0,u.moduleLoader)((function(){return r.e("src_Containers_cfd-password-modal-tnc_tsx").then(r.bind(r,"./src/Containers/cfd-password-modal-tnc.tsx"))}))}),(function(){return o().createElement("div",null)}))(),F=(0,u.makeLazyLoader)((function(){return(0,u.moduleLoader)((function(){return Promise.all([r.e("utilities"),r.e("src_Containers_cfd-password-change_tsx")]).then(r.bind(r,"./src/Containers/cfd-password-change.tsx"))}))}),(function(){return o().createElement("div",null)}))(),N=(0,u.makeLazyLoader)((function(){return(0,u.moduleLoader)((function(){return Promise.all([r.e("assets"),r.e("src_Containers_cfd-password-success-icon_tsx")]).then(r.bind(r,"./src/Containers/cfd-password-success-icon.tsx"))}))}),(function(){return o().createElement("div",null)}))(),A=(0,u.makeLazyLoader)((function(){return(0,u.moduleLoader)((function(){return r.e("src_Containers_cfd-password-change-content_tsx").then(r.bind(r,"./src/Containers/cfd-password-change-content.tsx"))}))}),(function(){return o().createElement("div",null)}))(),R=(0,u.makeLazyLoader)((function(){return(0,u.moduleLoader)((function(){return r.e("src_Containers_cfd-change-password-confirmation_tsx").then(r.bind(r,"./src/Containers/cfd-change-password-confirmation.tsx"))}))}),(function(){return o().createElement("div",null)}))(),$=function(e){var t=e.should_set_trading_password,r=e.is_password_reset_error,a=e.platform,n=(0,i.Y)().isDesktop,s=n?"span":"p",l=n?{}:{padding:"2rem"};if(a===f.$_.MT5&&!r){var c=(0,u.getCFDPlatformNames)(a);return o().createElement(d.Text,{as:s,line_height:"m",weight:"bold",size:n?"s":"xs",align:"center"},t?o().createElement(_.Localize,{i18n_default_text:"Create an {{platform_name}} account",values:{platform_name:c}}):o().createElement(_.Localize,{i18n_default_text:"Add an {{platform_name}} account",values:{platform_name:c}}))}return o().createElement(d.Text,{styles:l,as:s,line_height:"m",weight:"bold",size:"s",align:"center"},!t&&!r&&o().createElement(_.Localize,{i18n_default_text:"Enter your {{platform}} password",values:{platform:(0,u.getCFDPlatformLabel)(a)}}),r&&o().createElement(_.Localize,{i18n_default_text:"Too many attempts"}))},I=function(e,t,r,a){t(e),r().then((function(){a("password",!0)}))},q=function(e){var t=e.password,r=e.platform,a=e.validatePassword,n=e.onSubmit,i=e.error_message;return o().createElement(s.Formik,{initialValues:{password:t},enableReinitialize:!0,validate:a,onSubmit:n},(function(e){var t=e.errors,a=e.isSubmitting,n=e.handleBlur,s=e.handleChange,l=e.handleSubmit,c=e.setFieldTouched,m=e.touched,p=e.values,g=e.validateForm;return o().createElement("form",{onSubmit:l},o().createElement("div",{className:"cfd-password-modal__content dc-modal__container_cfd-password-modal__body cfd-password-modal__create-password-content","data-testid":"dt_create_password"},o().createElement(d.Icon,{icon:"IcDxtradeOnePassword",width:"122",height:"108"}),o().createElement(d.Text,{size:"s",align:"center",weight:"bold",className:"cfd-password-modal__create-password-title"},o().createElement(_.Localize,{i18n_default_text:"Create a {{platform}} password",values:{platform:(0,u.getCFDPlatformLabel)(r)}})),o().createElement(d.Text,{size:"xs",align:"center",className:"cfd-password-modal__create-password-description"},o().createElement(_.Localize,{i18n_default_text:"You can use this password for all your {{platform}} accounts.",values:{platform:(0,u.getCFDPlatformLabel)(r)}})),o().createElement("div",{className:"input-element"},o().createElement(d.PasswordMeter,{input:p.password,has_error:!(!m.password||!t.password),custom_feedback_messages:(0,u.getErrorMessages)().password_warnings},(function(){return o().createElement(d.PasswordInput,{autoComplete:"new-password",label:(0,_.localize)("{{platform}} password",{platform:(0,u.getCFDPlatformLabel)(r)}),error:m.password&&t.password||(0===p.password.length?i:""),name:"password",value:p.password,onBlur:n,onChange:function(e){I(e,s,g,c)},data_testId:"dt_".concat(r,"_password")})}))),o().createElement(d.FormSubmitButton,{is_disabled:!p.password||Object.keys(t).length>0,is_loading:a,label:(0,_.localize)("Create {{platform}} password",{platform:(0,u.getCFDPlatformLabel)(r)}),is_center:r!==f.$_.MT5})))}))},B=function(e){var t=e.has_mt5_account,r=e.platform,a=e.error_message,n=e.validatePassword,s=e.submitPassword,i=e.need_tnc,l=o().useRef(),c=k(o().useState(""),2),u=c[0],m=c[1],_=function(e,a){var o;r===f.$_.MT5&&t?(m(e.password),null===(o=l.current)||void 0===o||o.goNextStep()):s(e,a)},p=[{component:r===f.$_.MT5?o().createElement(D,{password:u,platform:r,error_message:a,validatePassword:n,onSubmit:_,need_tnc:i}):o().createElement(q,{password:u,platform:r,error_message:a,validatePassword:n,onSubmit:_,need_tnc:i})},{component:o().createElement(R,{className:"cfd-password-modal__change-password-confirmation",platform:r,onConfirm:function(e,t){return s({password:u},t)},onCancel:function(){var e;return null===(e=l.current)||void 0===e?void 0:e.goPrevStep()}})}];return o().createElement(d.MultiStep,{ref:l,steps:p})},V=(0,m.observer)((function(e){var t=e.closeModal,r=e.error_message,a=e.error_type,n=e.form_error,l=e.has_mt5_account,c=e.onCancel,m=e.onForgotPassword,g=e.platform,v=e.should_set_trading_password,w=e.submitPassword,b=e.validatePassword,h=e.account_type,E=(0,i.Y)().isDesktop,x=(0,y.E)().jurisdiction_selected_shortcode,M=k(o().useState(!1),2),C=M[0],P=M[1],T="svg"!==x&&h.category===f.XJ.REAL&&g===f.$_.MT5,S=o().useMemo((function(){return"PasswordReset"===a?(0,_.localize)("Try later"):(0,_.localize)("Add account")}),[a]),j=!E||!v||"PasswordReset"===a,L=function(e){return e.should_set_trading_password&&"PasswordReset"!==e.error_type?e.isDesktop?null:(0,_.localize)("Cancel"):(0,_.localize)("Forgot password?")}({should_set_trading_password:v,error_type:a,isDesktop:E}),O=function(){if(j)return v?c():m()};return"PasswordReset"===a?o().createElement(o().Fragment,null,o().createElement("div",{className:"cfd-password-reset"},o().createElement("div",{className:"cfd-password-modal__content cfd-password-modal__content--password-reset"},o().createElement(d.Text,{as:"p",line_height:"24",size:"xs"},o().createElement(_.Localize,{i18n_default_text:"Please try again in a minute."}))),o().createElement(s.Formik,{onSubmit:t,initialValues:{}},(function(e){var t=e.handleSubmit;return o().createElement("form",{onSubmit:t},o().createElement(d.FormSubmitButton,{has_cancel:j,cancel_label:L,onCancel:O,is_absolute:!E,label:S}))})))):v?o().createElement(B,{platform:g,error_message:r,validatePassword:b,submitPassword:w,has_mt5_account:l,need_tnc:T}):o().createElement(s.Formik,{initialValues:{password:""},enableReinitialize:!0,validate:b,onSubmit:w},(function(e){var t=e.errors,s=e.isSubmitting,i=e.handleBlur,l=e.handleChange,c=e.handleSubmit,m=e.setFieldTouched,w=e.touched,b=e.values,y=e.validateForm,x=e.isValid;return o().createElement("form",{onSubmit:c},o().createElement("div",{className:"cfd-password-modal__content dc-modal__container_cfd-password-modal__body"},o().createElement(p,{platform:g}),o().createElement("div",{className:"input-element"},o().createElement(d.PasswordInput,{autoComplete:"new-password",label:(0,_.localize)("{{platform}} password",{platform:(0,u.getCFDPlatformLabel)(g)}),error:w.password&&t.password||(0===b.password.length?r:""),name:"password",value:b.password,onBlur:i,onChange:function(e){I(e,l,y,m)},data_testId:"dt_".concat(g,"_password")})),"PasswordError"===a&&o().createElement(d.Text,{size:"xs",as:"p",className:"dc-modal__container_mt5-password-modal__hint"},o().createElement(_.Localize,{i18n_default_text:"Hint: You may have entered your Deriv password, which is different from your {{platform}} password.",values:{platform:(0,u.getCFDPlatformLabel)(g)}})),h.category===f.XJ.REAL&&g===f.$_.MT5&&o().createElement(z,{className:"cfd-password-modal-tnc--bottom",platform:g,checked:C,onCheck:function(){return P((function(e){return!e}))},need_tnc:T})),o().createElement(d.FormSubmitButton,{is_disabled:!b.password||!x||T&&!C,has_cancel:j,cancel_label:L,onCancel:O,is_absolute:!E,is_loading:s,label:S,is_center:v,form_error:n}))}))}));const J=(0,m.observer)((function(e){var t=e.form_error,r=e.platform,a=(0,i.Y)(),s=a.isDesktop,l=a.isMobileOrTabletLandscape,p=!s&&!l,g=(0,m.useStore)(),w=g.client,E=g.traders_hub,x=g.ui,M=w.email,C=w.account_status,P=w.is_logged_in,S=w.is_populating_mt5_account_list,O=w.is_dxtrade_allowed,D=w.mt5_login_list,z=w.updateAccountStatus,R=w.updateMT5Status,I=E.show_eu_related_content,q=E.is_eu_user,B=E.toggleAccountTransferModal,J=x.is_mt5_migration_modal_enabled,X=x.setMT5MigrationModalEnabled,Y=x.is_mt5_migration_modal_open,U=(0,y.E)(),H=U.account_type,K=U.disableCFDPasswordModal,W=U.error_message,G=U.error_type,Q=U.getAccountStatus,Z=U.has_cfd_error,ee=U.is_cfd_success_dialog_enabled,te=U.is_cfd_password_modal_enabled,re=U.setError,ae=U.setCFDSuccessDialog,oe=U.submitMt5Password,ne=U.submitCFDPassword,se=(U.new_account_response,U.product),ie=U.setMigratedMT5Accounts,le=U.is_mt5_password_changed_modal_visible,ce=U.is_mt5_password_invalid_format_modal_visible,de=U.setIsMt5PasswordInvalidFormatModalVisible,ue=U.is_sent_email_modal_enabled,me=U.setSentEmailModalStatus,_e=((0,n.useHistory)(),k(o().useState(!0),2)),fe=_e[0],pe=_e[1],ge=Boolean(null==D?void 0:D.length),ve=Array.isArray(null==C?void 0:C.status)&&C.status.includes(r===f.$_.MT5?"mt5_password_not_set":"dxtrade_password_not_set"),we="PasswordError"===G,be="PasswordReset"===G,he="InvalidTradingPlatformPasswordFormat"===G||"IncorrectMT5PasswordFormat"===G,ye=k(o().useState(""),2),Ee=ye[0],xe=ye[1];o().useEffect((function(){var e;return he&&(e=setTimeout((function(){de(!0)}),500)),function(){return clearTimeout(e)}}),[he,de]),o().useEffect((function(){P&&(R(),z())}),[]);var Me=function(e){var t,a={},o=r===f.$_.MT5&&ve?16:25;return(0,u.validLength)(e.password,{min:8,max:o})?(0,u.validPassword)(e.password)?r===f.$_.MT5&&ve&&!(0,u.validMT5Password)(e.password)&&(a.password=(0,_.localize)("Please include at least 1 special character such as ( _ @ ? ! / # ) in your password.")):a.password=(0,u.getErrorMessages)().password():a.password=(0,_.localize)("You should enter {{min_number}}-{{max_number}} characters.",{min_number:8,max_number:o}),(null===(t=e.password)||void 0===t?void 0:t.toLowerCase())===M.toLowerCase()&&(a.password=(0,_.localize)("Your password cannot be the same as your email address.")),a},Ce=function(){ae(!1),J&&X(!1),ie([]),re(!1)},Pe=function(){R(),Ce(),K()},Te=function(){Pe();var e=r===f.$_.MT5?1:2;H.category===f.XJ.REAL?e=Number("".concat(e,"0")):H.category===f.XJ.DEMO&&(e=Number("".concat(e,"1")));var t=r===f.$_.MT5?"trading_platform_mt5_password_reset":"trading_platform_dxtrade_password_reset";u.WS.verifyEmail(M,t,{url_parameters:{redirect_to:e}}),me(!0)},Se=te&&!ee&&(!Z||we||be),je=!Z&&ee&&fe,Le=je&&!J,ke=je&&J&&!S&&!Y,Oe=ue&&fe,De=o().useMemo((function(){return!!Se&&(!!ve||s)}),[ve,Se]),ze=o().useMemo((function(){return!(!Se||ve||s)}),[s,ve,Se]),Fe=o().useMemo((function(){return H.category===f.XJ.REAL?(0,_.localize)("Transfer now"):(0,_.localize)("Continue")}),[H]),Ne=o().useMemo((function(){return q&&"real"===H.category&&r===f.$_.MT5?(0,_.localize)("Maybe later"):""}),[r,H,q]),Ae=o().createElement(V,{closeModal:Pe,error_type:G,error_message:"InvalidTradingPlatformPasswordFormat"!==G?W:"",has_mt5_account:ge,form_error:t,should_set_trading_password:ve,validatePassword:Me,onForgotPassword:Te,submitPassword:function(e,t){r===f.$_.MT5?oe(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){L(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e),t):(e.platform=r,ne(e,t))},platform:r,is_dxtrade_allowed:O,onCancel:Pe,account_type:H}),Re=o().createElement(d.Modal,{className:v()("cfd-password-modal",{"cfd-password-modal__mt5":r===f.$_.MT5&&ve}),has_close_icon:!0,is_open:De,toggleModal:Pe,should_header_stick_body:!0,renderTitle:function(){return o().createElement($,{should_set_trading_password:ve,is_password_reset_error:be,platform:r})},onUnmount:function(){return Q(r)},onExited:function(){return pe(!0)},onEntered:function(){return pe(!1)},width:"auto"},Ae),$e=o().createElement(d.MobileDialog,{has_full_height:!0,portal_element_id:"modal_root",visible:De,onClose:Pe,wrapper_classname:"cfd-password-modal cfd-password-modal__mt5",renderTitle:function(){return o().createElement($,{should_set_trading_password:ve,is_password_reset_error:be,platform:r})}},Ae),Ie=o().createElement(d.MobileDialog,{has_full_height:!0,portal_element_id:"modal_root",visible:ze,onClose:Pe,wrapper_classname:"cfd-password-modal",renderTitle:function(){return o().createElement($,{should_set_trading_password:ve,has_mt5_account:ge,is_password_reset_error:be,platform:r})}},Ae),qe=o().createElement(d.Modal,{className:"cfd-password-modal",has_close_icon:!0,is_open:ce,toggleModal:Pe,should_header_stick_body:!0,title:(0,_.localize)("Deriv MT5 latest password requirements"),width:"auto"},o().createElement(F,{error_type:G,error_message:W,form_error:t,should_set_trading_password:ve,setNewPasswordValue:xe,validatePassword:Me,onForgotPassword:Te,platform:f.$_.MT5,onCancel:Pe})),Be=o().createElement(d.MobileDialog,{has_full_height:!0,portal_element_id:"modal_root",visible:ce,onClose:Pe,wrapper_classname:"cfd-password-modal cfd-password-change__wrapper",header_classname:"cfd-password-change__header",renderTitle:function(){return(0,_.localize)("Deriv MT5 latest password requirements")}},o().createElement(F,{error_type:G,error_message:W,form_error:t,should_set_trading_password:ve,setNewPasswordValue:xe,validatePassword:Me,onForgotPassword:Te,platform:f.$_.MT5,onCancel:Pe})),Ve=p?Be:qe;return o().createElement(o().Fragment,null,r===f.$_.MT5&&!s&&$e,Re,Ie,o().createElement(b,{is_open:Le,toggleModal:Pe,onCancel:Pe,onSubmit:function(){K(),Ce(),H.category===f.XJ.REAL&&B()},classNameMessage:"cfd-password-modal__message",message:function(){var e=H.category,t=H.type;if(!e&&!t)return"";var a=e===f.XJ.REAL?(0,_.localize)("real"):(0,_.localize)("demo"),n="";switch(r){case f.$_.MT5:n=(0,h.bN)(I,se)[e][t].short_title;break;case f.$_.DXTRADE:n=(0,h.cY)()[e][t].short_title;break;default:n=""}var s=function(){return r===f.$_.DXTRADE||r===f.$_.CTRADER?"":n};return e===f.XJ.REAL?o().createElement(o().Fragment,null,r===f.$_.DXTRADE||r===f.$_.CTRADER?o().createElement(_.Localize,{i18n_default_text:"Congratulations, you have successfully created your <0/>{{category}} {{platform}} {{type}} account. To start trading, <1 />transfer funds <2 />from your Deriv account into this account.",values:{type:s(),platform:(0,u.getCFDPlatformLabel)(r),category:a},components:[o().createElement("br",{key:0}),r===f.$_.CTRADER&&o().createElement("br",{key:1}),r===f.$_.DXTRADE&&o().createElement("br",{key:2})]}):o().createElement(o().Fragment,null,o().createElement(_.Localize,{i18n_default_text:"Your Deriv MT5 {{type}} account is ready. ",values:{type:s()}}),o().createElement(_.Localize,{i18n_default_text:"Enable trading with your first transfer."}))):r===f.$_.MT5?o().createElement(_.Localize,{i18n_default_text:"Your demo {{deriv}} {{type}} account is ready.",values:{type:s(),deriv:"Deriv MT5"}}):o().createElement(_.Localize,{i18n_default_text:"Congratulations, you have successfully created your <0/>{{category}} {{platform}} {{type}} account. ",values:{type:s(),platform:q?"":(0,u.getCFDPlatformLabel)(r),category:a},components:[o().createElement("br",{key:0})]})}(),icon:o().createElement(N,{platform:r,type:H.type,show_eu_related_content:I,product:se}),icon_size:"xlarge",text_submit:Fe,text_cancel:Ne,has_cancel:H.category===f.XJ.REAL,has_close_icon:!1,width:"auto",is_medium_button:!s}),o().createElement(T,{is_open:ke,closeModal:Pe}),o().createElement(c(),{is_open:Oe,identifier_title:"trading_password",onClose:function(){return me(!1)},onClickSendEmail:Te}),he&&Ve,le&&o().createElement(A,{closeModal:Pe,password_value:Ee}))}))},"@deriv/account/dist/account/js/sent-email-modal":t=>{t.exports=e},"@deriv/components":e=>{e.exports=t},"@deriv/hooks":e=>{e.exports=r},"@deriv/shared":e=>{e.exports=a},"@deriv/stores":e=>{e.exports=o},"@deriv/translations":e=>{e.exports=n},classnames:e=>{e.exports=s},formik:e=>{e.exports=i},react:e=>{e.exports=l},"react-router":e=>{e.exports=c},"../../node_modules/@deriv-com/ui/dist/_commonjsHelpers-BkfeUUK-.js":(e,t,r)=>{r.d(t,{c:()=>a});var a=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{}},"../../node_modules/@deriv-com/ui/dist/hooks/useDevice.js":(e,t,r)=>{r.d(t,{Y:()=>o});var a=r("../../node_modules/@deriv-com/ui/dist/index-EY1gwl5O.js");const o=()=>({isDesktop:(0,a.u)("(min-width: 1280px)"),isMobile:(0,a.u)("(max-width: 600px)"),isTablet:(0,a.u)("(min-width: 601px) and (max-width: 1279px)"),isTabletPortrait:(0,a.u)("(min-width: 601px) and (max-width: 1279px) and (orientation: portrait)"),isMobileOrTabletLandscape:(0,a.u)("(max-width: 1279px) and (orientation: landscape)")})},"../../node_modules/@deriv-com/ui/dist/index-EY1gwl5O.js":(e,t,r)=>{r.d(t,{u:()=>c});var a=r("react"),o=r("../../node_modules/@deriv-com/ui/dist/_commonjsHelpers-BkfeUUK-.js"),n="object"==typeof o.c&&o.c&&o.c.Object===Object&&o.c,s="object"==typeof self&&self&&self.Object===Object&&self;n||s||Function("return this")();var i=typeof window<"u"?a.useLayoutEffect:a.useEffect,l=typeof window>"u";function c(e,{defaultValue:t=!1,initializeWithValue:r=!0}={}){const o=e=>l?t:window.matchMedia(e).matches,[n,s]=(0,a.useState)((()=>r?o(e):t));function c(){s(o(e))}return i((()=>{const t=window.matchMedia(e);return c(),t.addListener?t.addListener(c):t.addEventListener("change",c),()=>{t.removeListener?t.removeListener(c):t.removeEventListener("change",c)}}),[e]),n}}},g={};function v(e){var t=g[e];if(void 0!==t)return t.exports;var r=g[e]={exports:{}};return p[e](r,r.exports,v),r.exports}v.m=p,d=[],v.O=(e,t,r,a)=>{if(!t){var o=1/0;for(l=0;l<d.length;l++){for(var[t,r,a]=d[l],n=!0,s=0;s<t.length;s++)(!1&a||o>=a)&&Object.keys(v.O).every((e=>v.O[e](t[s])))?t.splice(s--,1):(n=!1,a<o&&(o=a));if(n){d.splice(l--,1);var i=r();void 0!==i&&(e=i)}}return e}a=a||0;for(var l=d.length;l>0&&d[l-1][2]>a;l--)d[l]=d[l-1];d[l]=[t,r,a]},v.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return v.d(t,{a:t}),t},v.d=(e,t)=>{for(var r in t)v.o(t,r)&&!v.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},v.f={},v.e=e=>Promise.all(Object.keys(v.f).reduce(((t,r)=>(v.f[r](e,t),t)),[])),v.u=e=>"assets"===e?"cfd/js/"+e+".js":"cfd/js/cfd."+e+"."+{"src_Containers_mt5-create-password_mt5-create-password_tsx":"e9ee4ab0c15d40673e8b","src_Containers_cfd-password-modal-tnc_tsx":"4e83d82883533e2c5044","src_Containers_cfd-password-change_tsx":"5e26bd913280399de9e4","src_Containers_cfd-password-success-icon_tsx":"e3ab986661919ac107e6","src_Containers_cfd-password-change-content_tsx":"6640cb3e341912e06752","src_Containers_cfd-change-password-confirmation_tsx":"c67f2a9c29612c8ff7e3"}[e]+".js",v.miniCssF=e=>"CFDPasswordModal"===e?"cfd/css/cfd.main.d4e5ebe150b04bab25f1.css":"cfd/css/cfd."+e+".8dd0e6e57d8ff43870f2.css",v.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u={},m="@deriv/cfd:",v.l=(e,t,r,a)=>{if(u[e])u[e].push(t);else{var o,n;if(void 0!==r)for(var s=document.getElementsByTagName("script"),i=0;i<s.length;i++){var l=s[i];if(l.getAttribute("src")==e||l.getAttribute("data-webpack")==m+r){o=l;break}}o||(n=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,v.nc&&o.setAttribute("nonce",v.nc),o.setAttribute("data-webpack",m+r),o.src=e),u[e]=[t];var c=(t,r)=>{o.onerror=o.onload=null,clearTimeout(d);var a=u[e];if(delete u[e],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach((e=>e(r))),t)return t(r)},d=setTimeout(c.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=c.bind(null,o.onerror),o.onload=c.bind(null,o.onload),n&&document.head.appendChild(o)}},v.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},v.j="CFDPasswordModal",v.p="/",_=e=>new Promise(((t,r)=>{var a=v.miniCssF(e),o=v.p+a;if(((e,t)=>{for(var r=document.getElementsByTagName("link"),a=0;a<r.length;a++){var o=(s=r[a]).getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(o===e||o===t))return s}var n=document.getElementsByTagName("style");for(a=0;a<n.length;a++){var s;if((o=(s=n[a]).getAttribute("data-href"))===e||o===t)return s}})(a,o))return t();((e,t,r,a)=>{var o=document.createElement("link");o.rel="stylesheet",o.type="text/css",o.onerror=o.onload=n=>{if(o.onerror=o.onload=null,"load"===n.type)r();else{var s=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=s,l.request=i,o.parentNode.removeChild(o),a(l)}},o.href=t,document.head.appendChild(o)})(e,o,t,r)})),f={CFDPasswordModal:0},v.f.miniCss=(e,t)=>{f[e]?t.push(f[e]):0!==f[e]&&{"src_Containers_mt5-create-password_mt5-create-password_tsx":1}[e]&&t.push(f[e]=_(e).then((()=>{f[e]=0}),(t=>{throw delete f[e],t})))},(()=>{var e={CFDPasswordModal:0};v.f.j=(t,r)=>{var a=v.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var o=new Promise(((r,o)=>a=e[t]=[r,o]));r.push(a[2]=o);var n=v.p+v.u(t),s=new Error;v.l(n,(r=>{if(v.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var o=r&&("load"===r.type?"missing":r.type),n=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+n+")",s.name="ChunkLoadError",s.type=o,s.request=n,a[1](s)}}),"chunk-"+t,t)}},v.O.j=t=>0===e[t];var t=(t,r)=>{var a,o,[n,s,i]=r,l=0;if(n.some((t=>0!==e[t]))){for(a in s)v.o(s,a)&&(v.m[a]=s[a]);if(i)var c=i(v)}for(t&&t(r);l<n.length;l++)o=n[l],v.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return v.O(c)},r=self.webpackChunk_deriv_cfd=self.webpackChunk_deriv_cfd||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var w=v.O(void 0,["internalCFDStoreUsage","utilities"],(()=>v("./src/Containers/cfd-password-modal.tsx")));return(w=v.O(w)).default})()));