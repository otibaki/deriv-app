"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1470],{37811:(e,t,i)=>{i.d(t,{A:()=>c});var o=i(286326),n=i(237064),r=i(57886),a=i(919796),s=i(33118),l=i(836870);const c=e=>{let{children:t,has_side_note:i,side_note:c,side_note_position:d="left",type:u="text"}=e;const{isDesktop:_}=(0,a.Y)();return i?(0,l.jsxs)("div",{"data-testid":"dt_side_note_container",className:(0,n.A)("account-form__section",{"account-form__section--reversed":"right"===d}),children:[(0,l.jsx)("div",{className:(0,n.A)("account-form__section-side-note",{"account-form__section-side-note__example":"text"!==u}),children:"text"===u?(0,l.jsx)(r.Text,{color:"less-prominent",size:_?"xs":"xxs","data-testid":"dt_side_note_text",children:c}):(0,l.jsxs)(o.Fragment,{children:[(0,l.jsx)(r.Text,{as:"p",size:_?"xs":"xxs",weight:"bold",children:(0,l.jsx)(s.Localize,{i18n_default_text:"Example :"})}),(0,l.jsx)("div",{className:"account-form__section-side-note__example-image",children:c})]})}),(0,l.jsx)("div",{className:"account-form__section-content",children:t})]}):t}},138768:(e,t,i)=>{i.d(t,{A:()=>s});var o=i(286326),n=i(237064),r=i(57886),a=i(836870);const s=e=>{let{description:t,subtitle:i,title:s,title_text_size:l="xs"}=e;const c=s.replace(/\s+/g,"-").toLowerCase();return(0,a.jsxs)(o.Fragment,{children:[(0,a.jsx)("div",{className:(0,n.A)("account-form__header",c,{"account-form__header--has-description":!!t}),"data-testid":"form-sub-header",children:(0,a.jsxs)("div",{className:"account-form__header-section",children:[(0,a.jsx)(r.Text,{as:"h1",color:"prominent",weight:"bold",size:l,className:"account-form__title",children:s}),i&&(0,a.jsx)(r.Text,{as:"h2",size:"xxxs",color:"prominent",className:"account-form__subtitle",children:i})]})}),t&&(0,a.jsx)(r.Text,{as:"p",className:"account-form__description",children:t})]})}},16958:(e,t,i)=>{i.d(t,{XU:()=>b,bE:()=>O,lp:()=>d,t$:()=>D,Oz:()=>N});i(286326);var o=i(824223),n=i(57886),r=i(836870);const a=["name","warn"];function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function l(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){c(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function c(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const d=e=>{let{name:t,warn:i}=e,s=function(e,t){if(null==e)return{};var i,o,n=function(e,t){if(null==e)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.includes(o))continue;i[o]=e[o]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)i=r[o],t.includes(i)||{}.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}(e,a);return(0,r.jsx)(o.Field,{name:t,children:e=>{let{field:t,form:{errors:o,touched:a,setFieldTouched:c}}=e;return(0,r.jsx)(n.Input,l(l(l({},t),s),{},{type:"text",autoComplete:"off",error:a[t.name]&&o[t.name]?o[t.name]:void 0,warn:i,onChange:e=>{!a[t.name]&&c(t.name),t.onChange(e)}}))}})};var u=i(189137);const _=["name","portal_id"];function m(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function f(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?m(Object(i),!0).forEach((function(t){p(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function p(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const b=e=>{let{name:t,portal_id:i}=e,a=function(e,t){if(null==e)return{};var i,o,n=function(e,t){if(null==e)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.includes(o))continue;i[o]=e[o]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)i=r[o],t.includes(i)||{}.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}(e,_);return(0,r.jsx)(o.Field,{name:t,children:e=>{let{field:o,form:{setFieldValue:s},meta:{error:l,touched:c}}=e;return(0,r.jsx)(n.DateOfBirthPicker,f(f(f({},a),o),{},{error:c?l:void 0,name:t,onChange:e=>{let{target:i}=e;return s(t,null!=i&&i.value?(0,u.toMoment)(i.value).format("YYYY-MM-DD"):"",!0)},portal_id:i}))}})};var h=i(596176);const y=()=>[{text:(0,h.localize)("Employed"),value:"Employed"},{text:(0,h.localize)("Pensioner"),value:"Pensioner"},{text:(0,h.localize)("Self-Employed"),value:"Self-Employed"},{text:(0,h.localize)("Student"),value:"Student"},{text:(0,h.localize)("Unemployed"),value:"Unemployed"}];var x=i(919796),v=i(237064);function g(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function j(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?g(Object(i),!0).forEach((function(t){z(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):g(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function z(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const O=e=>{let{required:t,is_disabled:i,fieldFocused:a}=e;const{isDesktop:s}=(0,x.Y)(),{localize:l}=(0,h.useTranslations)();return(0,r.jsx)(o.Field,{name:"employment_status",children:e=>{let{field:o,form:{setFieldValue:c,setFieldTouched:d,handleBlur:u,handleChange:_},meta:m}=e;return(0,r.jsx)("div",{className:"employment-status-field",children:s?(0,r.jsx)(n.Dropdown,j(j({},o),{},{placeholder:l(t?"Employment status*":"Employment status"),is_align_text_left:!0,name:o.name,list:y(),value:o.value,onChange:e=>{var t;c("tin_skipped",0,!0),c(o.name,null===(t=e.target)||void 0===t?void 0:t.value,!0),_(e)},handleBlur:u,error:m.touched?m.error:void 0,disabled:i,className:(0,v.A)("dropdown-field",{"focus-field":a})})):(0,r.jsx)(n.SelectNative,j(j({},o),{},{placeholder:l("Please select"),name:o.name,label:l(t?"Employment status*":"Employment status"),list_items:y(),value:o.value,error:m.touched?m.error:void 0,onChange:e=>{c("tin_skipped",0,!0),d("employment_status",!0),_(e)},disabled:i,className:(0,v.A)({"focus-field":a})}))})}})};var w=i(809003);function P(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function S(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?P(Object(i),!0).forEach((function(t){k(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):P(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function k(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const N=e=>{let{required:t=!1,setIsTaxResidencePopoverOpen:i,setIsTinPopoverOpen:a,is_tax_residence_popover_open:s,disabled:l,fieldFocused:c}=e;const{data:d}=(0,w.A)(),{isDesktop:u}=(0,x.Y)(),{localize:_}=(0,h.useTranslations)();return(0,r.jsx)(o.Field,{name:"tax_residence",children:e=>{let{field:o,form:{setFieldValue:m},meta:f}=e;return(0,r.jsxs)("div",{className:"details-form__tax",children:[u?(0,r.jsx)(n.Autocomplete,S(S({},o),{},{"data-lpignore":"true",autoComplete:"off",label:_(t?"Tax residence*":"Tax residence"),error:f.touched?f.error:void 0,list_items:d,onItemSelection:e=>{m("tax_residence",e.value?e.text:"",!0)},"data-testid":"tax_residence",disabled:l,required:t,className:(0,v.A)({"focus-field":c})})):(0,r.jsx)(n.SelectNative,S(S({},o),{},{placeholder:_(t?"Tax residence*":"Tax residence"),name:o.name,label:_(t?"Tax residence*":"Tax residence"),list_items:d,value:o.value,use_text:!0,error:f.touched?f.error:"",onChange:e=>{o.onChange(e),m("tax_residence",e.target.value,!0)},required:t,data_testid:"tax_residence_mobile",disabled:l,className:(0,v.A)({"focus-field":c})})),(0,r.jsx)("div",{"data-testid":"tax_residence_pop_over",onClick:e=>{i(!0),a(!1),e.stopPropagation()},children:(0,r.jsx)(n.Popover,{alignment:u?"right":"left",icon:"info",message:_("The country in which you meet the criteria for paying taxes. Usually the country in which you physically reside."),zIndex:"9998",disable_message_icon:!0,is_open:s})})]})}})},D=e=>{let{required:t=!1,is_tin_popover_open:i,setIsTinPopoverOpen:o,setIsTaxResidencePopoverOpen:a,disabled:s,fieldFocused:l}=e;const{localize:c}=(0,h.useTranslations)(),{isDesktop:u}=(0,x.Y)();return(0,r.jsxs)("div",{className:"details-form__tax",children:[(0,r.jsx)(d,{name:"tax_identification_number",label:c(t?"Tax identification number*":"Tax identification number"),placeholder:c("Tax identification number"),"data-testid":"tax_identification_number",disabled:s,required:t,className:(0,v.A)({"focus-field":l})}),(0,r.jsx)("div",{"data-testid":"tax_identification_number_pop_over",onClick:e=>{a(!1),o(!0),"A"!==e.target.tagName&&e.stopPropagation()},children:(0,r.jsx)(n.Popover,{alignment:u?"right":"left",icon:"info",is_open:i,message:(0,r.jsx)(h.Localize,{i18n_default_text:"Don't know your tax identification number? Click <0>here</0> to learn more.",components:[(0,r.jsx)("a",{className:"link link--red",rel:"noopener noreferrer",target:"_blank",href:"https://www.oecd.org/tax/automatic-exchange/crs-implementation-and-assistance/tax-identification-numbers/"},0)]}),zIndex:"9998",disable_message_icon:!0})})]})}},434828:(e,t,i)=>{i.d(t,{A:()=>p});var o=i(286326),n=i(237064),r=i(824223),a=i(57886),s=i(189137),l=i(33118),c=i(837062),d=i(919796),u=i(836870);function _(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function m(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?_(Object(i),!0).forEach((function(t){f(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):_(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function f(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const p=e=>{var t,i,_,f;let{class_name:p,selected_country:b,hide_hint:h,is_for_real_account_signup_modal:y=!1,is_for_mt5:x=!1}=e;const[v,g]=o.useState([]),[j,z]=o.useState(""),{isDesktop:O}=(0,d.Y)(),{documents_supported:w}=null!==(t=null==b||null===(i=b.identity)||void 0===i||null===(i=i.services)||void 0===i?void 0:i.idv)&&void 0!==t?t:{},{errors:P,touched:S,values:k,handleBlur:N,handleChange:D,setFieldValue:C}=(0,r.useFormikContext)(),T={id:"",text:"",value:"",example_format:""},A=o.useMemo((()=>(0,s.getIDVNotApplicableOption)(y)),[y]);o.useEffect((()=>{if(w&&b&&b.value){const e=Object.keys(w);if(0===e.length)return;const t=e.map((e=>{var t;const{display_name:i,format:o}=w[e],{new_display_name:n,example_format:r,additional_document_example_format:a}=(0,c.UC)(null!==(t=b.value)&&void 0!==t?t:"",e);var s,l;return w[e].additional?{id:e,text:null!=i?i:n,additional:{display_name:null===(s=w[e].additional)||void 0===s?void 0:s.display_name,format:null===(l=w[e].additional)||void 0===l?void 0:l.format,example_format:a},value:o,example_format:r}:{id:e,text:null!=i?i:n,value:o,example_format:r}}));g([...t,A])}}),[w,b,A,x]);const I=()=>{C("document_type",T,!0)},E=e=>{var t;return null!==(t=v.find((t=>t.text===e)))&&void 0!==t?t:T},F=(e,t)=>{var i,o,n;const r="document_number"===t?null==k||null===(i=k.document_type)||void 0===i?void 0:i.example_format:null==k||null===(o=k.document_type)||void 0===o||null===(o=o.additional)||void 0===o?void 0:o.example_format;let a=null;a=null!=r&&r.includes("-")?(0,s.formatInput)(r,null!==(n=a)&&void 0!==n?n:e.target.value,"-"):e.target.value,C(t,a,!0)},L=e=>{C("document_type",e,!0),z(null==e?void 0:e.id),(null==e?void 0:e.id)===A.id&&(C("document_number","",!1),C("document_additional","",!1))};return(0,u.jsx)("section",{className:(0,n.A)("idv-form",p),children:(0,u.jsx)("div",{className:"details-form",children:(0,u.jsx)("div",{className:"poi-form-on-signup__fields",children:(0,u.jsx)("div",{className:(0,n.A)("proof-of-identity__container",{"proof-of-identity__container--idv":h}),children:(0,u.jsx)("div",{className:(0,n.A)("proof-of-identity__inner-container"),children:(0,u.jsxs)("div",{className:"proof-of-identity__fieldset-container",children:[(0,u.jsx)("fieldset",{className:(0,n.A)({"proof-of-identity__fieldset":!h}),children:(0,u.jsx)(r.Field,{name:"document_type",children:e=>{let{field:t}=e;return(0,u.jsx)(o.Fragment,{children:O?(0,u.jsx)(a.Autocomplete,m(m({},t),{},{"data-lpignore":"true",error:S.document_type&&P.document_type,autoComplete:"off",type:"text",label:(0,l.localize)("Choose the document type"),list_items:v,value:k.document_type.text,onBlur:e=>{N(e),E(e.target.value)||I()},onChange:D,onItemSelection:e=>{"No results found"!==e.text&&e.text?L(e):(z(""),I())},required:!0})):(0,u.jsx)(a.SelectNative,m(m({},t),{},{name:"document_type",error:S.document_type&&P.document_type,label:(0,l.localize)("Choose the document type"),placeholder:(0,l.localize)("Please select"),list_items:v,value:k.document_type.text,onChange:e=>{D(e);const t=E(e.target.value);L(t)},use_text:!0,required:!0}))})}})}),(null==k||null===(_=k.document_type)||void 0===_?void 0:_.id)!==A.id&&(0,u.jsxs)(o.Fragment,{children:[(0,u.jsx)("fieldset",{className:(0,n.A)("additional-field",{"proof-of-identity__fieldset-input":!h}),children:(0,u.jsx)(r.Field,{name:"document_number",children:e=>{var t;let{field:i}=e;return(0,u.jsx)(a.Input,m(m({},i),{},{name:"document_number",bottom_label:k.document_type&&(0,c.mQ)(null!==(t=k.document_type.example_format)&&void 0!==t?t:""),disabled:!k.document_type.id,error:k.document_type.id&&S.document_number&&P.document_number||P.error_message,autoComplete:"off",placeholder:(0,c._c)(j),value:k.document_number,onPaste:c.bu,onBlur:N,onChange:D,onKeyUp:e=>F(e,"document_number"),required:!0,label:k.document_type.id&&(0,c._c)(j)}))}})}),(null===(f=k.document_type.additional)||void 0===f?void 0:f.display_name)&&(0,u.jsx)("fieldset",{className:"additional-field",children:(0,u.jsx)(r.Field,{name:"document_additional",children:e=>{var t,i,o;let{field:n}=e;const r=(0,l.localize)("Enter your {{document_name}}",{document_name:null!==(t=null===(i=k.document_type)||void 0===i||null===(i=i.additional)||void 0===i||null===(i=i.display_name)||void 0===i?void 0:i.toLowerCase())&&void 0!==t?t:(0,l.localize)("additional document number")});return(0,u.jsx)(a.Input,m(m({},n),{},{name:"document_additional",bottom_label:k.document_type.additional&&(0,c.mQ)(null===(o=k.document_type.additional)||void 0===o?void 0:o.example_format),disabled:!k.document_type.id,error:S.document_additional&&P.document_additional||P.error_message,autoComplete:"off",placeholder:r,value:k.document_additional,onPaste:c.bu,onBlur:N,onChange:D,onKeyUp:e=>F(e,"document_additional"),required:!0}))}})})]})]})})})})})})}},791768:(e,t,i)=>{i.d(t,{A:()=>P});var o=i(286326),n=i(822833),r=i(237064),a=i(824223),s=i(57886),l=i(189137),c=i(33118),d=i(837062),u=i(37811),_=i(16958),m=i(138768),f=i(835070),p=i(809003),b=i(919796),h=i(596176),y=i(836870);function x(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function v(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?x(Object(i),!0).forEach((function(t){g(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):x(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function g(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const j=e=>{let{required:t,account_opening_reason_list:i,setFieldValue:n,disabled:l,fieldFocused:c,is_modal:d}=e;const{isDesktop:u}=(0,b.Y)(),{localize:_}=(0,h.useTranslations)();return(0,y.jsx)(o.Fragment,{children:(0,y.jsx)(a.Field,{name:"account_opening_reason",children:e=>{let{field:o,meta:a}=e;return(0,y.jsx)("div",{className:"account-form__fieldset",id:"account-opening-reason",children:u?(0,y.jsx)(s.Dropdown,v(v({placeholder:_(t?"Account opening reason*":"Account opening reason")},o),{},{disabled:l,is_align_text_left:!0,list:i,error:a.touched&&a.error?a.error:"",required:!0,className:(0,r.A)({"focus-field":c}),list_portal_id:d?"modal_root":""})):(0,y.jsx)(s.SelectNative,v(v({placeholder:_("Please select")},o),{},{label:_(t?"Account opening reason*":"Account opening reason"),list_items:i,error:a.touched&&a.error?a.error:"",onChange:e=>{o.onChange(e),n("account_opening_reason",e.target.value,!0)},required:!0,data_testid:"account_opening_reason_mobile",disabled:l,className:(0,r.A)({"focus-field":c})}))})}})})};function z(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function O(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?z(Object(i),!0).forEach((function(t){w(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):z(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function w(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const P=e=>{const{isDesktop:t}=(0,b.Y)(),{inline_note_text:i,is_virtual:h,is_eu_user:x,is_svg:v,is_rendered_for_idv:g,editable_fields:z=[],has_real_account:w,is_fully_authenticated:P,account_opening_reason_list:N,closeRealAccountSignup:D,salutation_list:C,is_rendered_for_onfido:T,is_qualified_for_poa:A,class_name:I,states_list:E,side_note:F,no_confirmation_needed:L,mismatch_status:R}=e,M=v&&!x,{errors:U,touched:Y,values:B,setFieldValue:V,handleChange:q,handleBlur:$}=(0,a.useFormikContext)(),{data:W}=(0,p.A)(),G=()=>{const e=v||x||T||g;return{first_name_label:e?(0,c.localize)("First name*"):(0,c.localize)("First name"),last_name_label:e?(0,c.localize)("Last name*"):(0,c.localize)("Last name"),dob_label:e?(0,c.localize)("Date of birth*"):(0,c.localize)("Date of birth")}},H=g||T,Q=e=>M||H?(0,y.jsx)(c.Localize,{i18n_default_text:"Your {{ field_name }} as in your identity document",values:{field_name:e}}):(0,y.jsx)(c.Localize,{i18n_default_text:"Please enter your {{ field_name }} as in your official identity documents.",values:{field_name:e}}),Z=(0,y.jsx)(c.Localize,{i18n_default_text:"Use the same address that appears on your proof of address (utility bill, bank statement, etc.)."}),J=(0,d.RC)(R).some((e=>!B[e]||U[e]));return(0,y.jsxs)(o.Fragment,{children:[(0,y.jsxs)("div",{className:(0,r.A)(I,{"account-form__poi-confirm-example":g}),children:[(M||H)&&(0,y.jsx)("div",{className:"account-form__poi-inline-message",children:(0,y.jsx)(s.InlineMessage,{message:i,size:"md"})}),A&&(0,y.jsx)(f.A,{icon:"IcAlertWarning",message:Z,font_size:t?"xs":"xxxs"}),(0,y.jsx)(u.A,{has_side_note:H||M,side_note:F,side_note_position:"right",type:"image",children:(0,y.jsxs)("fieldset",{className:"account-form__fieldset",children:["salutation"in B&&!x&&(0,y.jsx)("div",{children:(0,y.jsx)(s.Text,{size:t?"xxs":"xs",align:!t&&"center",children:h?(0,c.localize)("Please remember that it is your responsibility to keep your answers accurate and up to date. You can update your personal details at any time in your account settings."):(0,y.jsx)(c.Localize,{i18n_default_text:"Please remember that it is your responsibility to keep your answers accurate and up to date. You can update your personal details at any time in your <0>account settings</0>.",components:[(0,y.jsx)(n.Link,{to:l.routes.personal_details,className:"link",onClick:D},0)]})})}),x&&!T&&!A&&(0,y.jsx)(m.A,{title:"salutation"in B?(0,c.localize)("Title and name"):(0,c.localize)("Name")}),"salutation"in B&&(0,y.jsx)("span",{onClick:e=>{var t,i;"radio"===(null===(t=e.target)||void 0===t?void 0:t.type)&&V("salutation",null===(i=e.target)||void 0===i?void 0:i.value)},children:(0,y.jsx)(s.RadioGroup,{className:"dc-radio__input",name:"salutation",selected:B.salutation,onToggle:e=>{e.persist(),V("salutation",e.target.value)},required:!0,children:C.map((e=>(0,y.jsx)(s.RadioGroup.Item,{label:e.label,value:e.value,disabled:!!B.salutation&&(0,d.dS)("salutation",z),has_error:!(!Y.salutation||!U.salutation)},e.value)))})}),"first_name"in B&&(0,y.jsx)(_.lp,{name:"first_name",required:v,label:G().first_name_label,hint:Q((0,c.localize)("first name")),disabled:(0,d.dS)("first_name",z)||(null==B?void 0:B.first_name)&&w,placeholder:(0,c.localize)("John"),"data-testid":"first_name"}),"last_name"in B&&(0,y.jsx)(_.lp,{name:"last_name",required:v,label:G().last_name_label,hint:Q((0,c.localize)("last name")),disabled:(0,d.dS)("last_name",z)||(null==B?void 0:B.last_name)&&w,placeholder:(0,c.localize)("Doe"),"data-testid":"last_name"}),x&&!A&&(0,y.jsx)(m.A,{title:(0,c.localize)("Other details")}),"date_of_birth"in B&&(0,y.jsx)(_.XU,{name:"date_of_birth",required:v,label:G().dob_label,hint:Q((0,c.localize)("date of birth")),disabled:(0,d.dS)("date_of_birth",z)||(null==B?void 0:B.date_of_birth)&&w,placeholder:(0,c.localize)("01-07-1999"),portal_id:"modal_root",data_testid:"date_of_birth"}),"address_line_1"in B&&(0,y.jsx)(_.lp,{name:"address_line_1",label:(0,c.localize)("First line of address*"),disabled:(0,d.dS)("address_line_1",z),"data-testid":"address_line_1",autoComplete:"off","data-lpignore":"true",type:"text",maxLength:70,required:!0,onBlur:$,error:Y.address_line_1&&U.address_line_1,value:B.address_line_1}),"address_line_2"in B&&(0,y.jsx)(_.lp,{name:"address_line_2",label:(0,c.localize)("Second line of address (optional)"),disabled:(0,d.dS)("address_line_2",z),"data-testid":"address_line_2",autoComplete:"off","data-lpignore":"true",type:"text",maxLength:70,onBlur:$,error:Y.address_line_2&&U.address_line_2,value:B.address_line_2}),"address_city"in B&&(0,y.jsx)(_.lp,{name:"address_city",label:(0,c.localize)("Town/City*"),disabled:(0,d.dS)("address_city",z),"data-testid":"address_city",autoComplete:"off","data-lpignore":"true",type:"text",maxLength:70,required:!0,onBlur:$,error:Y.address_city&&U.address_city,value:B.address_city}),"address_state"in B&&(null!=E&&E.length?(0,y.jsx)(o.Fragment,{children:t?(0,y.jsx)(a.Field,{name:"address_state",children:e=>{let{field:t}=e;return(0,y.jsx)(s.Autocomplete,O(O({},t),{},{"data-lpignore":"true",autoComplete:"new-password",type:"text",label:(0,c.localize)("State/Province"),error:Y.address_state&&U.address_state,list_items:E,onItemSelection:e=>{let{value:t,text:i}=e;return V("address_state",t?i:"",!0)}}))}}):(0,y.jsx)(s.SelectNative,{placeholder:(0,c.localize)("Please select"),label:(0,c.localize)("State/Province"),value:B.address_state,list_items:E,error:Y.address_state&&U.address_state,use_text:!0,onChange:e=>V("address_state",e.target.value,!0)})}):(0,y.jsx)(_.lp,{"data-lpignore":"true",autoComplete:"off",type:"text",name:"address_state",label:(0,c.localize)("State/Province"),value:B.address_state,error:Y.address_state&&U.address_state,onBlur:$})),"address_postcode"in B&&(0,y.jsx)(_.lp,{name:"address_postcode",label:(0,c.localize)("Postal/ZIP code"),disabled:(0,d.dS)("address_postcode",z),"data-testid":"address_postcode",autoComplete:"off","data-lpignore":"true",type:"text",maxLength:70,onBlur:$,error:Y.address_postcode&&U.address_postcode,value:B.address_postcode}),!M&&"place_of_birth"in B&&(0,y.jsx)(k,{handleChange:q,setFieldValue:V,disabled:(0,d.dS)("place_of_birth",z),residence_list:W,required:!0}),"citizen"in B&&(0,y.jsx)(a.Field,{name:"citizen",children:e=>{let{field:i}=e;return(0,y.jsx)(o.Fragment,{children:t?(0,y.jsx)(s.Autocomplete,O(O({},i),{},{"data-lpignore":"true",autoComplete:"none",type:"text",label:x?(0,c.localize)("Citizenship*"):(0,c.localize)("Citizenship"),error:Y.citizen&&U.citizen,disabled:(null==B?void 0:B.citizen)&&P||(0,d.dS)("citizen",z)||(null==B?void 0:B.citizen)&&w,list_items:W,onItemSelection:e=>{let{value:t,text:i}=e;return V("citizen",t?i:"",!0)},list_portal_id:"modal_root",required:!0,"data-testid":"citizenship"})):(0,y.jsx)(s.SelectNative,O(O({placeholder:(0,c.localize)("Citizenship"),name:i.name,disabled:(null==B?void 0:B.citizen)&&P||(0,d.dS)("citizen",z)||(null==B?void 0:B.citizen)&&w,label:x?(0,c.localize)("Citizenship*"):(0,c.localize)("Citizenship"),list_items:W,value:B.citizen,use_text:!0,error:Y.citizen&&U.citizen,onChange:e=>{q(e),V("citizen",e.target.value,!0)}},i),{},{required:!0,should_hide_disabled_options:!1,data_testid:"citizenship_mobile"}))})}}),!M&&"phone"in B&&(0,y.jsx)(S,{value:B.phone,editable_fields:z,has_real_account:w,required:!0}),!M&&"account_opening_reason"in B&&(0,y.jsx)(j,{required:!0,account_opening_reason_list:N,setFieldValue:V,disabled:(0,d.dS)("account_opening_reason",z)||(null==B?void 0:B.account_opening_reason)&&w})]})}),!L&&g&&(0,y.jsx)(s.Checkbox,{name:"confirmation_checkbox",className:"formik__confirmation-checkbox",value:B.confirmation_checkbox,label:(0,y.jsx)(c.Localize,{i18n_default_text:"I confirm that the name and date of birth above match my chosen identity document"}),label_font_size:t?"xs":"xxs",disabled:J,onChange:q,has_error:!(!Y.confirmation_checkbox||!U.confirmation_checkbox)})]}),M&&(0,y.jsxs)("div",{className:"account-form__poi-additional-information",children:[(0,y.jsx)(m.A,{title:(0,c.localize)("Additional information")}),"phone"in B&&(0,y.jsx)(S,{value:B.phone,editable_fields:z,has_real_account:w,required:!0}),(0,y.jsxs)(o.Fragment,{children:["place_of_birth"in B&&(0,y.jsx)(k,{handleChange:q,setFieldValue:V,disabled:(0,d.dS)("place_of_birth",z),residence_list:W,required:!0}),"account_opening_reason"in B&&(0,y.jsx)(j,{account_opening_reason_list:N,setFieldValue:V,disabled:(0,d.dS)("account_opening_reason",z)||(null==B?void 0:B.account_opening_reason)&&w,required:!0,is_modal:!0})]})]})]})},S=e=>{let{value:t,editable_fields:i,has_real_account:o,required:n}=e;return(0,y.jsx)(_.lp,{name:"phone",label:n?(0,c.localize)("Phone number*"):(0,c.localize)("Phone number"),placeholder:n?(0,c.localize)("Phone number*"):(0,c.localize)("Phone number"),disabled:(0,d.dS)("phone",i)||t&&o&&(0,l.validPhone)(t)&&(null==t?void 0:t.length)>=9&&(null==t?void 0:t.length)<=35,maxLength:50,"data-testid":"phone"})},k=e=>{let{handleChange:t,setFieldValue:i,disabled:n,residence_list:r,required:l}=e;const{isDesktop:d}=(0,b.Y)();return(0,y.jsx)(a.Field,{name:"place_of_birth",children:e=>{let{field:a,meta:u}=e;return(0,y.jsx)(o.Fragment,{children:d?(0,y.jsx)(s.Autocomplete,O(O({},a),{},{disabled:n,"data-lpignore":"true",autoComplete:"none",type:"text",label:l?(0,c.localize)("Place of birth*"):(0,c.localize)("Place of birth"),error:u.touched&&u.error,list_items:r,onItemSelection:e=>{let{value:t,text:o}=e;return i("place_of_birth",t?o:"",!0)},required:!0,"data-testid":"place_of_birth"})):(0,y.jsx)(s.SelectNative,O(O({placeholder:(0,c.localize)("Place of birth"),name:a.name,disabled:n,label:l?(0,c.localize)("Place of birth*"):(0,c.localize)("Place of birth"),list_items:r,value:a.value,use_text:!0,error:u.touched&&u.error,onChange:e=>{t(e),i("place_of_birth",e.target.value,!0)}},a),{},{list_portal_id:"modal_root",required:!0,should_hide_disabled_options:!1,data_testid:"place_of_birth_mobile"}))})}})}},114321:(e,t,i)=>{i.d(t,{A:()=>s});i(286326);var o=i(237064),n=i(57886),r=i(919796),a=i(836870);const s=e=>{let{children:t,className:i,full_width:s,icon:l,is_disabled_for_mobile:c=!1,message:d,text:u}=e;const{isDesktop:_}=(0,r.Y)();return(0,a.jsx)(n.Div100vhContainer,{className:(0,o.A)("account-management__message-wrapper",{"account-management__message-wrapper-full-width":s}),is_disabled:_||c,height_offset:"110px",children:(0,a.jsxs)("div",{className:(0,o.A)("account-management__message-content",{[`${i}__message-content`]:i}),children:[l&&(0,a.jsx)("div",{className:(0,o.A)("account-management__message-icon",{[`${i}__message-icon`]:i}),children:l}),(0,a.jsx)(n.Text,{as:"div",color:"general",weight:"bold",align:"center",className:(0,o.A)("account-management__message",{[`${i}__message`]:i}),children:d}),u&&(0,a.jsx)("div",{className:"account-management__text-container",children:(0,a.jsx)(n.Text,{className:(0,o.A)({[`${i}__text`]:i}),as:"p",size:"xs",align:"center",children:u})}),t]})})}},155142:(e,t,i)=>{i.d(t,{A:()=>o});const o=i(114321).A},835070:(e,t,i)=>{i.d(t,{A:()=>r});i(286326);var o=i(57886),n=i(836870);const r=e=>{let{icon:t,message:i,font_size:r="xxxs",title:a}=e;return(0,n.jsxs)("div",{className:"da-inline-note-with-icon",children:[t&&(0,n.jsx)("div",{children:(0,n.jsx)(o.Icon,{icon:t,size:16})}),(0,n.jsxs)(o.Text,{as:"p",size:r,line_height:"s",children:[a&&(0,n.jsxs)("strong",{children:[" ",a," "]}),i]})]})}},442438:(e,t,i)=>{i.d(t,{e:()=>n,u:()=>r});var o=i(33118);const n=()=>({country_select:{alert_dropdown:{country_not_found:(0,o.localize)("Country not found")},alert:{another_doc:(0,o.localize)("Documents from that country are not currently supported — <fallback>try another document type</fallback>")},button_primary:(0,o.localize)("Submit document"),search:{accessibility:(0,o.localize)("Select country"),input_placeholder:(0,o.localize)("e.g. United States"),label:(0,o.localize)("Search for country")},title:(0,o.localize)("Select issuing country")},cross_device_checklist:{button_primary:(0,o.localize)("Submit verification"),info:(0,o.localize)("Tips"),list_item_doc_multiple:(0,o.localize)("Documents uploaded"),list_item_doc_one:(0,o.localize)("Document uploaded"),list_item_selfie:(0,o.localize)("Selfie uploaded"),subtitle:(0,o.localize)("We're now ready to verify your identity"),title:(0,o.localize)("Great, that's everything we need")},cross_device_error_desktop:{subtitle:(0,o.localize)("The link only works on mobile devices"),title:(0,o.localize)("Something's gone wrong")},cross_device_error_restart:{subtitle:(0,o.localize)("You'll need to restart your verification on your computer"),title:(0,o.localize)("Something's gone wrong")},cross_device_intro:{button_primary:(0,o.localize)("Get secure link"),list_accessibility:(0,o.localize)("Steps required to continue verification on your mobile"),list_item_finish:(0,o.localize)("Check back here to finish the submission"),list_item_open_link:(0,o.localize)("Open the link and complete the tasks"),list_item_send_phone:(0,o.localize)("Send a secure link to your phone"),subtitle:(0,o.localize)("Here's how to do it:"),title:(0,o.localize)("Continue on your phone")},cross_device_return:{body:(0,o.localize)("Your computer may take a few seconds to update"),subtitle:(0,o.localize)("You can now return to your computer to continue"),title:(0,o.localize)("Uploads successful")},doc_confirmation:{alert:{blur_detail:(0,o.localize)("Make sure everything is clear"),blur_title:(0,o.localize)("Blurry photo detected"),crop_detail:(0,o.localize)("Make sure full document is visible"),crop_title:(0,o.localize)("Cut-off image detected"),glare_detail:(0,o.localize)("Move away from direct light"),glare_title:(0,o.localize)("Glare detected"),no_doc_detail:(0,o.localize)("Make sure all of the document is in the photo"),no_doc_title:(0,o.localize)("No document detected")},body_id:(0,o.localize)("Make sure your card details are clear to read, with no blur or glare"),body_image_medium:(0,o.localize)("It’ll take longer to verify you if we can’t read it"),body_image_poor:(0,o.localize)("To smoothly verify you, we need a better photo"),body_license:(0,o.localize)("Make sure your license details are clear to read, with no blur or glare"),body_passport:(0,o.localize)("Make sure your passport details are clear to read, with no blur or glare"),body_permit:(0,o.localize)("Make sure your permit details are clear to read, with no blur or glare"),body_tax_letter:(0,o.localize)("Make sure details are clear to read, with no blur or glare"),button_close:(0,o.localize)("Close"),button_primary_redo:(0,o.localize)("Redo"),button_primary_upload:(0,o.localize)("Confirm"),button_primary_upload_anyway:(0,o.localize)("Upload anyway"),button_secondary_redo:(0,o.localize)("Redo"),button_zoom:(0,o.localize)("Enlarge image"),image_accessibility:(0,o.localize)("Photo of your document"),title:(0,o.localize)("Check your image")},doc_select:{button_id:(0,o.localize)("Identity card"),button_id_detail:(0,o.localize)("Front and back"),button_license:(0,o.localize)("Driver's license"),button_license_detail:(0,o.localize)("Front and back"),button_passport:(0,o.localize)("Passport"),button_passport_detail:(0,o.localize)("Face photo page"),button_permit:(0,o.localize)("Residence permit"),button_permit_detail:(0,o.localize)("Front and back"),extra_no_mobile:(0,o.localize)("Sorry, no mobile phone bills"),list_accessibility:(0,o.localize)("Documents you can use to verify your identity"),subtitle:(0,o.localize)("It must be an official photo ID"),subtitle_poa:(0,o.localize)("These are the documents most likely to show your current home address"),title:(0,o.localize)("Choose document"),title_poa:(0,o.localize)("Select a %{country} document")},doc_submit:{button_link_upload:(0,o.localize)("or upload photo – no scans or photocopies"),button_primary:(0,o.localize)("Continue on phone"),subtitle:(0,o.localize)("Take a photo with your phone"),title_id_back:(0,o.localize)("Submit identity card (back)"),title_id_front:(0,o.localize)("Submit identity card (front)"),title_license_back:(0,o.localize)("Submit license (back)"),title_license_front:(0,o.localize)("Submit license (front)"),title_passport:(0,o.localize)("Submit passport photo pages"),title_permit_back:(0,o.localize)("Submit residence permit (back)"),title_permit_front:(0,o.localize)("Submit residence permit (front)")},error_unsupported_browser:{subtitle_android:(0,o.localize)("Restart the process on the latest version of Google Chrome"),subtitle_ios:(0,o.localize)("Restart the process on the latest version of Safari"),title_android:(0,o.localize)("Unsupported browser"),title_ios:(0,o.localize)("Unsupported browser")},generic:{accessibility:{close_sdk_screen:(0,o.localize)("Close identity verification screen"),dismiss_alert:(0,o.localize)("Dismiss alert")},back:(0,o.localize)("back"),close:(0,o.localize)("close"),errors:{interrupted_flow_error:{instruction:(0,o.localize)("Restart process on a different device"),message:(0,o.localize)("Camera not detected")},invalid_size:{instruction:(0,o.localize)("Must be under 10MB."),message:(0,o.localize)("File size exceeded.")},invalid_type:{instruction:(0,o.localize)("Try using another file type."),message:(0,o.localize)("File not uploaded.")},lazy_loading:{message:(0,o.localize)("An error occurred while loading the component")},multiple_faces:{instruction:(0,o.localize)("Only your face can be in the selfie"),message:(0,o.localize)("Multiple faces found")},no_face:{instruction:(0,o.localize)("Your face is needed in the selfie"),message:(0,o.localize)("No face found")},request_error:{instruction:(0,o.localize)("Please try again"),message:(0,o.localize)("Connection lost")},sms_failed:{instruction:(0,o.localize)("Copy the link to your phone"),message:(0,o.localize)("Something's gone wrong")},sms_overuse:{instruction:(0,o.localize)("Copy the link to your phone"),message:(0,o.localize)("Too many failed attempts")},unsupported_file:{instruction:(0,o.localize)("Try using a JPG or PNG file"),message:(0,o.localize)("File type not supported")}},lazy_load_placeholder:(0,o.localize)("Loading..."),loading:(0,o.localize)("Loading")},get_link:{alert_wrong_number:(0,o.localize)("Check that your number is correct"),button_copied:(0,o.localize)("Copied"),button_copy:(0,o.localize)("Copy"),button_submit:(0,o.localize)("Send link"),info_qr_how:(0,o.localize)("How to scan a QR code"),info_qr_how_list_item_camera:(0,o.localize)("Point your phone’s camera at the QR code"),info_qr_how_list_item_download:(0,o.localize)("If it doesn’t work, download a QR code scanner from Google Play or the App Store"),link_divider:(0,o.localize)("or"),link_qr:(0,o.localize)("Scan QR code"),link_sms:(0,o.localize)("Get link via SMS"),link_url:(0,o.localize)("Copy link"),loader_sending:(0,o.localize)("Sending"),number_field_input_placeholder:(0,o.localize)("Enter mobile number"),number_field_label:(0,o.localize)("Enter your mobile number:"),subtitle_qr:(0,o.localize)("Scan the QR code with your phone"),subtitle_sms:(0,o.localize)("Send this one-time link to your phone"),subtitle_url:(0,o.localize)("Open the link on your mobile"),title:(0,o.localize)("Get your secure link"),url_field_label:(0,o.localize)("Copy the link to your mobile browser")},linked_computer:{button_primary:(0,o.localize)("Continue"),info:(0,o.localize)("Make sure"),list_item_desktop_open:(0,o.localize)("2. Your desktop window stays open"),list_item_sent_by_you:(0,o.localize)("1. This link was sent by you"),subtitle:(0,o.localize)("Continue with the verification"),title:(0,o.localize)("Linked to your computer")},mobilePhrases:{photo_upload:{body_id_back:(0,o.localize)("Take a photo of the back of your card"),body_id_front:(0,o.localize)("Take a photo of the front of your card"),body_license_back:(0,o.localize)("Take a photo of the back of your license"),body_license_front:(0,o.localize)("Take a photo of the front of your license"),body_passport:(0,o.localize)("Take a photo of your passport photo page"),body_selfie:(0,o.localize)("Take a selfie showing your face")},selfie_capture:{alert:{camera_inactive:{detail:(0,o.localize)("Take a photo using the <fallback>basic camera mode</fallback> instead")},camera_not_working:{detail:(0,o.localize)("Take a photo using the <fallback>basic camera mode</fallback> instead")}}},upload_guide:{button_primary:(0,o.localize)("Take a photo"),title:(0,o.localize)("Passport photo page")}},outro:{body:(0,o.localize)("Thank you"),title:(0,o.localize)("Verification complete")},permission_recovery:{button_primary:(0,o.localize)("Refresh"),info:(0,o.localize)("Recovery"),list_header_cam:(0,o.localize)("Follow these steps to recover camera access:"),list_item_action_cam:(0,o.localize)("Refresh this page to restart the identity verification process"),list_item_how_to_cam:(0,o.localize)("Grant access to your camera from your browser settings"),subtitle_cam:(0,o.localize)("Recover camera access to continue face verification"),title_cam:(0,o.localize)("Camera access is denied")},permission:{body_cam:(0,o.localize)("We cannot verify you without using your camera"),button_primary_cam:(0,o.localize)("Enable camera"),subtitle_cam:(0,o.localize)("When prompted, you must enable camera access to continue"),title_cam:(0,o.localize)("Allow camera access")},photo_upload:{body_bank_statement:(0,o.localize)("Provide the whole document page for best results"),body_benefits_letter:(0,o.localize)("Provide the whole document page for best results"),body_bill:(0,o.localize)("Provide the whole document page for best results"),body_government_letter:(0,o.localize)("Provide the whole document page for best results"),body_id_back:(0,o.localize)("Upload back of card from your computer"),body_id_front:(0,o.localize)("Upload front of card from your computer"),body_license_back:(0,o.localize)("Upload back of license from your computer"),body_license_front:(0,o.localize)("Upload front of license from your computer"),body_passport:(0,o.localize)("Upload passport photo page from your computer"),body_selfie:(0,o.localize)("Upload a selfie from your computer"),body_tax_letter:(0,o.localize)("Provide the whole document page for best results"),button_take_photo:(0,o.localize)("Take photo"),button_upload:(0,o.localize)("Upload"),title_selfie:(0,o.localize)("Selfie")},selfie_capture:{alert:{camera_inactive:{detail:(0,o.localize)("Check that it is connected and functional. You can also <fallback>continue verification on your phone</fallback>"),detail_no_fallback:(0,o.localize)("Make sure your device has a working camera"),title:(0,o.localize)("Camera not working?")},camera_not_working:{detail:(0,o.localize)("It may be disconnected. <fallback>Try using your phone instead</fallback>."),detail_no_fallback:(0,o.localize)("Make sure your device's camera works"),title:(0,o.localize)("Camera not working")},timeout:{detail:(0,o.localize)("Remember to press stop when you're done. <fallback>Redo video actions</fallback>"),title:(0,o.localize)("Looks like you took too long")}},button_accessibility:(0,o.localize)("Take a photo"),frame_accessibility:(0,o.localize)("View from camera"),title:(0,o.localize)("Take a selfie")},selfie_confirmation:{image_accessibility:(0,o.localize)("Photo of your face"),subtitle:(0,o.localize)("Make sure your selfie clearly shows your face"),title:(0,o.localize)("Check selfie")},selfie_intro:{button_primary:(0,o.localize)("Continue"),list_accessibility:(0,o.localize)("Tips to take a good selfie"),list_item_face_forward:(0,o.localize)("Face forward and make sure your eyes are clearly visible"),list_item_no_glasses:(0,o.localize)("Remove your glasses, if necessary"),subtitle:(0,o.localize)("We'll compare it with your document"),title:(0,o.localize)("Take a selfie")},sms_sent:{info:(0,o.localize)("Tips"),info_link_expire:(0,o.localize)("Your link will expire in one hour"),info_link_window:(0,o.localize)("Keep this window open while using your mobile"),link:(0,o.localize)("Resend link"),subtitle:(0,o.localize)("We've sent a secure link to %{number}"),subtitle_minutes:(0,o.localize)("It may take a few minutes to arrive"),title:(0,o.localize)("Check your mobile")},switch_phone:{info:(0,o.localize)("Tips"),info_link_expire:(0,o.localize)("Your mobile link will expire in one hour"),info_link_refresh:(0,o.localize)("Don't refresh this page"),info_link_window:(0,o.localize)("Keep this window open while using your mobile"),link:(0,o.localize)("Cancel"),subtitle:(0,o.localize)("Once you've finished we'll take you to the next step"),title:(0,o.localize)("Connected to your mobile")},upload_guide:{button_primary:(0,o.localize)("Upload photo"),image_detail_blur_alt:(0,o.localize)("Example of a blurry document"),image_detail_blur_label:(0,o.localize)("All details must be clear — nothing blurry"),image_detail_cutoff_alt:(0,o.localize)("Example of a cut-off document"),image_detail_cutoff_label:(0,o.localize)("Show all details — including the bottom 2 lines"),image_detail_glare_alt:(0,o.localize)("Example of a document with glare"),image_detail_glare_label:(0,o.localize)("Move away from direct light — no glare"),image_detail_good_alt:(0,o.localize)("Document example"),image_detail_good_label:(0,o.localize)("The photo should clearly show your document"),subtitle:(0,o.localize)("Scans and photocopies are not accepted"),title:(0,o.localize)("Upload passport photo page")}}),r={ID:"id_ID",EN:"en_US"}},837062:(e,t,i)=>{i.d(t,{aZ:()=>w,IW:()=>P,_c:()=>p,UC:()=>_,mQ:()=>x,xy:()=>k,hf:()=>S,dC:()=>g,Zy:()=>j,k4:()=>v,dS:()=>b,GQ:()=>O,Di:()=>h,bu:()=>m,DY:()=>z,Lf:()=>u,tf:()=>N,yS:()=>y,RC:()=>D});var o=i(660984),n=i(189137),r=i(596176),a=i(33118);const s=e=>({ke:{alien_card:{new_display_name:"",example_format:"123456"},national_id:{new_display_name:"",example_format:"12345678"},passport:{new_display_name:"",example_format:"A12345678"}},za:{national_id:{new_display_name:(0,a.localize)("National ID"),example_format:"1234567890123"},national_id_no_photo:{new_display_name:(0,a.localize)("National ID (No Photo)"),example_format:"1234567890123"}},ng:{bvn:{new_display_name:(0,a.localize)("Bank Verification Number"),example_format:"12345678901"},cac:{new_display_name:(0,a.localize)("Corporate Affairs Commission"),example_format:"12345678"},drivers_license:{new_display_name:"",example_format:"ABC123456789"},nin:{new_display_name:(0,a.localize)("National Identity Number"),example_format:"12345678901"},nin_slip:{new_display_name:(0,a.localize)("National Identity Number Slip"),example_format:"12345678901"},tin:{new_display_name:(0,a.localize)("Taxpayer identification number"),example_format:"12345678-1234"},voter_id:{new_display_name:(0,a.localize)("Voter ID"),example_format:"1234567890123456789"}},gh:{drivers_license:{new_display_name:"",example_format:"B1234567"},national_id:{new_display_name:(0,a.localize)("National ID"),example_format:"GHA-123456789-1"},passport:{new_display_name:(0,a.localize)("Passport"),example_format:"G1234567"},ssnit:{new_display_name:(0,a.localize)("Social Security and National Insurance Trust"),example_format:"C123456789012"},voter_id:{new_display_name:(0,a.localize)("Voter ID"),example_format:"01234567890"}},br:{cpf:{new_display_name:(0,a.localize)("CPF"),example_format:"123.456.789-12"}},ug:{national_id:{new_display_name:(0,a.localize)("National ID"),example_format:"CM12345678PE1D"},national_id_no_photo:{new_display_name:(0,a.localize)("National ID (No Photo)"),example_format:"CM12345678PE1D",additional_document_example_format:"0123456789"}},zw:{national_id:{new_display_name:(0,a.localize)("National ID"),example_format:"081234567F53"}},cl:{national_id:{example_format:"123456789"}},ar:{dni:{example_format:"12345678"}},mx:{curp:{example_format:"ABCD123456HEFGIJ00"}},id:{nik:{example_format:"1234567890123456"}},in:{aadhaar:{example_format:"123456789012",additional_document_example_format:"ABCDE1234F"},drivers_license:{example_format:"AB1234567890123"},epic:{example_format:"ABC1234567"},pan:{example_format:"ABCDE1234F"},passport:{example_format:"A1234567",additional_document_example_format:"AB1234567890123"}},pe:{national_id:{example_format:"12345678"}},vn:{national_id:{example_format:"12345678901"}}}[e]);var l=i(442438);const c=[{regex_string:"^(?i)G[a-zA-Z0-9]{7,9}$",value:"^G[a-zA-Z0-9]{7,9}$",flags:"i"}],d=(0,n.getIDVNotApplicableOption)(),u=e=>{var t,i,o;let{account_status:r,citizen:a,residence_list:s,real_account_signup_target:l}=e;const c=s.find((e=>e.value===a)),d="maltainvest"===l,u=null==r||null===(t=r.authentication)||void 0===t?void 0:t.identity,_=(null==u?void 0:u.status)===n.AUTH_STATUS_CODES.VERIFIED||(null==r||null===(i=r.status)||void 0===i?void 0:i.some((e=>"skip_idv"===e)));return Boolean(!d&&a&&(null==c||null===(o=c.identity)||void 0===o||null===(o=o.services)||void 0===o||null===(o=o.idv)||void 0===o?void 0:o.is_country_supported)&&!_)},_=(e,t)=>{const i={new_display_name:"",example_format:""},o=s(e);var n;return o&&null!==(n=o[t])&&void 0!==n?n:i},m=e=>{var t;0===(null!==(t=e.clipboardData)&&void 0!==t?t:window.clipboardData).getData("text").length&&e.preventDefault()},f=e=>{const t=c.find((t=>t.regex_string===e));return t?new RegExp(t.value,t.flags):new RegExp(e)},p=e=>{switch(e){case"drivers_license":return(0,r.localize)("Enter Driver License Reference number");case"ssnit":return(0,r.localize)("Enter your SSNIT number");case"national_id_no_photo":return(0,r.localize)("Enter your National Identification Number (NIN)");default:return(0,r.localize)("Enter your document number")}},b=function(e){return!(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).includes(e)},h=(e,t)=>{const i=(0,n.filterObjProperties)(e,t);return i.first_name&&(i.first_name=i.first_name.trim()),i.last_name&&(i.last_name=i.last_name.trim()),i.date_of_birth&&(i.date_of_birth=(0,n.toMoment)(i.date_of_birth).format("YYYY-MM-DD")),i},y=e=>{if(e){if(!(0,n.validLength)(e.trim(),{min:1,max:50}))return(0,r.localize)("Enter no more than 50 characters.");if(!(0,n.validName)(e))return(0,r.localize)("Letters, spaces, periods, hyphens, apostrophes only.")}return""},x=e=>e?(0,r.localize)("Example: ")+e:"",v=e=>{if(null==e||!e.text)return(0,r.localize)("Please select a document type.")},g=(e,t)=>{const i=((e,t)=>{let i=null;var o,n;e?f(null==t?void 0:t.format).test(e)||(i=(0,r.localize)("Please enter the correct format. ")):i=(0,r.localize)("Please enter your {{document_name}}. ",{document_name:null!==(o=null==t||null===(n=t.display_name)||void 0===n?void 0:n.toLowerCase())&&void 0!==o?o:(0,r.localize)("document number")});return i})(t,null==e?void 0:e.additional);var o;if(i)return i+x(null==e||null===(o=e.additional)||void 0===o?void 0:o.example_format)},j=(e,t)=>{const i=e===(null==t?void 0:t.example_format);if(!e&&null!=t&&t.text){let e="";const i=x(t.example_format);switch(t.id){case"drivers_license":e=(0,r.localize)("Driver License Reference number");break;case"ssnit":e=(0,r.localize)("SSNIT number");break;case"national_id_no_photo":e=(0,r.localize)("NIN");break;default:e=(0,r.localize)("document number")}return(0,r.localize)("Please enter your {{document_name}}. {{example_format}}",{document_name:e,example_format:i})}if(i)return(0,r.localize)("Please enter a valid ID number.");const o=f(null==t?void 0:t.value);return e&&!o.test(e)?(0,r.localize)("Please enter the correct format. ")+x(null==t?void 0:t.example_format):void 0},z=e=>e===d.id,O=e=>"object"==typeof e&&null!==e&&"code"in e,w=e=>3!==e.length?o.alpha2ToAlpha3(e.toUpperCase()):e,P=e=>2!==e.length?o.alpha3ToAlpha2(e.toUpperCase()):e,S=e=>{try{const t=e.toLowerCase().split("_");return"id"===t[0]?l.u.ID:t.length>1?`${t[0]}_${t[1].toUpperCase()}`:t[0]}catch(e){return l.u.EN}},k=(e,t)=>{var i;if(!e||!Object.keys(t).length)return(0,r.localize)("identity document");const{document_type:o}=e;if(!o)return(0,r.localize)("identity document");if(null!=t&&null!==(i=t.identity)&&void 0!==i&&null!==(i=i.services)&&void 0!==i&&null!==(i=i.idv)&&void 0!==i&&i.documents_supported){const{identity:{services:{idv:{documents_supported:e}}}}=t;return e[o].display_name}return null},N=(e,t)=>(i,o,n)=>{o.forEach((o=>{const r=t[o];i(r)||e[o]||(e[o]=n)}))},D=e=>{switch(e){case n.IDV_ERROR_STATUS.DobMismatch.code:return["date_of_birth"];case n.IDV_ERROR_STATUS.NameMismatch.code:return["first_name","last_name"];default:return["first_name","last_name","date_of_birth"]}}},780146:(e,t,i)=>{i.d(t,{A:()=>c});var o=i(286326),n=i(773835);const r=["data"];function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){l(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function l(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const c=()=>{const e=(0,n.A)("residence_list"),{data:t}=e,i=function(e,t){if(null==e)return{};var i,o,n=function(e,t){if(null==e)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.includes(o))continue;i[o]=e[o]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)i=r[o],t.includes(i)||{}.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}(e,r),a=(0,o.useMemo)((()=>t&&t.residence_list?t.residence_list.map((e=>s({},e))):[]),[t]);return s({data:a},i)}},95627:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Xi});var o=i(286326),n=i(57886),r=i(679955),a=i(414646),s=i(189137),l=i(33118),c=i(155142),d=i(836870);const u=e=>{let{onClick:t}=e;return(0,d.jsx)("div",{className:"account-management__container",children:(0,d.jsx)(c.A,{message:(0,d.jsx)(l.Localize,{i18n_default_text:"New proof of address is needed"}),text:(0,d.jsx)(l.Localize,{i18n_default_text:"Your document for proof of address is expired. <0/>Please submit again.",components:[(0,d.jsx)("br",{},0)]}),icon:(0,d.jsx)(n.Icon,{icon:"IcPoaUpload",size:128}),children:(0,d.jsx)(n.Button,{onClick:t,has_effect:!0,primary:!0,children:(0,d.jsx)(n.Text,{className:"dc-btn__text",size:"xs",weight:"bold",as:"p",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Resubmit"})})})})})},_=()=>(0,d.jsx)(c.A,{message:(0,l.localize)("Proof of address verification not required"),text:(0,l.localize)("Your account does not need address verification at this time. We will inform you if address verification is required in the future."),icon:(0,d.jsx)(n.Icon,{icon:"IcPoaVerified",size:128})});var m=i(824223),f=i(919796),p=i(205007);const b=e=>{let{error_message:t}=e;return(0,d.jsx)(c.A,{message:t,icon:(0,d.jsx)(n.Icon,{icon:"IcPoaLock",size:128})})};var h=i(291218);const y=e=>{let{back:t,leave:i}=e;const{isMobile:o}=(0,f.Y)();return(0,d.jsx)(c.A,{className:"leave-confirm",message:(0,l.localize)("Unsaved changes"),text:(0,l.localize)("You have unsaved changes. Are you sure you want to discard changes and leave this page?"),icon:(0,d.jsx)(n.Icon,{icon:"IcUnsavedChanges",size:o?93:128,data_testid:"dt_unsaved_changes_icon"}),is_disabled_for_mobile:!0,children:(0,d.jsxs)("div",{className:"account-management-flex-wrapper account-management-leave-confirm",children:[(0,d.jsx)(n.Button,{type:"button",has_effect:!0,onClick:t,text:(0,l.localize)("Cancel"),secondary:!0,large:o}),(0,d.jsx)(n.Button,{type:"button",has_effect:!0,onClick:i,text:(0,l.localize)("Leave Settings"),primary:!0,large:o})]})})},x=(0,h.withRouter)((e=>{let{dirty:t,onDirty:i}=e;const r=(0,h.useHistory)(),a=(0,h.useLocation)(),{isMobile:s}=(0,f.Y)(),[l,c]=o.useState(!1),[u,_]=o.useState(a.pathname);o.useEffect((()=>{const e=r.block((e=>!(t&&!l)||(i&&i(!1),_(e.pathname),c(!0),!1)));return()=>e()}),[t,l,r,i]);const m=o.useCallback((()=>{u&&(c(!1),r.push(u),i&&i(!1))}),[u,r,i]),p=()=>{c(!1),_(a.pathname),i&&i(!0)};return(0,d.jsx)(d.Fragment,{children:l&&s?(0,d.jsx)(y,{back:p,leave:m}):(0,d.jsx)(n.Modal,{is_open:l,small:!0,toggleModal:p,children:(0,d.jsx)(n.Modal.Body,{children:(0,d.jsx)(y,{back:p,leave:m})})})})})),v=e=>{let{onDirty:t}=e;return(0,d.jsx)(m.FormikConsumer,{children:e=>(0,d.jsx)(x,{onDirty:t,dirty:e.dirty&&0===e.submitCount})})};var g=i(837062);const j=Object.freeze({DUPLICATE_ACCOUNT:"DuplicateAccount",CLAIMED_DOCUMENT:"ClaimedDocument",DUPLICATE_DOCUMENT:"DuplicateUpload"});var z=i(596176),O=i(237064);const w=()=>{const{isDesktop:e,isMobile:t}=(0,f.Y)();return(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)(n.Icon,{icon:"IcUpload",className:"dc-file-dropzone__message-icon",size:30}),(0,d.jsxs)("div",{className:"dc-file-dropzone__message-subtitle",children:[(0,d.jsx)(n.Text,{size:"xxs",align:"center",weight:"bold",color:"less-prominent",children:e?(0,d.jsx)(l.Localize,{i18n_default_text:"Drag and drop a file or click to browse your files."}):(0,d.jsx)(l.Localize,{i18n_default_text:"Click here to browse your files."})}),(0,d.jsx)(n.Text,{size:t?"xxxxs":"xxxs",align:"center",color:"less-prominent",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Remember, selfies, pictures of houses, or non-related images will be rejected."})})]})]})},P=e=>{let{onFileDrop:t,onError:i}=e;const[r,a]=o.useState([]),[c,u]=o.useState(null);o.useEffect((()=>{r&&(t(r),null==i||i(""))}),[r,t,i]);return(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)(n.FileDropzone,{accept:s.supported_filetypes,error_message:(0,l.localize)("Please upload supported file type."),filename_limit:26,hover_message:(0,l.localize)("Drop files here.."),max_size:s.max_document_size,message:(0,d.jsx)(w,{}),multiple:!1,onDropAccepted:e=>{e.length>0&&(a(e),u(null),null==i||i(""))},onDropRejected:e=>{const t=e.length>0&&e[0].file.size>s.max_document_size,o=e.filter((e=>(0,s.getSupportedFiles)(e.file.name))),n=t&&o.length>0?(0,l.localize)("File size should be 8MB or less"):(0,l.localize)("File uploaded is not supported");a([]),null==i||i(n),u(n)},validation_error_message:c,value:r}),(r&&(null==r?void 0:r.length)>0||c)&&(0,d.jsx)("div",{className:"file-uploader__remove-btn-container",children:(0,d.jsx)(n.Icon,{icon:"IcCloseCircle",className:(0,O.A)("file-uploader__remove-btn",{"file-uploader__remove-btn--error":c}),onClick:()=>{a([]),u(null),null==i||i("")},color:"secondary",data_testid:"dt_remove_file_icon"})})]})};var S=i(773835);const k=["data"];function N(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function D(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const C=e=>{const{client:t}=(0,a.A)(),{is_authorize:i}=t,o=(0,S.A)("kyc_auth_status",{payload:e,options:{enabled:i}}),{data:n}=o,r=function(e,t){if(null==e)return{};var i,o,n=function(e,t){if(null==e)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.includes(o))continue;i[o]=e[o]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)i=r[o],t.includes(i)||{}.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}(o,k);return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?N(Object(i),!0).forEach((function(t){D(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):N(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({kyc_auth_status:null==n?void 0:n.kyc_auth_status},r)},T=(e,t)=>{const i={title:(0,d.jsx)(z.Localize,{i18n_default_text:"The document must be recent and include your name and address:"}),descriptions:[{id:"signed_document",value:(0,d.jsx)(z.Localize,{i18n_default_text:"The document must be up-to-date and signed by the issuance authority."})},{id:"contains_letterhead",value:(0,d.jsx)(z.Localize,{i18n_default_text:"The document must contain a letterhead."})},{id:"invalid_rejected",value:(0,d.jsx)(z.Localize,{i18n_default_text:"Invalid or incomplete documents shall be rejected."})}]},o={title:(0,d.jsx)(z.Localize,{i18n_default_text:"Upload an original (unaltered) document that clearly shows your name and address, issued within the past {{expiry_in_months}} months. We accept:",values:{expiry_in_months:t?6:12}}),descriptions:[{id:"utility_bill",value:(0,d.jsx)(z.Localize,{i18n_default_text:"<0>Utility bill:</0> Electricity, water, gas, or landline phone bill.",components:[(0,d.jsx)("strong",{},0)]})},{id:"financial_legal_government_document",value:(0,d.jsx)(z.Localize,{i18n_default_text:"<0>Financial, legal, or government document:</0> Recent bank statement, affidavit, or government-issued letter.",components:[(0,d.jsx)("strong",{},0)]})},{id:"tenancy_agreement",value:(0,d.jsx)(z.Localize,{i18n_default_text:"<0>Tenancy agreement:</0> Valid and current agreement.",components:[(0,d.jsx)("strong",{},0)]})}]};return"poinc"===e?i:"poa"===e?o:{title:"",descriptions:[]}},A=()=>[{value:"utility_bill",text:(0,z.localize)("Utility bill (electricity, water, gas)")},{value:"phone_bill",text:(0,z.localize)("Landline phone bill")},{value:"bank_statement",text:(0,z.localize)("Bank statement")},{value:"affidavit",text:(0,z.localize)("Official residence declaration or affidavit")},{value:"official_letter",text:(0,z.localize)("Official letter issued by the government or solicitor")},{value:"rental_agreement",text:(0,z.localize)("Rental/tenancy agreement")},{text:(0,z.localize)("Others"),value:"poa_others"}];function I(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function E(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?I(Object(i),!0).forEach((function(t){F(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):I(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function F(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const L=e=>{let{examples:t,files_description:i,country_of_residence:r,onFileDrop:a,onError:s,placeholder:l}=e;const{isMobile:c}=(0,f.Y)(),{localize:u}=(0,z.useTranslations)(),{kyc_auth_status:_,isLoading:p}=C({country:r}),[b,h]=o.useState([]);return o.useEffect((()=>{if(_){const{address:e}=_,{supported_documents:t}=e,i=A().filter((e=>null==t?void 0:t.includes(e.value)));h(i)}}),[_]),p?(0,d.jsx)(n.Loading,{is_fullscreen:!1}):(0,d.jsxs)("div",{className:"file-uploader__container","data-testid":"dt_file_uploader_container",children:[i,t,r&&(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)(n.Text,{size:c?"xxs":"xs",as:"div",className:"file-uploader__file-title",weight:"bold",children:(0,d.jsx)(z.Localize,{i18n_default_text:"Select the type of document:"})}),(0,d.jsx)(m.Field,{name:"document_type",children:e=>{let{field:t,form:{setFieldValue:i}}=e;return(0,d.jsx)(n.Autocomplete,E(E({},t),{},{"data-lpignore":"true",autoComplete:"off",list_items:b,type:"text",value:t.value,label:l,placeholder:null!=l?l:u("Select a document"),onItemSelection:e=>{i("document_type",e.text,!0)},required:!0}))}})]}),(0,d.jsx)(n.Text,{size:c?"xxs":"xs",as:"div",className:"file-uploader__file-title",weight:"bold",children:(0,d.jsx)(z.Localize,{i18n_default_text:"Upload file"})}),(0,d.jsx)("div",{className:"file-uploader__file-dropzone-wrapper",children:(0,d.jsx)(P,{onError:s,onFileDrop:a})}),(0,d.jsxs)("div",{className:"file-uploader__file-supported-formats",children:[(0,d.jsx)(n.Text,{size:c?"xxxs":"xxs",children:(0,d.jsx)(z.Localize,{i18n_default_text:"Supported formats: JPEG, JPG, PNG, PDF, and GIF only"})}),(0,d.jsx)(n.Text,{size:c?"xxxs":"xxs",children:(0,d.jsx)(z.Localize,{i18n_default_text:"Maximum size: 8MB"})})]})]})},R=e=>{let{descriptions:t,title:i}=e;const{isMobile:o}=(0,f.Y)();return(0,d.jsxs)("div",{className:"files-description",children:[(0,d.jsx)(n.Text,{size:o?"xxs":"xs",as:"div",className:"files-description__title",weight:"bold",children:i}),(0,d.jsx)("ul",{children:t.map((e=>(0,d.jsx)("li",{children:(0,d.jsx)(n.Text,{size:o?"xxs":"xs",line_height:o?"l":"xl",children:e.value})},e.id)))})]})},M=e=>{let{children:t,className:i,scroll_offset:o,isFullHeight:r=!1}=e;const{isDesktop:a}=(0,f.Y)(),s=r?"100vh":"100%";return(0,d.jsx)(n.ThemedScrollbars,{is_bypassed:!a,height:o?`calc(${s} - ${o})`:"100%",children:(0,d.jsx)("div",{className:(0,O.A)("account__scrollbars_container",i),"data-testid":"dt_scrollbar_container_div",children:t})})},U=e=>{let{children:t,scroll_offset:i,className:r,isFullHeight:a}=e;const{isDesktop:s}=(0,f.Y)();return(0,d.jsx)(o.Fragment,{children:s?(0,d.jsx)(M,{className:(0,O.A)("account__scrollbars_container--grid-layout",r),scroll_offset:i,isFullHeight:a,children:t}):(0,d.jsx)(n.Div100vhContainer,{className:(0,O.A)("account__scrollbars_container--grid-layout",r),height_offset:i||"100%",children:t})})};var Y=i(37811);const B=e=>{let{children:t,className:i}=e;return(0,d.jsx)("div",{className:(0,O.A)("account-form__footer",i),"data-testid":"form-footer-container",children:t})};var V=i(138768),q=i(678891),$=i(602012),W=i(429106),G=i(338535),H=i(496148),Q=i(936017),Z=i(296049);function J(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function K(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?J(Object(i),!0).forEach((function(t){X(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):J(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function X(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var ee=i(345102);const te=e=>{let{description:t,image:i}=e;return(0,d.jsxs)("div",{className:"common-mistake-examples__content-layout",children:[i,(0,d.jsxs)("div",{className:"common-mistake-examples__content-description",children:[(0,d.jsx)(ee.A,{iconSize:"xs"}),(0,d.jsx)(n.Text,{size:"xxxs",line_height:"s",role:"document",children:t})]})]})},ie=()=>{const{isDesktop:e}=(0,f.Y)(),{client:t}=(0,a.A)(),{is_eu:i}=t,r=(e=>[{image:q.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"Name in document doesn’t match your Deriv profile."}),ref:"name_mismatch"},{image:$.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"Address in document doesn’t match address you entered above."}),ref:"address_mismatch"},K({},e?{image:W.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"Document issued more than 6-months ago."}),ref:"old_6_month_issued_document"}:{image:G.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"Document issued more than 12-months ago."}),ref:"old_12_month_issued_document"}),{image:H.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"Blurry document. All information must be clear and visible."}),ref:"blurry_document"},{image:Q.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"Cropped document. All information must be clear and visible."}),ref:"cropped_document"},{image:Z.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"An envelope with your name and address."}),ref:"envelope"}])(i);return(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)(n.Text,{as:"div",weight:"bold",size:e?"xs":"xxs",className:"common-mistake-examples__title",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Common mistakes"})}),(0,d.jsx)("div",{className:"common-mistake-examples__content",children:r.map((e=>(0,d.jsx)(te,{description:e.description,image:(0,d.jsx)(e.image,{})},e.ref)))})]})};var oe=i(791768);const ne=(0,r.observer)((e=>{let{className:t,setOffset:i,is_for_cfd_modal:r,is_resubmit:s,setDocumentFiles:l,document_files:c,form_state:u}=e;const{status:_,handleSubmit:p,isSubmitting:b,isValid:h}=(0,m.useFormikContext)(),{isDesktop:y}=(0,f.Y)(),{client:x}=(0,a.A)(),[v,g]=o.useState(null),{localize:j}=(0,z.useTranslations)(),{states_list:O,account_settings:w,is_eu:P,getChangeableFields:S}=x,k=S(),N=o.useMemo((()=>T("poa",P)),[]);return(0,d.jsxs)(m.Form,{noValidate:!0,className:"account-form account-form_poa",onSubmit:p,children:[(0,d.jsx)(n.ThemedScrollbars,{height:"572px",is_bypassed:!r||!y,className:t,children:(0,d.jsxs)(U,{scroll_offset:i(_),isFullHeight:!y,children:[((null==_?void 0:_.msg)||s)&&(0,d.jsx)(n.InlineMessage,{type:"error",message:(0,d.jsxs)(n.Text,{as:"p",size:"xs",children:[!(null!=_&&_.msg)&&s&&(0,d.jsx)(z.Localize,{i18n_default_text:"We were unable to verify your address with the details you provided. Please check and resubmit or choose a different document type."}),null==_?void 0:_.msg]}),id:"dt_poa_submit-error"}),(0,d.jsx)(V.A,{title:j("Enter your address"),title_text_size:"s"}),(0,d.jsx)(oe.A,{is_qualified_for_poa:!0,editable_fields:k,states_list:O}),(0,d.jsx)(V.A,{title:j("Submit your document"),title_text_size:"s"}),(0,d.jsx)(Y.A,{children:(0,d.jsx)(L,{onFileDrop:e=>{l(e)},onError:g,files_description:(0,d.jsx)(R,{title:N.title,descriptions:N.descriptions}),examples:(0,d.jsx)(ie,{}),country_of_residence:null==w?void 0:w.country_code,placeholder:j("Type of document")})})]})}),r?(0,d.jsx)(n.Modal.Footer,{has_separator:!0,children:(0,d.jsx)(n.FormSubmitButton,{is_disabled:b||!h||c&&c.length<1||!!v,label:j("Continue"),is_loading:b})}):(0,d.jsx)(B,{className:"account-form__footer-poa",children:(0,d.jsx)(n.Button,{className:"account-form__footer-btn",type:"submit",is_disabled:b||!h||c&&c.length<1||!!v,has_effect:!0,is_loading:u.is_btn_loading,is_submit_success:u.is_submit_success,text:j("Save and submit"),primary:!0})})]})}));var re=i(182997);function ae(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function se(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(i),!0).forEach((function(t){le(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ae(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function le(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const ce=e=>{let{is_active:t}=e;return(0,d.jsx)("div",{className:"progress-container",children:(0,d.jsx)("div",{className:(0,O.A)("progress-bar",{"progress-bar--animate":t})})})},de=(0,r.observer)((e=>{let{setOffset:t,is_resubmit:i,form_state:r,document_files:s,setDocumentFiles:l,is_for_cfd_modal:c}=e;const{localize:u}=(0,z.useTranslations)(),{status:_,handleSubmit:f,isSubmitting:p,isValid:b,values:h,errors:y}=(0,m.useFormikContext)(),{client:x}=(0,a.A)(),[v,g]=o.useState(null),[j,w]=o.useState({id:1,text:u("Enter your address")}),{states_list:P,account_settings:S,is_eu:k,getChangeableFields:N}=x,D=N(),C=o.useMemo((()=>T("poa",k)),[k]),A=o.useMemo((()=>2!==j.id&&!(h.address_line_1&&!y.address_line_1&&!y.address_line_2&&h.address_city&&!y.address_city&&!y.address_state&&!y.address_postcode)),[h,y,j.id]);return(0,d.jsxs)("div",{className:"poa-mobile-layout",children:[(0,d.jsxs)("div",{className:(0,O.A)("poa-header",{"poa-header--non-modal":!c}),children:[(0,d.jsxs)("div",{className:"timeline",children:[2===j.id&&(0,d.jsx)(re.A,{onClick:()=>w({id:1,text:u("Enter your address")})}),(0,d.jsx)(n.Text,{as:"p",size:"xxs",children:(0,d.jsx)(z.Localize,{i18n_default_text:"<0>Step {{step}}/2: </0> {{title}}",values:{step:j.id,title:j.text},components:[(0,d.jsx)("strong",{},0)]})})]}),(0,d.jsxs)("div",{className:"timeline-item",children:[(0,d.jsx)(ce,{is_active:j.id<=2}),(0,d.jsx)(ce,{is_active:2===j.id})]})]}),(0,d.jsx)(m.Form,{noValidate:!0,className:"account-form account-form_poa",onSubmit:f,children:(0,d.jsxs)(U,{scroll_offset:t(_),children:[((null==_?void 0:_.msg)||i)&&(0,d.jsx)(n.InlineMessage,{type:"error",message:(0,d.jsxs)(n.Text,{as:"p",size:"xxxs",children:[!(null!=_&&_.msg)&&i&&(0,d.jsx)(z.Localize,{i18n_default_text:"We were unable to verify your address with the details you provided. Please check and resubmit or choose a different document type."}),null==_?void 0:_.msg]}),className:"poa-error-banner",id:"dt_poa_submit-error"}),1===j.id&&(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)(oe.A,{is_qualified_for_poa:!0,editable_fields:D,states_list:P}),(0,d.jsx)(B,{className:"account-form__footer-poa",children:(0,d.jsx)(n.Button,{className:"account-form__footer-btn",type:"button",has_effect:!0,text:u("Next"),primary:!0,is_disabled:A,onClick:()=>w((e=>se(se({},e),{},{id:2,text:u(" Document submission")})))})})]}),2===j.id&&(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)(L,{onFileDrop:e=>{l(e)},onError:g,files_description:(0,d.jsx)(R,{title:C.title,descriptions:C.descriptions}),examples:(0,d.jsx)(ie,{}),country_of_residence:null==S?void 0:S.country_code,placeholder:u("Type of document")}),(0,d.jsx)(B,{className:"account-form__footer-poa",children:(0,d.jsx)(n.Button,{className:"account-form__footer-btn",type:"submit",has_effect:!0,text:u("Submit"),primary:!0,is_disabled:p||!b||s&&s.length<1||!!v,is_loading:r.is_btn_loading,is_submit_success:r.is_submit_success})})]})]})})]})}));function ue(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function _e(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(i),!0).forEach((function(t){me(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ue(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function me(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const fe=(0,r.observer)((e=>{let{is_resubmit:t,is_for_cfd_modal:i,onSubmit:r,onSubmitForCFDModal:l,className:c}=e;const{isMobile:u,isDesktop:_}=(0,f.Y)(),{client:h,notifications:y}=(0,a.A)(),{account_settings:x,fetchResidenceList:O,fetchStatesList:w,states_list:P}=h,{addNotificationMessageByKey:S,removeNotificationMessage:k,removeNotificationByKey:N}=y,[D,C]=o.useState([]),[T,I]=o.useState(!0),[E,F]=o.useState({address_line_1:"",address_line_2:"",address_city:"",address_state:"",address_postcode:""}),[L,R]=o.useState(null),[M,U]=o.useState({is_btn_loading:!1,is_submit_success:!1,should_allow_submit:!0,should_show_form:!0}),[Y,B]=o.useState(!1),{upload:V}=(0,p.A)(),{localize:q}=(0,z.useTranslations)();o.useEffect((()=>{null==O||O().then((async()=>{Promise.all([w(),s.WS.wait("get_settings")]).then((()=>{var e,t,i,o,n;F({address_line_1:null!==(e=x.address_line_1)&&void 0!==e?e:"",address_line_2:null!==(t=x.address_line_2)&&void 0!==t?t:"",address_city:null!==(i=x.address_city)&&void 0!==i?i:"",address_state:null!==(o=x.address_state)&&void 0!==o?o:"",address_postcode:null!==(n=x.address_postcode)&&void 0!==n?n:""}),I(!1)}))}))}),[x,O,w]),o.useEffect((()=>{if(Y){var e;const t=document.querySelector("#dt_poa_submit-error"),i=null!==(e=null==t?void 0:t.parentElement)&&void 0!==e?e:t;"function"==typeof(null==i?void 0:i.scrollIntoView)&&(null==i||i.scrollIntoView({behavior:"smooth",block:"start"})),B(!1)}}),[Y]);const $=e=>{U(_e(_e({},M),{should_show_form:e}))},{address_line_1:W,address_line_2:G,address_city:H,address_state:Q,address_postcode:Z}=E,J={address_line_1:W,address_line_2:G,address_city:H,address_state:Q,address_postcode:Z,document_type:""};if(L)return(0,d.jsx)(b,{error_message:L});if(T)return(0,d.jsx)(n.Loading,{is_fullscreen:!1,className:"account__initial-loader"});if(J.address_state){const e=(0,s.getLocation)(P,J.address_state,"text");J.address_state=P.length&&e?e:J.address_state}else J.address_state="";const K=e=>{const t=null!=e&&e.msg?"200px":"166px";return _||i?"94px":t};return(0,d.jsx)(m.Formik,{initialValues:J,onSubmit:async(e,t)=>{let{setStatus:o,setSubmitting:n}=t;o({msg:""}),U(_e(_e({},M),{is_btn_loading:!0}));const a=_e({},e);e.address_state&&P.length&&(a.address_state=(0,s.getLocation)(P,e.address_state,"value")||""),null==a||delete a.document_type;const c=await s.WS.setSettings(a);if(c.error)return o({msg:c.error.message}),U(_e(_e({},M),{is_btn_loading:!1})),n(!1),void B(!0);const d=await s.WS.authorized.storage.getSettings();if(d.error)return R(d.error.message),void n(!1);const u=d.get_settings,{address_line_1:_,address_line_2:m,address_city:f,address_state:p,address_postcode:b}=u;F({address_line_1:_,address_line_2:m,address_city:f,address_state:p,address_postcode:b});try{const t=A().find((t=>t.text===e.document_type)),a=await V(D,{document_type:null==t?void 0:t.value});if(null!=a&&a.warning)return U(_e(_e({},M),{is_btn_loading:!1})),void(a.warning===j.DUPLICATE_DOCUMENT?i?null==l||l(e,!0):null==r||r(!1,!0):(o({msg:null==a?void 0:a.message}),B(!0)));const c=await s.WS.authorized.getAccountStatus();if(!c||c.error)return R(c.error.message),void n(!1);const d=c.get_account_status;U(_e(_e({},M),{is_submit_success:!0,is_btn_loading:!1}));const{needs_verification:u}=d.authentication,_=Boolean(u.length)&&u.includes("identity");null==r||r(_),["authenticate","needs_poa","poa_expired"].forEach((e=>{k({key:e}),N({key:e})})),_&&S("needs_poi")}catch(e){(0,g.GQ)(e)&&(o({msg:e.message}),n(!1),U(_e(_e({},M),{is_btn_loading:!1})),B(!0))}i&&(null==l||l(e))},validate:e=>{U(_e(_e({},M),{should_allow_submit:!1}));const t={};(0,g.tf)(t,e)((e=>e),["address_line_1","address_city"],q("This field is required"));const i=(0,s.validAddress)(e.address_line_1,{is_required:!0});i.is_ok||(t.address_line_1=i.message);const o=(0,s.validAddress)(e.address_line_2);o.is_ok||(t.address_line_2=o.message);const n=q("Only letters, space, hyphen, period, and apostrophe are allowed.");return e.address_city&&!(0,s.validLetterSymbol)(e.address_city)&&(t.address_city=n),e.address_state&&!(0,s.validLetterSymbol)(e.address_state)&&(null==P?void 0:P.length)<1&&(t.address_state=n),e.address_postcode&&((0,s.validLength)(e.address_postcode,{min:0,max:20})?(0,s.validPostCode)(e.address_postcode)||(t.address_postcode=q("Only letters, numbers, space, and hyphen are allowed.")):t.address_postcode=q("Please enter a {{field_name}} under {{max_number}} characters.",{field_name:q("Postal/ZIP code"),max_number:20,interpolation:{escapeValue:!1}})),e.document_type||(t.document_type=q("Document type is required.")),t},enableReinitialize:!0,validateOnMount:!0,children:()=>(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)(v,{onDirty:_?void 0:$}),M.should_show_form&&(u?(0,d.jsx)(de,{setOffset:K,is_for_cfd_modal:i,is_resubmit:t,setDocumentFiles:C,document_files:D,form_state:M}):(0,d.jsx)(ne,{className:c,setOffset:K,is_for_cfd_modal:i,is_resubmit:t,setDocumentFiles:C,document_files:D,form_state:M}))]})})})),pe=e=>{let{button_label:t,className:i,route:o}=e;return(0,d.jsx)(n.ButtonLink,{className:(0,O.A)("account-management__button",i),to:o,children:(0,d.jsx)(n.Text,{className:"dc-btn__text",as:"p",weight:"bold","data-testid":"route_btn_text",children:t})})},be=e=>{let{needs_poi:t,redirect_button:i}=e;const o=(0,l.localize)("Review in progress"),r=(0,s.isNavigationFromP2P)()||(0,s.isNavigationFromDerivGO)();return t?(0,d.jsx)("div",{className:"account-management__container",children:(0,d.jsxs)(c.A,{message:o,icon:(0,d.jsx)(n.Icon,{icon:"IcPoaVerified",size:128}),children:[(0,d.jsxs)("div",{className:"account-management__text-container",children:[(0,d.jsx)(n.Text,{align:"center",size:"xs",as:"p",children:(0,l.localize)("Your proof of address is under review. We’ll get back to you in 1–3 working days.")}),(0,d.jsx)(n.Text,{align:"center",size:"xs",as:"p",children:(0,l.localize)("To start trading, you also need to verify your identity.")})]}),(0,d.jsx)(pe,{button_label:(0,l.localize)("Next"),route:s.routes.proof_of_identity})]})}):(0,d.jsx)("div",{className:"account-management__container",children:(0,d.jsx)(c.A,{message:o,text:(0,l.localize)("Your proof of address is under review. We’ll get back to you in 1–3 working days."),icon:(0,d.jsx)(n.Icon,{icon:"IcPoaVerified",size:128}),children:i||!r&&(0,d.jsx)(pe,{button_label:(0,l.localize)("Return to Trader's Hub"),route:s.routes.traders_hub})})})},he=e=>{let{title:t,description:i,button_text:o,onClick:r}=e;return(0,d.jsx)(c.A,{message:null!=t?t:(0,l.localize)("We could not verify your proof of address"),text:null!=i?i:(0,l.localize)("Please check your email for details."),icon:(0,d.jsx)(n.Icon,{icon:"IcPoaError",size:128}),children:(0,d.jsx)(n.Button,{onClick:r,has_effect:!0,primary:!0,children:(0,d.jsx)(n.Text,{className:"dc-btn__text",size:"xs",weight:"bold",as:"p",children:null!=o?o:(0,l.localize)("Resubmit")})})})};var ye=i(119180);const xe=e=>{let{className:t}=e;return(0,d.jsx)(n.ButtonLink,{className:(0,O.A)("account-management__button",t),to:ye.routes.trade,children:(0,d.jsx)(n.Text,{className:"dc-btn__text",as:"p",weight:"bold","data-testid":"continue_btn_text",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Continue trading"})})})},ve=()=>(0,d.jsx)(n.ButtonLink,{className:"account-management__button",to:"/account/proof-of-identity",children:(0,d.jsx)(n.Text,{className:"dc-btn__text",weight:"bold",as:"p",children:(0,l.localize)("Proof of identity")})}),ge=e=>{let{needs_poi:t,redirect_button:i}=e;const o=(0,l.localize)("Your proof of address is verified"),r=(0,s.isNavigationFromP2P)()||(0,s.isNavigationFromDerivGO)();return t?(0,d.jsx)("div",{className:"account-management__container",children:(0,d.jsx)(c.A,{message:o,text:(0,l.localize)("To continue trading, you must also submit a proof of identity."),icon:(0,d.jsx)(n.Icon,{icon:"IcPoaVerified",size:128}),children:(0,d.jsx)(ve,{})})}):(0,d.jsx)("div",{className:"account-management__container",children:(0,d.jsx)(c.A,{message:o,icon:(0,d.jsx)(n.Icon,{icon:"IcPoaVerified",size:128}),children:i||!r&&(0,d.jsx)(xe,{})})})},je=ge,ze=e=>{if(!e||!e.authentication)return{};const{attempts:t,document:i,identity:o,income:n,needs_verification:r}=e.authentication,a=o.status,s=i.status,l=n.status,c=e.status.some((e=>"allow_document_upload"===e)),d=e.status.some((e=>"allow_poi_resubmission"===e)),u=e.status.some((e=>"allow_poa_resubmission"===e)),_=e.status.some((e=>"allow_poinc_resubmission"===e)),m=e.status.some((e=>"age_verification"===e)),f=e.status.some((e=>"authenticated"===e)),p=e.status.some((e=>"idv_disallowed"===e)),b=e.status.some((e=>"poa_address_mismatch"===e)),h=e.status.some((e=>"poi_expiring_soon"===e)),y=e.status.some((e=>"poa_authenticated_with_idv"===e)),x=e.status.some((e=>"poa_authenticated_with_idv_photo"===e)),v=e.status.some((e=>"poa_expiring_soon"===e)),g=["pending","verified"].includes(a),j=!(i&&"none"===i.status),z=!(o&&"none"===o.status),O=!(n&&"none"===n.status),w="pending"===s&&!u,P=!(w||"verified"===s)||r.length&&r.includes("document"),S=!g||Boolean(r.length)&&r.includes("identity"),k=r.length&&r.includes("income"),{idv:N,onfido:D,manual:C}=o.services,T=t.latest;return{allow_document_upload:c,allow_poa_resubmission:u,allow_poi_resubmission:d,allow_poinc_resubmission:_,has_attempted_idv:Boolean(t.history.length&&t.history.find((e=>"idv"===e.service))),has_poa:j,has_poi:z,has_poinc:O,has_submitted_poa:w,identity_last_attempt:T,identity_status:a,document_status:s,income_status:l,idv:N,is_age_verified:m,is_fully_authenticated:f,is_idv_disallowed:p,manual:C,needs_poa:P,needs_poi:S,needs_poinc:k,needs_verification:r,onfido:D,poa_address_mismatch:b,poa_authenticated_with_idv:y,poa_authenticated_with_idv_photo:x,poi_expiring_soon:h,poa_expiring_soon:v}};function Oe(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function we(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(i),!0).forEach((function(t){Pe(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Oe(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Pe(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Se=(0,r.observer)((e=>{var t;let{onSubmit:i}=e;const[r,c]=o.useState(!0),[m,f]=o.useState({allow_document_upload:!1,allow_poi_resubmission:!1,allow_poa_resubmission:!1,needs_poi:!1,needs_poa:!1,has_poi:!1,resubmit_poa:!1,has_submitted_poa:!1,document_status:void 0,is_age_verified:!1,poa_address_mismatch:!1,poa_expiring_soon:!1,poa_authenticated_with_idv:!1,poa_authenticated_with_idv_photo:!1,has_submitted_duplicate_poa:!1}),{client:p,notifications:b,common:h,ui:y}=(0,a.A)(),{app_routing_history:x}=h,{has_restricted_mt5_account:v,is_switching:g}=p,{is_verification_modal_visible:j}=y,{refreshNotifications:z}=b,O=localStorage.getItem("mt5_poa_status");o.useEffect((()=>{g||s.WS.authorized.getAccountStatus().then((e=>{const{get_account_status:t}=e;if(t){const{allow_document_upload:e,allow_poa_resubmission:i,document_status:o,has_submitted_poa:n,is_age_verified:r,needs_poa:a,needs_poi:s,poa_address_mismatch:l,poa_authenticated_with_idv:d,poa_authenticated_with_idv_photo:u,poa_expiring_soon:_}=ze(t);f((t=>we(we({},t),{},{allow_document_upload:e,allow_poa_resubmission:i,document_status:o,has_submitted_poa:n,is_age_verified:r,needs_poa:a,needs_poi:s,poa_address_mismatch:l,poa_authenticated_with_idv:d,poa_authenticated_with_idv_photo:u,poa_expiring_soon:_}))),c(!1),z()}}))}),[g,z]),o.useEffect((()=>()=>{localStorage.removeItem("mt5_poa_status")}),[]);const w=()=>{f((e=>we(we({},e),{resubmit_poa:!0})))},P=(e,t)=>{f((i=>we(we({},i),{has_submitted_poa:!0,needs_poi:e,poa_expiring_soon:!1,has_submitted_duplicate_poa:null!=t&&t}))),j&&(null==i||i())},{allow_document_upload:S,allow_poa_resubmission:k,document_status:N,needs_poi:D,resubmit_poa:C,has_submitted_poa:T,poa_address_mismatch:A,poa_expiring_soon:I,poa_authenticated_with_idv:E,poa_authenticated_with_idv_photo:F,has_submitted_duplicate_poa:L}=m,R=(0,s.getPlatformRedirect)(x),M=Object.keys(s.platforms).includes(null!==(t=null==R?void 0:R.ref)&&void 0!==t?t:""),U=C||k||v&&N&&["expired","rejected","suspected"].includes(N)||A||I||(E||F)&&(null==R?void 0:R.route)===s.routes.cashier_p2p,Y=M&&(0,d.jsx)(n.Button,{primary:!0,className:"proof-of-identity__redirect",onClick:()=>{var e;const t=null===(e=s.platforms[R.ref])||void 0===e?void 0:e.url;t&&(window.location.href=t,window.sessionStorage.removeItem("config.platform"))},children:(0,d.jsx)(l.Localize,{i18n_default_text:"Back to {{platform_name}}",values:{platform_name:R.name}})});if(r)return(0,d.jsx)(n.Loading,{is_fullscreen:!1,className:"account__initial-loader"});if(!S)return(0,d.jsx)(_,{});if(L)return(0,d.jsx)(he,{title:(0,d.jsx)(l.Localize,{i18n_default_text:"Proof of address documents upload failed"}),description:(0,d.jsx)(l.Localize,{i18n_default_text:"It seems you’ve submitted this document before. Upload a new document."}),button_text:(0,d.jsx)(l.Localize,{i18n_default_text:"Try again"}),onClick:()=>{f((e=>we(we({},e),{resubmit_poa:!0,has_submitted_duplicate_poa:!1,has_submitted_poa:!1})))}});if(T&&!A)return(0,d.jsx)(be,{needs_poi:D,redirect_button:Y});if(U)return(0,d.jsx)(fe,{is_resubmit:!I,onSubmit:P});const B=e=>{switch(e){case s.AUTH_STATUS_CODES.NONE:return(0,d.jsx)(fe,{onSubmit:P});case s.AUTH_STATUS_CODES.PENDING:return(0,d.jsx)(be,{needs_poi:D,redirect_button:Y});case s.AUTH_STATUS_CODES.VERIFIED:return(0,d.jsx)(je,{needs_poi:D,redirect_button:Y});case s.AUTH_STATUS_CODES.EXPIRED:return(0,d.jsx)(u,{onClick:w});case s.AUTH_STATUS_CODES.REJECTED:case s.AUTH_STATUS_CODES.SUSPECTED:return(0,d.jsx)(he,{onClick:w});default:return null}};return O?B(O):N?B(N):null})),ke={none:"none",pending:"pending",rejected:"rejected",verified:"verified",expired:"expired",suspected:"suspected"},Ne="selecting",De="submitting",Ce="complete",Te="idv",Ae="onfido",Ie="manual",Ee=(0,r.observer)((e=>{let{has_button:t,icon:i,message:o}=e;const{client:r,ui:s}=(0,a.A)(),{isDesktop:c}=(0,f.Y)(),{has_any_real_account:u}=r,{toggleAccountsDialog:_,toggleShouldShowRealAccountsList:m}=s;return(0,d.jsxs)("div",{className:"da-icon-with-message",children:[(0,d.jsx)(n.Icon,{icon:i,size:128}),(0,d.jsx)(n.Text,{className:"da-icon-with-message__text",as:"p",color:"general",size:c?"s":"xs",line_height:"m",weight:"bold",children:o}),t&&(0,d.jsx)(n.Button,{primary:!0,onClick:()=>{m(!0),_()},className:"account__demo-message-button","data-testid":"icon-with-message-button",children:u?(0,l.localize)("Switch to real account"):(0,l.localize)("Add a real account")})]})})),Fe=e=>{let{has_button:t}=e;const{localize:i}=(0,z.useTranslations)();return(0,d.jsx)(Ee,{icon:"IcPoaLock",message:i("This feature is not available for demo accounts."),has_button:t})},Le=e=>{let{header:t,message:i,redirect_label:o,redirectOnClick:r,should_show_refresh:a=!0}=e;const l=a?(0,d.jsx)(z.Localize,{i18n_default_text:"Please refresh this page to continue."}):"";return(0,d.jsx)(n.PageError,{header:t||(0,d.jsx)(z.Localize,{i18n_default_text:"Oops, something went wrong."}),messages:i?[i,l]:[(0,d.jsx)(z.Localize,{i18n_default_text:"Sorry, an error occurred while processing your request."},0),l],redirect_urls:[s.routes.trade],redirect_labels:[null!=o?o:(0,d.jsx)(z.Localize,{i18n_default_text:"Refresh"})],buttonOnClick:null!=r?r:()=>location.reload()})},Re=e=>{let{handleRequireSubmission:t,is_from_external:i,redirect_button:o}=e;return(0,d.jsxs)(c.A,{message:(0,l.localize)("New proof of identity document needed"),icon:(0,d.jsx)(n.Icon,{icon:"IcPoiUpload",size:128}),children:[(0,d.jsx)(n.Button,{type:"button",className:"account-management__continue",onClick:t,large:!0,text:(0,l.localize)("Upload Document"),primary:!0}),!i&&o]})};var Me=i(138150);const Ue=e=>{let{handleRequireSubmission:t}=e;const{setSubmissionStatus:i}=o.useContext(s.POIContext);return(0,d.jsxs)("div",{className:"proof-of-identity__container",children:[(0,d.jsx)(Me.A,{className:"icon"}),(0,d.jsx)(n.Text,{className:"proof-of-identity__text btm-spacer",align:"center",weight:"bold",children:(0,l.localize)("ID verification failed")}),(0,d.jsxs)(n.Text,{className:"proof-of-identity__text btm-spacer",align:"center",size:"xs",children:[(0,l.localize)("We were unable to verify your ID with the details you provided. "),(0,l.localize)("Please upload your identity document.")]}),(0,d.jsx)(n.Button,{type:"button",className:"account-management__continue",onClick:()=>{t(),i(Ne)},large:!0,text:(0,l.localize)("Upload identity document"),primary:!0})]})};var Ye=i(794216);const Be=(0,d.jsx)(l.Localize,{i18n_default_text:"Submit proof of address"}),Ve=e=>{let{custom_text:t=Be,class_name:i}=e;return(0,d.jsx)(n.ButtonLink,{className:(0,O.A)("account-management__button",i),to:s.routes.proof_of_address,children:(0,d.jsx)(n.Text,{className:"dc-btn__text",as:"p",weight:"bold","data-testid":"poa_button_text",children:t})})},qe=Ve,$e=(0,r.observer)((e=>{let{is_from_external:t,mismatch_status:i,needs_poa:r,redirect_button:c}=e;const{client:u}=(0,a.A)(),{is_already_attempted:_}=u,m=i===s.IDV_ERROR_STATUS.NameDobMismatch.code||i===s.IDV_ERROR_STATUS.DobMismatch.code||i===s.IDV_ERROR_STATUS.NameMismatch.code,f=i===s.IDV_ERROR_STATUS.Expired.code||i===s.IDV_ERROR_STATUS.Failed.code,p=!t&&(0,d.jsx)(qe,{custom_text:(0,d.jsx)(l.Localize,{i18n_default_text:"Next"})});return(0,d.jsxs)("div",{className:(0,O.A)("proof-of-identity__container","proof-of-identity__container--status"),children:[(0,d.jsx)(Ye.A,{className:"icon"}),(0,d.jsx)(n.Text,{className:"proof-of-identity__text btm-spacer",align:"center",weight:"bold",children:(()=>{if(_){if(m)return(0,d.jsx)(l.Localize,{i18n_default_text:"Your profile is updated"});if(f)return(0,d.jsx)(l.Localize,{i18n_default_text:"Your document has been submitted"})}return(0,d.jsx)(l.Localize,{i18n_default_text:"Review in progress"})})()}),(0,d.jsx)(n.Text,{className:"proof-of-identity__text text",size:"xs",align:"center",children:_&&(m||f)?(0,d.jsx)(l.Localize,{i18n_default_text:"We'll review your proof of identity again and will give you an update as soon as possible."}):(0,d.jsx)(l.Localize,{i18n_default_text:"Your proof of identity is under review. We’ll get back to you within 5 minutes."})}),r?(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)(n.Text,{className:"text",size:"xs",align:"center",children:(0,d.jsx)(l.Localize,{i18n_default_text:"To start trading, you also need to verify your address."})}),p]}):(0,d.jsx)("div",{className:"proof-of-identity__redirection",children:c})]})})),We=o.memo($e);var Ge=i(84158);const He=e=>{let{needs_poa:t,is_from_external:i,redirect_button:r}=e;const a=t?(0,d.jsx)(l.Localize,{i18n_default_text:"Your ID is verified. You will also need to submit proof of your address."}):(0,d.jsx)(l.Localize,{i18n_default_text:"ID verification passed"}),{isDesktop:s}=(0,f.Y)();return(0,d.jsxs)("div",{className:(0,O.A)("proof-of-identity__container","proof-of-identity__container--status"),"data-testid":"poi_idv_verified_container",children:[(0,d.jsx)(Ge.A,{className:"icon"}),(0,d.jsx)(n.Text,{className:"proof-of-identity__text btm-spacer",align:"center",weight:"bold",children:a}),t?(0,d.jsxs)(o.Fragment,{children:[s&&(0,d.jsx)(n.Text,{className:"text",size:"xs",align:"center",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Next, we'll need your proof of address."})}),!i&&(0,d.jsx)(Ve,{custom_text:(0,d.jsx)(l.Localize,{i18n_default_text:"Submit proof of address"})})]}):r||(0,d.jsx)(xe,{className:"continue-trade"})]})},Qe=e=>{let{handleRequireSubmission:t,idv:i,is_from_external:o,needs_poa:n,redirect_button:r}=e;const{status:a,submissions_left:l,last_rejected:c}=i;switch(a){case ke.pending:return(0,d.jsx)(We,{is_from_external:o,mismatch_status:(0,s.formatIDVError)(c,a),needs_poa:n,redirect_button:r});case ke.rejected:case ke.suspected:case ke.expired:return Number(l)<1?(0,d.jsx)(Ue,{handleRequireSubmission:t}):null;case ke.verified:return(0,d.jsx)(He,{is_from_external:o,needs_poa:n,redirect_button:r});default:return null}};var Ze=i(712949);const Je=()=>(0,d.jsx)(c.A,{message:(0,l.localize)("You've reached the limit for uploading your documents."),text:(0,d.jsx)(l.Localize,{i18n_default_text:"Please contact us via <0>live chat</0>.",components:[(0,d.jsx)("span",{className:"link link--orange",onClick:Ze.Chat.open},0)]}),icon:(0,d.jsx)(n.Icon,{icon:"IcPoiFailed",size:128})}),Ke=()=>(0,d.jsx)(c.A,{message:(0,l.localize)("Proof of identity verification not required"),text:(0,l.localize)("Your account does not need identity verification at this time. We will inform you if identity verification is required in the future."),icon:(0,d.jsx)(n.Icon,{icon:"IcPoiVerified",size:128})});var Xe=i(114321);const et=e=>{let{needs_poa:t,redirect_button:i,is_from_external:r,is_manual_upload:a=!1}=e;const{localize:l}=(0,z.useTranslations)(),c=l("Review in progress"),u=l(a?"Your proof of identity is under review. We’ll get back to you within 1–3 working days.":"Your proof of identity is under review. We’ll get back to you within 5 minutes.");return t?(0,d.jsxs)(Xe.A,{message:c,icon:(0,d.jsx)(n.Icon,{icon:"IcPoiVerified",size:128}),children:[(0,d.jsxs)(o.Fragment,{children:[(0,d.jsxs)("div",{className:"account-management__text-container",children:[(0,d.jsx)(n.Text,{align:"center",size:"xs",as:"p",children:u}),(0,d.jsx)(n.Text,{align:"center",size:"xs",as:"p",children:l("To start trading, you also need to verify your address.")})]}),(0,d.jsx)(qe,{custom_text:l("Next")})]}),!r&&i]}):(0,d.jsx)(Xe.A,{message:c,text:u,icon:(0,d.jsx)(n.Icon,{icon:"IcPoiVerified",size:128}),children:!r&&(0,d.jsx)(pe,{button_label:l("Return to Trader's Hub"),route:s.routes.traders_hub})})},tt=et,it=xe,ot=e=>{let{needs_poa:t,redirect_button:i,is_from_external:r,service:a}=e;const s=a===Te?(0,l.localize)("ID verification passed"):(0,l.localize)("Your proof of identity is verified");return t?(0,d.jsx)(c.A,{message:s,icon:(0,d.jsx)(n.Icon,{icon:"IcPoaVerified",size:128}),className:"account-management-dashboard",text:(0,l.localize)("To continue trading, you must also submit a proof of address."),children:!r&&(0,d.jsx)(o.Fragment,{children:(0,d.jsx)(qe,{})})}):(0,d.jsx)(c.A,{message:s,icon:(0,d.jsx)(n.Icon,{icon:"IcPoaVerified",size:128,data_testid:"dt_IcPoaVerified"}),className:"account-management-dashboard",children:!r&&(i||(0,d.jsx)(it,{}))})},nt=ot,rt=e=>{let{text:t,index:i}=e;const{isDesktop:o}=(0,f.Y)(),r=o?"xs":"xxs";return(0,d.jsxs)("div",{className:"account-management__list-text-container",children:[i&&(0,d.jsxs)(n.Text,{size:r,className:"account-management__list-text",children:[(0,d.jsx)(l.Localize,{i18n_default_text:"{{index}}.",values:{index:i}})," "]}),(0,d.jsx)(n.Text,{size:r,className:"account-management__list-text",children:t})]})},at=e=>{let{className:t,icon:i,message:o,message_list:r=[],onContinue:a}=e;const{isDesktop:c,isMobile:u}=(0,f.Y)();return(0,d.jsx)(n.ThemedScrollbars,{is_bypassed:u,children:(0,d.jsx)(n.Div100vhContainer,{className:"account-management__message-wrapper",is_disabled:c,height_offset:"110px",children:(0,d.jsxs)("div",{className:(0,O.A)("account-management__message-content",{[`${t}__message-content`]:t}),"data-testid":"dt_icon_message_list",children:[i&&(0,d.jsx)("div",{className:(0,O.A)("account-management__message-icon",{[`${t}__message-icon`]:t}),children:i}),(0,d.jsx)(n.Text,{as:"div",weight:"bold",className:(0,O.A)("account-management__message",{[`${t}__message`]:t}),size:c?"s":"xs",children:o}),r&&(0,d.jsx)("div",{className:"account-management__list-container",children:(0,d.jsxs)("div",{className:"account-management__list-message",children:[(0,d.jsx)("div",{className:"account-management__list-icon",children:(0,d.jsx)(n.Icon,{icon:"IcAlertDanger",color:"red"})}),(0,d.jsx)("section",{children:r.length<2?(0,d.jsx)(rt,{text:(0,s.getOnfidoError)(r[0])}):r.map(((e,t)=>(0,d.jsx)(rt,{text:(0,s.getOnfidoError)(r[t]),index:t+1},e)))})]})}),a&&(0,d.jsx)(n.Button,{type:"button",className:"account-management__continue",onClick:a,large:!0,primary:!0,children:(0,d.jsx)(l.Localize,{i18n_default_text:"Verify again"})})]})})})},st=e=>{let{handleRequireSubmission:t,rejected_reasons:i}=e;return(0,d.jsx)(at,{message:(0,l.localize)("Your proof of identity submission failed because:"),icon:(0,d.jsx)(n.Icon,{icon:"IcPoiFailed",size:128}),message_list:i,onContinue:t})},lt=e=>{let{children:t,message:i,error:o}=e;return(0,d.jsx)(c.A,{message:null!=i?i:(0,d.jsx)(l.Localize,{i18n_default_text:"Proof of identity documents upload failed"}),text:o,icon:(0,d.jsx)(n.Icon,{icon:"IcPoiFailed",size:128}),className:"account-management-dashboard",children:t})};var ct=i(649524),dt=i.n(ct);const ut=e=>(0,l.localize)("Unable to read file {{name}}",{name:e}),_t=(e,t,i)=>new Promise(((o,n)=>{e||n();const r=new(dt())({connection:t()});let a=!1;(0,s.compressImageFiles)([e]).then((e=>{(0,s.readFiles)(e,ut,i).then((e=>{e.forEach((e=>{e.message&&(a=!0,n(e))}));const t=e.length;!a&&t&&r.upload(e[0]).then(o).catch(n)})).catch((e=>console.error("error: ",e)))})).catch((e=>console.error("error: ",e)))}));var mt=i(557344),ft=i(672313),pt=i(751506),bt=i(539943);const ht=e=>{let{anchor:t,from:i,text:o}=e;const r=i?`?from=${i}`:"",a=t?`#${t}`:"";return(0,d.jsx)(n.ButtonLink,{to:`/account/personal-details${r}${a}`,children:(0,d.jsx)(n.Text,{className:"dc-btn__text",weight:"bold",as:"p",children:null!=o?o:(0,l.localize)("Go to personal details")})})},yt=e=>{let{has_invalid_postal_code:t,from:i}=e;return t?(0,d.jsx)(c.A,{message:(0,l.localize)("Your postal code is invalid"),text:(0,l.localize)("Please check and update your postal code before submitting proof of identity."),icon:(0,d.jsx)(n.Icon,{icon:"IcAccountMissingDetails",size:128}),children:(0,d.jsx)(ht,{anchor:"address_postcode",from:i,text:(0,l.localize)("Update postal code")})}):(0,d.jsx)(c.A,{message:(0,l.localize)("Your personal details are missing"),text:(0,l.localize)("Please complete your personal details before you verify your identity."),icon:(0,d.jsx)(n.Icon,{icon:"IcAccountMissingDetails",size:128}),children:(0,d.jsx)(ht,{from:i})})};var xt=i(406941),vt=i(263610),gt=i(560798);const jt=()=>Ze.Chat.open(),zt=(0,d.jsx)(l.Localize,{i18n_default_text:"Sorry, an internal error occurred. Hit the above checkbox to try again."}),Ot=(0,d.jsx)(l.Localize,{i18n_default_text:"An account with these details already exists. Please make sure the details you entered are correct as only one real account is allowed per client. If this is a mistake, contact us via <0>live chat</0>.",components:[(0,d.jsx)("span",{className:"link link--orange",onClick:jt,onKeyDown:jt},0)]}),wt=(0,d.jsx)(l.Localize,{i18n_default_text:"This document number was already submitted for a different account. It seems you have an account with us that doesn't need further verification. Please contact us via <0>live chat</0> if you need help.",components:[(0,d.jsx)("span",{className:"link link--orange",onClick:jt,onKeyDown:jt},0)]}),Pt=(e,t,i,o)=>{const n=e?"identity document":(0,g.xy)(t,i);switch(o){case s.IDV_ERROR_STATUS.NameMismatch.code:return{required_fields:["first_name","last_name"],side_note_image:(0,d.jsx)(vt.A,{height:"195px",width:"285px"}),inline_note_text:(0,d.jsx)(l.Localize,{i18n_default_text:"To avoid delays, enter your <0>name</0> exactly as it appears on your {{document_name}}.",components:[(0,d.jsx)("strong",{},0)],values:{document_name:n}}),failure_message:s.IDV_ERROR_STATUS.NameMismatch.message};case s.IDV_ERROR_STATUS.DobMismatch.code:return{required_fields:["date_of_birth"],side_note_image:(0,d.jsx)(gt.A,{height:"195px",width:"285px"}),inline_note_text:(0,d.jsx)(l.Localize,{i18n_default_text:"To avoid delays, enter your <0>date of birth</0> exactly as it appears on your {{document_name}}.",components:[(0,d.jsx)("strong",{},0)],values:{document_name:n}}),failure_message:s.IDV_ERROR_STATUS.DobMismatch.message};default:return{required_fields:["first_name","last_name","date_of_birth"],side_note_image:(0,d.jsx)(xt.A,{height:"195px",width:"285px"}),inline_note_text:(0,d.jsx)(l.Localize,{i18n_default_text:"To avoid delays, enter your <0>name</0> and <0>date of birth</0> exactly as they appear on your {{document_name}}.",components:[(0,d.jsx)("strong",{},0)],values:{document_name:n}}),failure_message:(0,s.getIDVError)(o)}}};function St(){return St=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)({}).hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},St.apply(null,arguments)}function kt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function Nt(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?kt(Object(i),!0).forEach((function(t){Dt(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):kt(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Dt(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Ct=e=>{let{account_settings:t,getChangeableFields:i,onFormConfirm:r}=e;const{isDesktop:a}=(0,f.Y)(),[c,u]=o.useState(!0),[_,p]=o.useState(!1),[h,y]=o.useState({show_form:!0,form_initial_values:{first_name:"",last_name:"",date_of_birth:""},changeable_fields:[],api_error:""}),x=(0,d.jsx)(xt.A,{height:"195px",width:"285px"});o.useEffect((()=>{(async()=>{try{await(null===s.WS||void 0===s.WS?void 0:s.WS.wait("get_settings"));const e=["first_name","last_name","date_of_birth"],o=(0,s.filterObjProperties)(t,e);o.date_of_birth&&(o.date_of_birth=(0,s.toMoment)(o.date_of_birth).format("YYYY-MM-DD")),y(Nt(Nt({},h),{},{changeable_fields:i(),form_initial_values:o})),u(!1)}catch(e){console.error(e)}})()}),[t]);const{api_error:v}=h,z=St({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(h.form_initial_values),h.form_initial_values));return v?(0,d.jsx)(b,{error_message:v}):c?(0,d.jsx)(n.Loading,{is_fullscreen:!1,className:"account__initial-loader"}):(0,d.jsx)(m.Formik,{initialValues:z,enableReinitialize:!0,onSubmit:async(e,t)=>{let{setStatus:i,setSubmitting:o}=t;if(_)return;i({error_msg:""});const n=(0,g.Di)(e,null!=h&&h.changeable_fields?[...h.changeable_fields]:[]),a=await s.WS.setSettings(n);if(null!=a&&a.error){var l;i({error_msg:(null===(l=a.error)||void 0===l?void 0:l.code)===j.DUPLICATE_ACCOUNT?Ot:zt}),o(!1)}else{var c;const e=await s.WS.authorized.storage.getSettings();if(null!=e&&e.error)return void y(Nt(Nt({},h),{},{api_error:e.error.message}));const{first_name:t,last_name:i,date_of_birth:o}=null!==(c=null==e?void 0:e.get_settings)&&void 0!==c?c:Nt({},h.form_initial_values);y(Nt(Nt({},h),{},{form_initial_values:{first_name:t,last_name:i,date_of_birth:o}})),p(!0),u(!1),r&&setTimeout((()=>{r()}),500)}},validate:e=>{const t={};return(0,g.tf)(t,e)((e=>e),["first_name","last_name","date_of_birth"],(0,l.localize)("This field is required")),e.first_name&&(t.first_name=(0,g.yS)(e.first_name)),e.last_name&&(t.last_name=(0,g.yS)(e.last_name)),y(Nt(Nt({},h),{},{errors:!(0,s.isEmptyObject)((0,s.removeEmptyPropertiesFromObject)(t))})),(0,s.removeEmptyPropertiesFromObject)(t)},children:e=>{let{errors:t,handleSubmit:i,isSubmitting:o,status:r}=e;return(0,d.jsx)(m.Form,{className:"account-form__poi-confirm-example",onSubmit:i,children:(0,d.jsxs)(U,{children:[(0,d.jsx)(oe.A,{editable_fields:h.changeable_fields,is_rendered_for_onfido:!0,side_note:x,inline_note_text:(0,d.jsx)(l.Localize,{i18n_default_text:"To avoid delays, enter your <0>name</0> and <0>date of birth</0> exactly as they appear on your identity document.",components:[(0,d.jsx)("strong",{},0)]})}),(0,d.jsx)("button",{type:"submit",className:(0,O.A)("account-form__poi-confirm-example--button",{"account-form__poi-confirm-example--button__disabled":_||!(0,s.isEmptyObject)(t)}),children:(0,d.jsx)(n.Checkbox,{value:_,label:(0,d.jsx)(n.Text,{size:a?"xs":"xxs",children:(0,l.localize)("I confirm that the name and date of birth above match my chosen identity document (see below)")}),disabled:o})}),(null==r?void 0:r.error_msg)&&(0,d.jsx)("div",{className:"account-form__poi-confirm-example--status-message",children:(0,d.jsx)(n.HintBox,{icon:"IcAlertDanger",message:(0,d.jsx)(n.Text,{as:"p",size:"xxxs",children:null==r?void 0:r.error_msg}),is_danger:!0,className:"hint-box-layout"})})]})})}})},Tt=e=>{let{is_onfido_disabled:t,is_onfido_container_hidden:i,onfido_element_id:r="onfido",is_confirmed:a,data_testid:s,is_onfido_initialized:c}=e;const[u,_]=o.useState(!1),m=o.useRef(),f=o.useRef();return o.useEffect((()=>{a&&(m.current=setTimeout((()=>{_(!0)}),800),f.current=setTimeout((()=>{_(!1)}),4650))}),[a]),o.useEffect((()=>()=>{clearTimeout(m.current),clearTimeout(f.current)}),[]),(0,d.jsxs)("div",{className:"onfido-container-view_wrapper",children:[(0,d.jsx)("div",{className:(0,O.A)({"onfido-container__status-message_container":!t}),children:(0,d.jsx)(mt.A,{appear:u,in:u,timeout:{exit:350},classNames:{exit:"onfido-container__status-message--exit"},unmountOnExit:!0,children:(0,d.jsx)(n.HintBox,{className:"onfido-container__status-message",icon:"IcAlertAnnounce",message:(0,d.jsx)(n.Text,{as:"p",size:"xxxs",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Your personal details have been saved successfully."})}),is_info:!0})})}),(0,d.jsxs)("section",{children:[t&&c&&(0,d.jsx)("div",{className:"onfido-container__info-message",children:(0,d.jsx)(n.HintBox,{icon:"IcInfoBlue",message:(0,d.jsx)(n.Text,{as:"p",size:"xxxs",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Hit the checkbox above to choose your document."})}),is_info:!0})}),(0,d.jsx)("div",{"data-testid":s,id:r,className:(0,O.A)({"onfido-container__disabled":t,"onfido-container__hidden":i})})]})]})};var At=i(442438);const It=(0,r.observer)((e=>{var t;let{country_code:i,documents_supported:r,getChangeableFields:s,handleViewComplete:l,height:c,is_default_enabled:u}=e;const[_,m]=o.useState(),[p,b]=o.useState(""),[h,y]=o.useState(!0),[x,v]=o.useState(!1),[j,z]=o.useState(!1),[O,w]=o.useState(!1),{data:P}=(0,ft.A)(),{send:S,isSuccess:k}=(0,pt.A)(),{common:N}=(0,a.A)(),{current_language:D}=N,{isMobile:C}=(0,f.Y)(),T=(0,g.aZ)(i),A=(0,g.IW)(i),{service_token:I,isSuccess:E,isError:F,error:L,isLoading:R}=(0,bt.A)({service:"onfido",country:A}),M=o.useRef(),U=Array.isArray(r)?r:Object.keys(r).map((e=>r[e].display_name));let Y;const B=o.useCallback((e=>{var t;null==M||null===(t=M.current)||void 0===t||t.tearDown();const i=Object.keys(e).map((t=>{var i;return null===(i=e[t])||void 0===i?void 0:i.id}));null!=i&&i.length&&S({category:"authentication",event:"poi_documents_uploaded",args:{documents:i}})}),[S]),V=o.useCallback((async e=>{if(e)try{M.current=await window.Onfido.init({containerId:"onfido",language:{locale:(0,g.hf)(D),phrases:(0,At.e)(),mobilePhrases:(0,At.e)()},token:e,useModal:!1,useMemoryHistory:!0,onComplete:B,steps:[{type:"document",options:{documentTypes:{passport:U.some((e=>/Passport/g.test(e))),driving_licence:!!U.some((e=>/Driving Licence/g.test(e)))&&{country:T},national_identity_card:!!U.some((e=>/National Identity Card/g.test(e)))&&{country:T}},hideCountrySelection:!0}},"face"]}),z(!0)}catch(e){var t;m(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:e),y(!0),M.current=void 0}finally{w(!0)}}),[B,U,T,D]),q=o.useCallback((e=>{var t,i;null===(t=document.getElementById("onfido_sdk"))||void 0===t||t.remove(),null===(i=document.getElementById("onfido_style"))||void 0===i||i.remove();const o=document.createElement("script"),n=document.createElement("link");o.id="onfido_sdk",o.src="https://assets.onfido.com/web-sdk-releases/13.8.4/onfido.min.js",n.href="https://assets.onfido.com/web-sdk-releases/13.8.4/style.css",n.rel="stylesheet",n.id="onfido_style",document.body.appendChild(o),document.body.appendChild(n),o.addEventListener("load",(()=>{V(e)}))}),[V]),$=(0,o.useCallback)((()=>{v(!0),y(!1)}),[]);return o.useEffect((()=>{var e,t;E&&null!=I&&null!==(e=I.onfido)&&void 0!==e&&e.token&&!O?q(null==I||null===(t=I.onfido)||void 0===t?void 0:t.token):F&&(e=>{switch(e.code){case"MissingPersonalDetails":b("all");break;case"InvalidPostalCode":b("postal_code");break;default:m(e.message)}})(L)}),[L,F,E,O,q,null==I||null===(t=I.onfido)||void 0===t?void 0:t.token]),o.useEffect((()=>{u&&y(!1)}),[u]),o.useEffect((()=>{k&&l()}),[l,k]),R||!O?Y=(0,d.jsx)(n.Loading,{is_fullscreen:!1}):p?Y=(0,d.jsx)(yt,{has_invalid_postal_code:"postal_code"===p,from:"proof_of_identity"}):_&&(Y=(0,d.jsx)(Le,{message:_})),(0,d.jsx)(n.ThemedScrollbars,{is_bypassed:C,height:c,children:(0,d.jsxs)("div",{className:"onfido-container",children:[Y||(0,d.jsx)(mt.A,{appear:h,in:h,timeout:{exit:350},classNames:{exit:"account-form__poi-confirm-example_wrapper--exit"},unmountOnExit:!0,children:(0,d.jsx)("div",{className:"account-form__poi-confirm-example_wrapper account-form__poi-confirm-example_container",children:(0,d.jsx)(Ct,{account_settings:P,getChangeableFields:s,onFormConfirm:$})})}),(0,d.jsx)(Tt,{is_onfido_disabled:h,is_confirmed:x,is_onfido_container_hidden:!!Y,is_onfido_initialized:j})]})})}));It.displayName="OnfidoSdkViewContainer";const Et=It;function Ft(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function Lt(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ft(Object(i),!0).forEach((function(t){Rt(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ft(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Rt(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Mt="manual-poi-details",Ut="national_identity_card",Yt="nimc_slip",Bt="passport",Vt="driving_licence",qt="birth_certificate",$t="front",Wt="back",Gt="photo",Ht={document_type:"selfie_with_id",pageType:Gt,name:"selfie_with_id",icon:"IcSelfie",info:(0,l.localize)("Upload your selfie.")},Qt={name:"expiry_date",label:(0,l.localize)("Expiry date"),type:"date",required:!0};function Zt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function Jt(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Zt(Object(i),!0).forEach((function(t){Kt(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Zt(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Kt(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Xt=e=>{let{data:t}=e;const i=(0,s.toMoment)().add(6,"months").format("YYYY-MM-DD");switch(t.type){case"text":return(0,d.jsx)(m.Field,{name:t.name,children:e=>{let{field:i,form:{errors:o,touched:r}}=e;return(0,d.jsx)(n.Input,Jt(Jt({},i),{},{className:`${Mt}__field`,type:"text",label:`${t.label}${t.required?"*":""}`,error:r[i.name]&&o[i.name]}))}});case"date":return(0,d.jsx)(m.Field,{name:t.name,children:e=>{let{field:o,form:{errors:r,touched:a}}=e;return(0,d.jsx)(n.DatePicker,Jt(Jt({},o),{},{className:`${Mt}__field`,date_format:"YYYY-MM-DD",display_format:"DD-MM-YYYY",start_date:i,min_date:i,name:t.name,label:`${t.label}${t.required?"*":""}`,error:a[o.name]&&r[o.name],readOnly:!0}))}});default:return null}};function ei(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function ti(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ei(Object(i),!0).forEach((function(t){ii(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ei(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function ii(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const oi={"file-too-large":(0,l.localize)("File size should be 8MB or less"),"file-invalid-type":(0,l.localize)("File uploaded is not supported"),"too-many-files":(0,l.localize)("Please select one file only"),GENERAL:(0,l.localize)("Sorry, an error occured. Please select another file.")},ni=e=>{let{data:t,open:i}=e;const{isDesktop:o}=(0,f.Y)();return(0,d.jsxs)("div",{className:`${Mt}__uploader-details`,children:[(0,d.jsx)(n.Icon,{className:`${Mt}__uploader-icon`,icon:null==t?void 0:t.icon,size:236}),(0,d.jsx)(n.Text,{as:"p",size:"xs",color:"general",align:"center",children:null==t?void 0:t.info}),(0,d.jsx)(n.Button,{medium:!0,secondary:!0,text:o?(0,l.localize)("Drop file or click here to upload"):(0,l.localize)("Tap here to upload"),onClick:i})]})},ri=e=>{let{data:t,setFieldValue:i,value:r,has_frame:a,handleChange:s}=e;const[l,c]=o.useState("");return o.useEffect((()=>{c(null!=r&&r.file?URL.createObjectURL(null==r?void 0:r.file):"")}),[r]),(0,d.jsxs)("div",{className:`${Mt}__uploader-details ${Mt}__uploader-details--preview`,children:[(0,d.jsxs)("div",{className:(0,O.A)(`${Mt}__uploader-image`,{[`${Mt}__uploader-image--has-frame`]:a}),style:{backgroundImage:`url(${l})`},children:[a&&(0,d.jsx)(n.Icon,{icon:"IcPoiFrame",className:`${Mt}__uploader-frame`}),(!l||-1!==(null==r?void 0:r.file.type.indexOf("pdf")))&&(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)(n.Icon,{icon:"IcCloudUpload",size:50}),(0,d.jsx)(n.Text,{as:"p",size:"xs",color:"general",align:"center",children:null==r?void 0:r.file.name})]}),(0,d.jsx)(n.Icon,{icon:"IcCloseCircle",className:`${Mt}__uploader-remove`,onClick:()=>{null==s||s(null,i)},size:16})]}),(0,d.jsx)(n.Text,{as:"p",size:"xs",color:"general",align:"center",children:null==t?void 0:t.info})]})},ai=e=>{let{data:t,value:i,is_full:r,onChange:a,has_frame:c}=e;const{isDesktop:u}=(0,f.Y)(),[_,p]=o.useState();o.useEffect((()=>{p(i)}),[i]);const b=(e,i)=>{null==a||a(e),null==i||i(null==t?void 0:t.name,e)},h=e=>{var t;return(0,d.jsxs)("div",{className:`${Mt}__uploader-details`,children:[null==_||null===(t=_.errors)||void 0===t?void 0:t.map(((e,t)=>(0,d.jsx)(n.Text,{as:"p",size:"xs",color:"secondary",align:"center",children:e},t))),(0,d.jsx)(n.Button,{medium:!0,secondary:!0,text:u?(0,l.localize)("Drop file or click here to upload"):(0,l.localize)("Tap here to upload"),onClick:e})]})};return(0,d.jsx)(m.Field,{name:null==t?void 0:t.name,children:e=>{var o;let{form:{setFieldValue:a}}=e;return(0,d.jsx)("div",{className:(0,O.A)(`${Mt}__uploader`,{[`${Mt}__uploader--full`]:r}),children:(0,d.jsx)(n.FileDropzone,{accept:s.supported_filetypes,error_message:(0,l.localize)("Please upload supported file type."),filename_limit:32,hover_message:(0,l.localize)("Drop files here.."),max_size:s.max_document_size,message:e=>(0,d.jsx)(ni,{open:e,data:t}),preview_single:_&&(0,d.jsx)(ri,{data:t,value:_,has_frame:c,setFieldValue:a,handleChange:b}),multiple:!1,onDropAccepted:e=>((e,i)=>{const o=ti({file:e[0],errors:[]},t);b(o,i)})(e,a),onDropRejected:e=>((e,i)=>{var o;const n=null===(o=e[0].errors)||void 0===o?void 0:o.map((e=>oi[e.code]?oi[e.code]:oi.GENERAL)),r=ti(ti({},e[0]),{},{errors:n},t);b(r,i)})(e,a),validation_error_message:null!=i&&null!==(o=i.errors)&&void 0!==o&&o.length?h:void 0,noClick:!0,value:_?[_]:[]})})}})},si=e=>{const t={};return e.forEach((e=>{t[e.name]=""})),t},li=e=>"string"==typeof e?!e.trim():!e,ci=function(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i={};return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach((t=>{const{name:o,label:n,type:r}=t,a=e[o];t.required&&li(a)?i[o]=(0,l.localize)("{{label}} is required.",{label:n}):"text"===r&&a.length>30?i[o]=(0,l.localize)("{{label}} must be less than 30 characters.",{label:n}):"text"!==r||/^[\w\s-]{0,30}$/g.test(a)||(i[o]=(0,l.localize)("Only letters, numbers, space, underscore, and hyphen are allowed for {{label}}.",{label:n}))})),t.forEach((t=>{var o;const{name:n}=t,r=e[n];li(r)?i[n]=(0,l.localize)("{{name}} is required.",{name:n}):null!==(o=r.errors)&&void 0!==o&&o.length&&(i[n]=r.errors[0])})),i},di=[{icon:"IcPoiClearPhoto",text:(0,l.localize)("A clear colour photo or scanned image")},{icon:"IcPoiFileFormat",text:(0,l.localize)("JPEG, JPG, PNG, PDF, or GIF")},{icon:"IcPoiFileSize",text:(0,l.localize)("Less than 8MB")},{icon:"IcPoiDocExpiry",text:(0,l.localize)("Must be valid for at least 6 months")}],ui=e=>{let{data:t}=e;return(0,d.jsxs)("div",{className:`${Mt}__icons-item`,children:[(0,d.jsx)(n.Icon,{icon:t.icon,size:24}),(0,d.jsx)(n.Text,{as:"p",size:"xxxs",align:"center",children:t.text})]})},_i=e=>{let{initial_values:t,is_from_external:i,data:o,goToCards:r,onSubmit:a}=e;const{isDesktop:s}=(0,f.Y)(),{fields:c,documents_title:u,documents:_}=o,p=c.some((e=>e.name===Qt.name)),b=p?(0,d.jsx)(l.Localize,{i18n_default_text:"First, enter your {{label}} and the expiry date.",values:{label:null==c?void 0:c[0].label}}):(0,d.jsx)(l.Localize,{i18n_default_text:"First, enter your {{label}}.",values:{label:null==c?void 0:c[0].label}});return(0,d.jsx)("div",{className:(0,O.A)(Mt,{[`${Mt}--mobile`]:!s}),children:(0,d.jsx)(m.Formik,{initialValues:t||si([...c||[],..._||[]]),validate:e=>ci(e,c,_),onSubmit:a,children:e=>{let{values:t,isValid:o,touched:a}=e;const f=Object.keys(a).length>0,h=Object.values(t).some(((e,t)=>{var i;return(null===e||""===e)&&(null==c||null===(i=c[t])||void 0===i?void 0:i.required)}));return(0,d.jsxs)(m.Form,{className:`${Mt}__form`,children:[(0,d.jsx)(U,{className:"form-body",scroll_offset:s?"80px":"180px",children:(0,d.jsxs)("div",{className:`${Mt}__fields-content`,children:[(0,d.jsx)(n.Text,{as:"h3",size:"s",color:"prominent",children:b}),(0,d.jsx)("div",{className:`${Mt}__fields-wrap`,children:null==c?void 0:c.map((e=>(0,d.jsx)(Xt,{data:e},e.name)))}),(0,d.jsx)("div",{className:`${Mt}__divider`}),(0,d.jsx)(n.Text,{as:"h3",size:"s",color:"prominent",children:u}),(0,d.jsx)("div",{className:`${Mt}__uploaders-wrap`,children:null==_?void 0:_.map((e=>(0,d.jsx)(ai,{data:e,value:t[e.name],is_full:1===_.length||i},e.name)))}),(0,d.jsx)("div",{className:`${Mt}__icons`,children:di.map((e=>"IcPoiDocExpiry"!==e.icon||p?(0,d.jsx)(ui,{data:e},e.icon):null))})]})}),(0,d.jsx)(B,{children:(0,d.jsxs)("div",{className:`${Mt}__btns`,children:[(0,d.jsx)(n.Button,{onClick:r,secondary:!0,large:!0,text:(0,l.localize)("Back")}),(0,d.jsx)(n.Button,{type:"submit",primary:!0,large:!0,is_disabled:!o||!f&&h,text:(0,l.localize)("Next")})]})})]})}})})},mi=e=>{let{initial_values:t,goBack:i,onConfirm:o,onFileDrop:r}=e;const{isDesktop:a}=(0,f.Y)();return(0,d.jsx)("div",{className:(0,O.A)(Mt,{[`${Mt}--mobile`]:!a}),children:(0,d.jsx)(m.Formik,{initialValues:t||si([Ht]),validate:e=>ci(e,void 0,[Ht]),onSubmit:o,children:e=>{let t,o,{values:s,isValid:c,isSubmitting:u,touched:_}=e;return _&&(t=Object.keys(_).length>0),s&&(o=Object.values(s).some((e=>null===e||""===e))),(0,d.jsxs)(m.Form,{className:`${Mt}__form`,children:[(0,d.jsx)(U,{className:"form-body",scroll_offset:a?"8rem":"18rem",children:(0,d.jsxs)("div",{className:`${Mt}__fields-content`,children:[(0,d.jsx)(n.Text,{as:"h3",size:"s",weight:"bold",color:"prominent",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Upload your selfie"})}),(0,d.jsx)("div",{className:`${Mt}__uploaders-wrap`,children:(0,d.jsx)(ai,{data:Ht,value:s?s[Ht.name]:"",is_full:!0,onChange:r,has_frame:!0})}),(0,d.jsx)("div",{className:`${Mt}__notice`,children:(0,d.jsx)(n.Text,{as:"p",size:"xs",color:"general",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Before uploading, please ensure that you’re facing forward in the selfie, your face is within the frame, and your eyes are clearly visible even if you’re wearing glasses."})})})]})}),(0,d.jsx)(B,{children:(0,d.jsxs)("div",{className:`${Mt}__btns`,children:[(0,d.jsx)(n.Button,{onClick:i,secondary:!0,large:!0,text:(0,l.localize)("Back")}),(0,d.jsx)(n.Button,{type:"submit",primary:!0,large:!0,is_disabled:!c||u||!t&&o,text:(0,l.localize)("Confirm and upload")})]})})]})}})})};function fi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function pi(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?fi(Object(i),!0).forEach((function(t){bi(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):fi(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function bi(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const hi=e=>{let{data:t,goToCards:i,onComplete:n,is_from_external:r}=e;const[a,s]=o.useState(),[l,c]=o.useState(),[u,_]=o.useState(!1);return(0,d.jsx)(o.Fragment,{children:u?(0,d.jsx)(mi,{initial_values:l,goBack:()=>_(!1),onConfirm:e=>{n(pi(pi({},a),e))},onFileDrop:e=>c({[Ht.name]:e})}):(0,d.jsx)(_i,{initial_values:a,is_from_external:r,data:t,goToCards:i,onSubmit:e=>{s(e),_(!0)}})})},yi=["document","onClickBack","root_class","country_code_key","height","handleComplete","is_onfido_supported","is_from_external","is_for_mt5","handlePOIforMT5Complete","needs_poa"];function xi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function vi(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?xi(Object(i),!0).forEach((function(t){gi(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):xi(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function gi(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const ji={IS_UPLOADING:"IS_UPLOADING",IS_COMPLETED:"IS_COMPLETED",IS_FAILED:"IS_FAILED"},zi=e=>{let{document:t,onClickBack:i,root_class:r,country_code_key:a,height:c,handleComplete:u,is_onfido_supported:_,is_from_external:m,is_for_mt5:f,handlePOIforMT5Complete:p,needs_poa:b}=e,h=function(e,t){if(null==e)return{};var i,o,n=function(e,t){if(null==e)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.includes(o))continue;i[o]=e[o]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)i=r[o],t.includes(i)||{}.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}(e,yi);const[y,x]=o.useState(""),[v,g]=o.useState("");let z=!1;const O=e=>{var i;x(ji.IS_UPLOADING),(i=e,new Promise(((e,o)=>{const n=t.details.documents.map((e=>e.name)),r=Object.values(i).filter((e=>[...n,Ht.name].includes(e.name))),c=r.length;let d=0;const u=[],_=()=>{var t;const n=r[d],{file:m,document_type:f,pageType:p,lifetime_valid:b}=n,h="function"==typeof(null===(t=i.expiry_date)||void 0===t?void 0:t.format)?i.expiry_date.format("YYYY-MM-DD"):void 0;_t(m,s.WS.getSocket,{document_type:f,page_type:p,expiration_date:h,document_id:i.document_id||"",lifetime_valid:+(b&&!h),document_issuing_country:a}).then((t=>{d+=1,(null==t?void 0:t.warning)===j.DUPLICATE_DOCUMENT?x(ji.IS_DUPLICATE_UPLOAD):null!=t&&t.warning||t.error?(z=!0,x(ji.IS_FAILED),g(t.message||(t.error?t.error.message:(0,l.localize)("Failed"))),d<c&&_()):d<c?(u.push(t),_()):e(u)})).catch((e=>{o(e)}))};_()}))).then((()=>{z||(f?null==p||p():x(ji.IS_COMPLETED))})).catch((e=>{x(ji.IS_FAILED),g(e.message)}))};switch(y){case ji.IS_UPLOADING:return(0,d.jsx)(n.Loading,{is_fullscreen:!1,is_slow_loading:!0,status:[(0,l.localize)("Uploading documents")]});case ji.IS_COMPLETED:return(0,d.jsx)(et,{is_from_external:!0,needs_poa:b,is_manual_upload:!0});case ji.IS_FAILED:return(0,d.jsx)(lt,{error:v});case ji.IS_DUPLICATE_UPLOAD:return(0,d.jsx)(lt,{error:(0,d.jsx)(l.Localize,{i18n_default_text:"It seems you’ve submitted this document before. Upload a new document."}),children:(0,d.jsx)(n.Button,{onClick:i,large:!0,primary:!0,className:"upload_error_btn",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Try Again"})})});default:return(0,d.jsx)(o.Fragment,{children:_?(0,d.jsxs)(o.Fragment,{children:[(0,d.jsxs)("div",{className:`${r}__detail-header`,onClick:i,children:[(0,d.jsx)(n.Icon,{icon:"IcArrowLeftBold"}),(0,d.jsx)(n.Text,{as:"p",size:"xs",weight:"bold",color:"prominent",className:`${r}__back-title`,children:(0,l.localize)("Back")})]}),(0,d.jsx)(Et,vi({country_code:a,documents_supported:[t.onfido_name],height:null!=c?c:null,handleComplete:f?p:u,is_default_enabled:!0,handleViewComplete:f?p:u},h))]}):(0,d.jsx)(hi,{data:t.details,onComplete:O,goToCards:i,is_from_external:m})})}},Oi=e=>{let{onClick:t,title:i,description:o,icon:r}=e;const{isDesktop:a}=(0,f.Y)();return(0,d.jsxs)("div",{className:"manual-poi__card",onClick:t,children:[(0,d.jsx)(n.Icon,{className:"manual-poi__card-icon",icon:r,size:64}),(0,d.jsxs)("div",{className:"manual-poi__card-content",children:[(0,d.jsx)(n.Text,{as:"p",size:"xs",weight:"bold",color:"prominent",children:i}),(0,d.jsx)(n.Text,{as:"p",size:a?"xxs":"xxxs",children:o})]}),(0,d.jsx)(n.Icon,{icon:"IcChevronRight",size:a?31:23})]})};function wi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function Pi(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Si=e=>{let{toggleDetail:t,documents:i}=e;return(0,d.jsx)(o.Fragment,{children:i.map(((e,i)=>{var o;return(0,d.jsx)(n.Card,{renderContent:()=>(0,d.jsx)(Oi,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?wi(Object(i),!0).forEach((function(t){Pi(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):wi(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({onClick:()=>t(i)},e.card))},null===(o=e.card)||void 0===o?void 0:o.icon)}))})},ki=["country_code","handlePOIforMT5Complete","manual","redirect_button","needs_poa","handleBack","handleRequireSubmission","allow_poi_resubmission","handleViewComplete","onfido","is_for_mt5","is_resubmission"];function Ni(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function Di(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Ci=e=>{let{country_code:t,handlePOIforMT5Complete:i,manual:r,redirect_button:a,needs_poa:s,handleBack:c,handleRequireSubmission:u,allow_poi_resubmission:_,handleViewComplete:m,onfido:f,is_for_mt5:p,is_resubmission:b}=e,h=function(e,t){if(null==e)return{};var i,o,n=function(e,t){if(null==e)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.includes(o))continue;i[o]=e[o]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)i=r[o],t.includes(i)||{}.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}(e,ki);const[y,x]=o.useState(null),v=(e=>{let{country_code:t}=e;return[{onfido_name:"Passport",card:{title:(0,l.localize)("Passport"),description:(0,l.localize)("Upload the page that contains your photo."),icon:"IcPoiPassport"},details:{fields:[{name:"document_id",label:(0,l.localize)("Passport number"),type:"text",required:!0},Lt({},Qt)],documents_title:(0,l.localize)("Next, upload the page of your passport that contains your photo."),documents:[{document_type:Bt,pageType:$t,name:"passport",icon:"IcPassport",info:(0,l.localize)("Upload the page of your passport that contains your photo.")}]}},{onfido_name:"Driving Licence",card:{title:(0,l.localize)("Driving licence"),description:(0,l.localize)("Upload the front and back of your driving licence."),icon:"IcPoiDrivingLicence"},details:{fields_title:(0,l.localize)("First, enter your driving licence number and the expiry date."),fields:[{name:"document_id",label:(0,l.localize)("Driving licence number"),type:"text",required:!0},Lt({},Qt)],documents_title:(0,l.localize)("Next, upload the front and back of your driving licence."),documents:[{document_type:Vt,pageType:$t,name:"driving_licence_front",icon:"IcDrivingLicenceFront",info:(0,l.localize)("Upload the front of your driving licence.")},{document_type:Vt,pageType:Wt,name:"driving_licence_back",icon:"IcIdCardBack",info:(0,l.localize)("Upload the back of your driving licence.")}]}},{onfido_name:"National Identity Card",card:{title:(0,l.localize)("Identity card"),description:(0,l.localize)("Upload the front and back of your identity card."),icon:"IcPoiIdentityCard"},details:{fields_title:(0,l.localize)("First, enter your identity card number and the expiry date."),fields:[{name:"document_id",label:(0,l.localize)("Identity card number"),type:"text",required:!0},Lt({},Qt)],documents_title:(0,l.localize)("Next, upload the front and back of your identity card."),documents:[{document_type:Ut,pageType:$t,name:"identity_card_front",icon:"IcIdCardFront",info:(0,l.localize)("Upload the front of your identity card.")},{document_type:Ut,pageType:Wt,name:"identity_card_back",icon:"IcIdCardBack",info:(0,l.localize)("Upload the back of your identity card.")}]}},..."ng"===t?[{card:{title:(0,l.localize)("NIMC slip and proof of age"),description:(0,l.localize)("Upload both of these documents to prove your identity."),icon:"IcPoiNimcSlip"},details:{fields:[{name:"document_id",label:(0,l.localize)("NIMC slip number"),type:"text",required:!0}],documents_title:(0,l.localize)("Next, upload both of the following documents."),documents:[{document_type:Yt,lifetime_valid:!0,pageType:$t,name:"nimc_slip",icon:"IcPoiNimcSlipHorizontal",info:(0,l.localize)("Upload your NIMC slip.")},{document_type:qt,pageType:Gt,name:"birth_certificate_front",icon:"IcDop",info:(0,l.localize)("Upload your proof of age: birth certificate or age declaration document.")}]}}]:[]]})({country_code:t});if(r){if(r.status===ke.pending)return(0,d.jsx)(tt,{is_manual_upload:!0,needs_poa:s,redirect_button:a});if([ke.rejected,ke.suspected].some((e=>e===r.status))){if(!_)return(0,d.jsx)(Je,{})}else{if(r.status===ke.verified)return(0,d.jsx)(nt,{needs_poa:s,redirect_button:a});if(r.status===ke.expired)return(0,d.jsx)(Re,{redirect_button:a,handleRequireSubmission:u})}}if(null!==y){const e="ng"===t&&!(e=>{let t=!1;return e.forEach((e=>{e.document_type===Yt&&(t=!0)})),t})(v[null!=y?y:0].details.documents)&&f&&f.submissions_left>0;return(0,d.jsx)(zi,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ni(Object(i),!0).forEach((function(t){Di(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ni(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({is_onfido_supported:e,country_code_key:t,document:v[y],root_class:"manual-poi",onClickBack:()=>x(null),handlePOIforMT5Complete:i,handleComplete:m,is_for_mt5:p,needs_poa:s},h))}return(0,d.jsxs)("div",{className:"manual-poi",children:[(0,d.jsx)(n.Text,{as:"h2",color:"prominent",size:"xs",className:"manual-poi__title",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Please upload one of the following documents:"})}),(0,d.jsx)(Si,{documents:v,toggleDetail:e=>x(e)}),!p&&!b&&(0,d.jsx)(B,{className:"proof-of-identity__footer",children:(0,d.jsx)(n.Button,{className:"back-btn",onClick:c,type:"button",has_effect:!0,large:!0,secondary:!0,children:(0,d.jsx)(l.Localize,{i18n_default_text:"Back"})})})]})},Ti=Ci,Ai=e=>{let{handleRequireSubmission:t,is_from_external:i,needs_poa:o,onfido:n,redirect_button:r,manual:a,country_code:l,handleViewComplete:c}=e;const{status:u,submissions_left:_,last_rejected:m}=n;switch(u){case ke.pending:return(0,d.jsx)(tt,{is_from_external:i,needs_poa:o,redirect_button:r});case ke.rejected:case ke.suspected:case ke.expired:{const e=(0,s.formatOnfidoError)(u,m);return Number(_)<1?(0,d.jsx)(Ti,{manual:a,is_from_external:i,country_code:l,handleViewComplete:c,onfido:n}):(0,d.jsx)(st,{rejected_reasons:e,handleRequireSubmission:t})}case ke.verified:return(0,d.jsx)(nt,{is_from_external:i,needs_poa:o,redirect_button:r,service:Ae});default:return null}};var Ii=i(780146);function Ei(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function Fi(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ei(Object(i),!0).forEach((function(t){Li(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ei(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Li(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Ri=e=>{var t,i;let{handleSelectionNext:r,is_from_external:a,mismatch_status:c}=e;const{setSelectedCountry:u}=o.useContext(s.POIContext),{data:_,isLoading:p}=(0,Ii.A)(),{isDesktop:b}=(0,f.Y)(),h=e=>{const t=null==_?void 0:_.find((t=>t.text===e));t&&(null==u||u(t))},y=c&&null!==(t=null===(i=s.IDV_ERROR_STATUS[c])||void 0===i?void 0:i.message)&&void 0!==t?t:null;return(0,d.jsx)(m.Formik,{initialValues:{country_input:""},validate:e=>{const t={},{country_input:i}=e;return i?_.find((e=>e.text===i))||(t.country_input=(0,l.localize)("Please select a valid country of document issuance.")):t.country_input=(0,l.localize)("Please select the country of document issuance."),t},onSubmit:(e,t)=>{let{setSubmitting:i}=t;h(e.country_input),i(!1),null==r||r()},children:e=>{let{dirty:t,errors:i,handleBlur:r,handleChange:s,handleSubmit:c,isSubmitting:u,isValid:f,setFieldValue:x,touched:v,values:g}=e;return(0,d.jsxs)(o.Fragment,{children:[(0,d.jsxs)("div",{className:(0,O.A)("proof-of-identity__container proof-of-identity__country-container",{"min-height":!a}),children:[y?(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)(n.Text,{align:"center",weight:"bold",size:b?"s":"xs",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Your identity verification failed because:"})}),(0,d.jsx)(n.HintBox,{className:(0,O.A)("proof-of-identity__failed-message","hint-box-layout"),icon:"IcAlertDanger",message:(0,d.jsx)(n.Text,{as:"p",size:b?"xs":"xxs",children:y}),is_danger:!0})]}):(0,d.jsx)(n.Text,{className:"proof-of-identity__header",align:"center",weight:"bold",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Proof of identity"})}),(0,d.jsx)(n.Text,{className:"proof-of-identity__country-text ",size:"xs",children:(0,d.jsx)(l.Localize,{i18n_default_text:"In which country was your document issued?"})}),(0,d.jsx)("fieldset",{className:"proof-of-identity__fieldset",children:(0,d.jsx)(m.Field,{name:"country_input",children:e=>{let{field:t}=e;return(0,d.jsx)(o.Fragment,{children:b?(0,d.jsx)(n.Autocomplete,Fi(Fi({className:(0,O.A)({"external-dropdown":a})},t),{},{data_testid:"dt_external_dropdown",name:"country_input","data-lpignore":"true",error:v.country_input&&i.country_input,autoComplete:"off",type:"text",label:(0,l.localize)("Country"),list_items:_,value:g.country_input,onBlur:e=>{r(e);const t=e.target.value;_.find((e=>e.text===t))||(x("country_input","",!0),h(""))},onChange:s,onItemSelection:e=>{let{text:t}=e;x("country_input","No results found"!==t&&t?t:"",!0),h(t)},required:!0})):(0,d.jsx)("div",{className:"proof-of-identity__dropdown-container",children:(0,d.jsx)(n.SelectNative,Fi(Fi({},t),{},{name:"country_input",error:v.country_input&&i.country_input,label:(0,l.localize)("Country"),placeholder:(0,l.localize)("Please select"),list_items:_,value:g.country_input,onChange:e=>{s(e),h(e.target.value)},use_text:!0,required:!0}))})})}})})]}),(0,d.jsx)(B,{className:(0,O.A)("proof-of-identity__footer",{"external-footer":a}),children:(0,d.jsx)(n.Button,{className:"proof-of-identity__submit-button",type:"submit",onClick:()=>c(),has_effect:!0,is_disabled:!t||u||!f||p,is_loading:!1,text:(0,l.localize)("Next"),large:!0,primary:!0})})]})}})};var Mi=i(434828);function Ui(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function Yi(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ui(Object(i),!0).forEach((function(t){Bi(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ui(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Bi(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Vi=(0,r.observer)((e=>{let{handleBack:t,handleViewComplete:i,handleSelectionNext:r,selected_country:c}=e;const{client:u}=(0,a.A)(),{account_settings:_,getChangeableFields:p}=u,{isDesktop:b}=(0,f.Y)(),h=o.useMemo((()=>(0,s.getIDVNotApplicableOption)()),[]),y=e=>e===h.id,x=(0,d.jsx)(xt.A,{height:"195px",width:"285px"}),v=(0,s.filterObjProperties)(_,["first_name","last_name","date_of_birth"]);v.date_of_birth&&(v.date_of_birth=(0,s.toMoment)(v.date_of_birth).format("YYYY-MM-DD"));const z=p(),w=Yi(Yi({document_type:{id:"",text:"",value:"",example_format:""},document_number:""},v),{},{confirmation_checkbox:!1});return(0,d.jsx)(m.Formik,{initialValues:Yi({},w),validate:e=>{const t={},{document_type:i,document_number:o,document_additional:n}=e;if(y(i.id))return t;const r=!!i.additional;t.document_type=(0,g.k4)(i),(0,g.DY)(null==i?void 0:i.id)||(r&&(t.document_additional=(0,g.dC)(i,n)),t.document_number=(0,g.Zy)(o,i));return(0,g.tf)(t,e)((e=>e),["first_name","last_name","date_of_birth"],(0,l.localize)("This field is required")),e.first_name&&(t.first_name=(0,g.yS)(e.first_name)),e.last_name&&(t.last_name=(0,g.yS)(e.last_name)),e.confirmation_checkbox||(t.confirmation_checkbox="error"),(0,s.removeEmptyPropertiesFromObject)(t)},onSubmit:async(e,t)=>{var o;let{setSubmitting:n,setStatus:a}=t;if(y(null==e||null===(o=e.document_type)||void 0===o?void 0:o.id))return void(null==r||r(!0));n(!0);const l=(0,g.Di)(e,z),d=await s.WS.setSettings(l);if(null!=d&&d.error){var u;return a({error_message:(null===(u=d.error)||void 0===u?void 0:u.code)===j.DUPLICATE_ACCOUNT?Ot:zt}),void n(!1)}const _=await s.WS.authorized.storage.getSettings();var m,f;if(null!=_&&_.error)return a({error_message:null!==(m=null==_||null===(f=_.error)||void 0===f?void 0:f.message)&&void 0!==m?m:zt}),void n(!1);const p=Yi({identity_verification_document_add:1},(0,s.formatIDVFormValues)(e,c.value)),b=await s.WS.send(p);if(null!=b&&b.error){var h,x,v;return a({error_message:(null===(h=b.error)||void 0===h?void 0:h.code)===j.CLAIMED_DOCUMENT?wt:null!==(x=null===(v=b.error)||void 0===v?void 0:v.message)&&void 0!==x?x:zt}),void n(!1)}n(!1),i()},enableReinitialize:!0,children:e=>{var i,r,a;let{dirty:s,isSubmitting:u,isValid:_,values:f,status:p}=e;const h=y(null==f||null===(i=f.document_type)||void 0===i?void 0:i.id),v=!h&&(!s||u||!_);return(0,d.jsxs)(m.Form,{className:(0,O.A)("proof-of-identity__container proof-of-identity__container--reset",{"min-height":y(null==f||null===(r=f.document_type)||void 0===r?void 0:r.id)}),children:[(null==p?void 0:p.error_message)&&(0,d.jsx)("div",{className:"account-form__poi-confirm-example--generic-error-msg",children:(0,d.jsx)(n.HintBox,{icon:"IcAlertDanger",message:(0,d.jsx)(n.Text,{as:"p",size:"xxxs",children:p.error_message}),is_danger:!0,className:"hint-box-layout"})}),(0,d.jsxs)(U,{className:"form-body",scroll_offset:b?"80px":"180px",children:[(0,d.jsx)(V.A,{title:(0,l.localize)("Identity verification")}),(0,d.jsx)(Mi.A,{selected_country:c,class_name:"idv-layout"}),!y(null==f||null===(a=f.document_type)||void 0===a?void 0:a.id)&&(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)(V.A,{title:(0,l.localize)("Details")}),(0,d.jsx)(oe.A,{class_name:"account-form__poi-confirm-example_container",is_rendered_for_idv:!0,editable_fields:f.confirmation_checkbox?[]:z,side_note:x,inline_note_text:(0,d.jsx)(l.Localize,{i18n_default_text:"To avoid delays, enter your <0>name</0> and <0>date of birth</0> exactly as they appear on your identity document.",components:[(0,d.jsx)("strong",{},0)]})})]})]}),(0,d.jsxs)(B,{className:"proof-of-identity__footer ",children:[b&&(0,d.jsx)(n.Button,{className:"back-btn",onClick:t,type:"button",has_effect:!0,large:!0,secondary:!0,children:(0,d.jsx)(l.Localize,{i18n_default_text:"Back"})}),(0,d.jsx)(n.Button,{className:"proof-of-identity__submit-button",type:"submit",has_effect:!0,is_disabled:v,large:!0,primary:!0,children:h?(0,d.jsx)(l.Localize,{i18n_default_text:"Next"}):(0,d.jsx)(l.Localize,{i18n_default_text:"Verify"})})]})]})}})}));function qi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function $i(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?qi(Object(i),!0).forEach((function(t){Wi(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):qi(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Wi(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Gi=e=>{var t,i;let{getChangeableFields:r,is_from_external:c,residence_list:u,account_settings:_,handleSubmit:p,mismatch_status:h=s.IDV_ERROR_STATUS.Failed.code,latest_status:y,selected_country:x,handleSelectionNext:v}=e;const{client:z}=(0,a.A)(),{setIsAlreadyAttempted:w}=z,{isMobile:P,isDesktop:S}=(0,f.Y)(),[k,N]=o.useState({required_fields:[],side_note_image:(0,d.jsx)(xt.A,{height:"195px",width:"285px"}),failure_message:null,inline_note_text:null}),[D,C]=o.useState(!0),[T,A]=o.useState({api_error:"",errors:!1,form_initial_values:{},changeable_fields:[]}),I=o.useMemo((()=>![s.IDV_ERROR_STATUS.DobMismatch.code,s.IDV_ERROR_STATUS.NameMismatch.code,s.IDV_ERROR_STATUS.NameDobMismatch.code].includes(h)),[h]),E=o.useMemo((()=>{var e;return I&&!c?null!=x?x:{}:null!==(e=u.find((e=>e.value===(null==y?void 0:y.country_code))))&&void 0!==e?e:{}}),[x,I,null==y?void 0:y.country_code,u,c]),F=o.useMemo((()=>(0,s.getIDVNotApplicableOption)()),[]),L=e=>e===F.id;o.useEffect((()=>{var e;w(!0);const t=Pt(I,y,E,h);N(t),(async e=>{await(null===s.WS||void 0===s.WS?void 0:s.WS.wait("get_settings"));const t=(0,s.filterObjProperties)(_,e);t.date_of_birth&&(t.date_of_birth=(0,s.toMoment)(t.date_of_birth).format("YYYY-MM-DD")),t.confirmation_checkbox=!1;let i=t;I&&(i=$i({document_type:{id:"",text:"",value:"",example_format:"",sample_image:""},document_number:""},i)),A({form_initial_values:$i({},i),changeable_fields:[...r()],api_error:""}),C(!1)})(null!==(e=null==t?void 0:t.required_fields)&&void 0!==e?e:[]).catch((e=>{var t;A({form_initial_values:{},changeable_fields:[],api_error:null==e||null===(t=e.error)||void 0===t?void 0:t.message})}))}),[h,_,I,r,Pt,w]);if(null!=T&&T.api_error)return(0,d.jsx)(b,{error_message:T.api_error});if(D&&0===Object.keys(null!==(t=null==T?void 0:T.form_initial_values)&&void 0!==t?t:{}).length)return(0,d.jsx)(n.Loading,{is_fullscreen:!1,className:"account__initial-loader"});return(0,d.jsx)(m.Formik,{initialValues:null!==(i=null==T?void 0:T.form_initial_values)&&void 0!==i?i:{},onSubmit:async(e,t)=>{var i;let{setStatus:o,setSubmitting:n}=t;if(L(null==e||null===(i=e.document_type)||void 0===i?void 0:i.id))return void(null==v||v(!0));delete e.confirmation_checkbox,n(!0),o({error_msg:null});const{document_number:r,document_type:a}=e,l=(0,g.Di)(e,null!=T&&T.changeable_fields?[...T.changeable_fields]:[]),c=await s.WS.setSettings(l);if(c.error){var d;o({error_msg:(null===(d=c.error)||void 0===d?void 0:d.code)===j.DUPLICATE_ACCOUNT?Ot:zt}),n(!1)}else{const e=await s.WS.authorized.storage.getSettings();if(e.error)return A((t=>$i($i({},t),{},{api_error:e.error.message}))),void n(!1);const t={identity_verification_document_add:1,document_number:r,document_type:null==a?void 0:a.id,issuing_country:E.value};if(!t.document_type||L(t.document_type))return n(!1),void p();const i=await s.WS.send(t);if(null!=i&&i.error){var u,_,m;return o({error_msg:(null===(u=i.error)||void 0===u?void 0:u.code)===j.CLAIMED_DOCUMENT?wt:null!==(_=null==i||null===(m=i.error)||void 0===m?void 0:m.message)&&void 0!==_?_:zt}),void n(!1)}n(!1),p()}},validate:e=>{var t;const i={};if(I){const{document_type:t,document_number:o,document_additional:n}=e;if(L(null==t?void 0:t.id))return i;const r=!(null==t||!t.additional);i.document_type=(0,g.k4)(t),(0,g.DY)(null==t?void 0:t.id)||(r&&(i.document_additional=(0,g.dC)(t,n)),i.document_number=(0,g.Zy)(null!=o?o:"",t))}return(0,g.tf)(i,e)((e=>e),null!==(t=null==k?void 0:k.required_fields)&&void 0!==t?t:[],(0,l.localize)("This field is required")),e.first_name&&(i.first_name=(0,g.yS)(e.first_name)),e.last_name&&(i.last_name=(0,g.yS)(e.last_name)),e.confirmation_checkbox||(i.confirmation_checkbox="error"),A((e=>$i($i({},e),{},{errors:!(0,s.isEmptyObject)((0,s.removeEmptyPropertiesFromObject)(i))}))),(0,s.removeEmptyPropertiesFromObject)(i)},className:"proof-of-identity__container",children:e=>{var t,i,o,r,a;let{isSubmitting:s,isValid:u,dirty:_,status:f,values:p}=e;return(0,d.jsxs)(m.Form,{className:(0,O.A)("proof-of-identity__mismatch-container",{"upload-layout":I,"min-height":L(null==p||null===(t=p.document_type)||void 0===t?void 0:t.id)}),children:[(0,d.jsxs)(U,{className:"form-body",scroll_offset:S?"80px":c?"140px":"180px",children:[(0,d.jsx)(n.Text,{size:P?"xs":"s",weight:"bold",align:"center",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Your identity verification failed because:"})}),((null==f?void 0:f.error_msg)||(null==k?void 0:k.failure_message))&&(0,d.jsx)(n.HintBox,{className:(0,O.A)("proof-of-identity__failed-message","hint-box-layout"),icon:"IcAlertDanger",message:(0,d.jsx)(n.Text,{as:"p",size:P?"xxs":"xs","data-testid":h,children:null!==(i=null==f?void 0:f.error_msg)&&void 0!==i?i:null==k?void 0:k.failure_message}),is_danger:!0}),I&&(0,d.jsxs)("div",{children:[(0,d.jsx)(n.Text,{size:"xs",align:P?"left":"center",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Let’s try again. Choose another document and enter the corresponding details."})}),(0,d.jsx)(V.A,{title:(0,l.localize)("Identity verification")}),(0,d.jsx)(Mi.A,{selected_country:E,class_name:"idv-layout idv-resubmit"}),!L(null==p||null===(o=p.document_type)||void 0===o?void 0:o.id)&&(0,d.jsx)(V.A,{title:(0,l.localize)("Details")})]}),!L(null==p||null===(r=p.document_type)||void 0===r?void 0:r.id)&&(0,d.jsx)(oe.A,{class_name:"account-form__poi-confirm-example_container",editable_fields:p.confirmation_checkbox?[]:null==T?void 0:T.changeable_fields,is_rendered_for_idv:!0,side_note:null==k?void 0:k.side_note_image,inline_note_text:null==k?void 0:k.inline_note_text,mismatch_status:h})]}),(0,d.jsx)(B,{className:"proof-of-identity__footer",children:(0,d.jsx)(n.Button,{className:"proof-of-identity__submit-button",type:"submit",has_effect:!0,is_disabled:!_||s||!u,text:(b=L(null==p||null===(a=p.document_type)||void 0===a?void 0:a.id),b?(0,l.localize)("Next"):I?(0,l.localize)("Verify"):(0,l.localize)("Update profile")),large:!0,primary:!0})})]});var b}})},Hi=(0,r.observer)((e=>{let{allow_poi_resubmission:t,has_require_submission:i,height:n,identity_last_attempt:r,idv:l,is_from_external:c,is_idv_disallowed:u,needs_poa:_,onfido:m,onStateChange:f,redirect_button:p,residence_list:b,should_show_mismatch_form:h}=e;const{submission_service:y,setSubmissionService:x,submission_status:v,setSubmissionStatus:g,selected_country:j,setSelectedCountry:z}=o.useContext(s.POIContext),{client:O,notifications:w}=(0,a.A)(),{account_settings:P,getChangeableFields:S,account_status:k}=O,{refreshNotifications:N}=w,D="high"===k.risk_classification,C=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(Object.keys(j).length){const{submissions_left:t}=l,{submissions_left:i}=m,o=j.identity.services.idv.is_country_supported,n=j.identity.services.onfido.is_country_supported&&"ng"!==j.value;!e&&o&&Number(t)>0&&!u?x(Te):!e&&Number(i)>0&&n?x(Ae):x(Ie),g(De)}},T=()=>{f&&"function"==typeof f&&f(ke.pending),g(Ce),s.WS.authorized.getAccountStatus().then((()=>{N()}))},A=()=>g(Ne),I=o.useCallback((e=>b.find((t=>t.value===e))),[b]),E=i||t,F=(0,s.isIDVReportNotAvailable)(l),L=(0,s.formatIDVError)(l.last_rejected,l.status,D,F),R=o.useCallback((e=>{const{service:t,country_code:i}=e;switch(z(I(i)),t){case Te:case Ae:Number(l.submissions_left)>0||Number(m.submissions_left)>0?g(Ne):(x(Ie),g(De));break;case Ie:x(Ie),g(De)}}),[I,l.submissions_left,m.submissions_left,z,x,g,u]);switch(o.useEffect((()=>{v==Ne&&(E&&r?R(r):L&&[s.IDV_ERROR_STATUS.DobMismatch.code,s.IDV_ERROR_STATUS.NameMismatch.code,s.IDV_ERROR_STATUS.NameDobMismatch.code].includes(L)&&l.submissions_left>0?(x(Te),g(De)):g(Ne))}),[t,r,E,R,v,l,L,x,g]),v){case Ne:return(0,d.jsx)(Ri,{handleSelectionNext:C,is_from_external:c,mismatch_status:L});case De:switch(y){case Te:return h?(0,d.jsx)(Gi,{account_settings:P,getChangeableFields:S,mismatch_status:L,residence_list:b,handleSubmit:T,latest_status:r,selected_country:j,handleSelectionNext:C,report_available:!(null==l||!l.report_available)}):(0,d.jsx)(Vi,{handleSelectionNext:C,handleViewComplete:T,handleBack:A,selected_country:j});case Ae:{const e=j.value,t=j.identity.services.onfido.documents_supported,i=Object.keys(t).map((e=>t[e].display_name));return(0,d.jsx)(Et,{country_code:e,documents_supported:i,getChangeableFields:S,handleViewComplete:T,height:n})}case Ie:return(0,d.jsx)(Ti,{country_code:j.value,is_from_external:c,allow_poi_resubmission:t,handleViewComplete:T,onfido:m,handleBack:A,is_resubmission:E});default:return null}case Ce:switch(y){case Te:return(0,d.jsx)(We,{is_from_external:c,mismatch_status:L,needs_poa:_,redirect_button:p});case Ie:return(0,d.jsx)(tt,{is_from_external:c,needs_poa:_,redirect_button:p,is_manual_upload:!0});case Ae:return(0,d.jsx)(tt,{is_from_external:c,needs_poa:_,redirect_button:p});default:return null}default:return null}})),Qi=Hi,Zi=(0,r.observer)((e=>{let{height:t,is_from_external:i,onStateChange:r,getChangeableFields:c,updateAccountStatus:u}=e;const _=(0,h.useHistory)(),[m,f]=o.useState(),[p,b]=o.useState(!1),[y,x]=o.useState([]),[v,g]=o.useState(!0),{client:j,common:z,notifications:O}=(0,a.A)(),{account_settings:w,account_status:P,fetchResidenceList:S,is_switching:k,is_high_risk:N,is_withdrawal_lock:D,should_allow_authentication:C,is_virtual:T}=j,{app_routing_history:A,routeBackInApp:I,is_language_changing:E}=z,{refreshNotifications:F}=O,L=(0,s.getPlatformRedirect)(A),R=Object.keys(s.platforms).includes(null==L?void 0:L.ref),M=()=>b(!0),U=(null==w?void 0:w.citizen)||(null==w?void 0:w.country_code),Y=()=>{s.WS.authorized.getAccountStatus().then((()=>{F()}))},B=o.useCallback((()=>{S().then((e=>{e.error?f(e.error):x(e.residence_list)}))}),[S]);if(o.useEffect((()=>{E&&B()}),[E,B]),o.useEffect((()=>{k||(f(null),s.WS.authorized.getAccountStatus().then((e=>{if(e.error)return f(e.error),void g(!1);B(),g(!1)})))}),[B,k]),m)return(0,d.jsx)(Le,{error_message:(null==m?void 0:m.message)||m});if(v||k||(0,s.isEmptyObject)(P)||0===y.length)return(0,d.jsx)(n.Loading,{is_fullscreen:!1});if(T)return(0,d.jsx)(Fe,{});const V=ze(P),{identity:q,idv:$,allow_poi_resubmission:W,identity_last_attempt:G,identity_status:H,is_age_verified:Q,is_idv_disallowed:Z,manual:J,needs_poa:K,onfido:X,poi_expiring_soon:ee}=V,te=N&&D;if(!C&&!Q&&!ee)return(0,d.jsx)(Ke,{});const ie=R&&(0,d.jsx)(n.Button,{primary:!0,className:"proof-of-identity__redirect",onClick:()=>{const e=s.platforms[L.ref],{is_hard_redirect:t=!1,url:i=""}=null!=e?e:{};var o;t?(window.location.href=i,window.sessionStorage.removeItem("config.platform")):(o=L.route,I(_,[o]))},children:(0,d.jsx)(l.Localize,{i18n_default_text:"Back to {{platform_name}}",values:{platform_name:L.name}})}),oe=H!=ke.verified&&$.submissions_left>0&&[ke.rejected,ke.suspected,ke.expired].includes($.status);if(H===ke.none||p||W||oe||ee)return(0,d.jsx)(Qi,{account_settings:w,allow_poi_resubmission:W,has_require_submission:p,height:null!=t?t:null,getChangeableFields:c,identity_last_attempt:G,idv:$,is_from_external:!!i,is_idv_disallowed:Z||te,manual:J,needs_poa:K,onfido:X,onStateChange:r,redirect_button:ie,refreshNotifications:F,residence_list:y,updateAccountStatus:u,should_show_mismatch_form:oe});if(!G||H===ke.verified&&H!==(null==q?void 0:q.services[null==G?void 0:G.service].status))switch(H){case ke.pending:return(0,d.jsx)(tt,{is_from_external:!!i,needs_poa:K,redirect_button:ie,is_manual_upload:"pending"===(null==J?void 0:J.status)});case ke.verified:return(0,d.jsx)(nt,{is_from_external:!!i,needs_poa:K,redirect_button:ie,service:null==G?void 0:G.service});case ke.expired:return(0,d.jsx)(Re,{is_from_external:!!i,redirect_button:ie,handleRequireSubmission:M});case ke.rejected:case ke.suspected:return(0,d.jsx)(Je,{handleRequireSubmission:M})}switch(G.service){case Te:return(0,d.jsx)(Qe,{account_settings:w,handleRequireSubmission:M,getChangeableFields:c,idv:$,is_from_external:!!i,needs_poa:K,redirect_button:ie,residence_list:y});case Ae:return(0,d.jsx)(Ai,{handleRequireSubmission:M,is_from_external:!!i,needs_poa:K,onfido:X,manual:J,redirect_button:ie,country_code:U,handleViewComplete:Y});case Ie:return(0,d.jsx)(Ti,{manual:J,country_code:U,is_from_external:i,needs_poa:K,redirect_button:ie,handleRequireSubmission:M,handleViewComplete:Y,onfido:X});default:return null}})),Ji=Zi,Ki=(0,r.observer)((e=>{const[t,i]=o.useState(0),[r,l]=o.useState(""),c=t;let u=o.useRef(!0).current;const{client:_,notifications:m}=(0,a.A)(),{authentication_status:f,fetchStatesList:p}=_,{refreshNotifications:b}=m,h={body:Ji},y={body:Se},x=[...!["pending","verified"].includes(f.identity_status)?[h]:[],...!["pending","verified"].includes(f.document_status)?[y]:[]],[v,g]=o.useState(x);o.useEffect((()=>{b()}),[v,b]),o.useEffect((()=>{p()}),[p]);const j=()=>{u=!1,e.onFinish()},z=()=>{if(!u)return;const e=[...v];g(e)},O=()=>{l(""),t+1<v.length?(z(),i(t+1)):j()},w=(P="body")?v[c][P]:v[c];var P;return(0,d.jsx)(n.Div100vhContainer,{className:"proof-of-identity",id:"verification_modal_content",is_disabled:(0,s.isDesktop)(),height_offset:"40px",children:(0,d.jsx)("div",{className:"proof-of-identity__main-container","data-testid":"dt_verification_modal_body",children:(0,d.jsx)(w,{index:c,onSubmit:O,onStateChange:()=>{z(),O()},height:"auto",onCancel:()=>{t-1>=0?(i(t-1),l("")):j()},onSave:z,form_error:r})})})})),Xi=(0,r.observer)((()=>{const{ui:e,client:t}=(0,a.A)(),{authentication_status:i}=t,{is_verification_modal_visible:r,setIsVerificationModalVisible:s,setIsVerificationSubmitted:c}=e,u=!["pending","verified"].includes(i.identity_status),_=!["pending","verified"].includes(i.document_status);let m;return m=u&&_?(0,l.localize)("Submit your proof of identity and address"):u&&!_?(0,l.localize)("Submit your proof of identity"):(0,l.localize)("Submit your proof of address"),(0,d.jsxs)(o.Suspense,{fallback:(0,d.jsx)(n.UILoader,{}),children:[(0,d.jsx)(n.DesktopWrapper,{children:(0,d.jsx)(n.Modal,{className:"verification-modal",is_open:r,title:m,toggleModal:()=>s(!1),height:"70rem",width:"99.6rem",exit_classname:"verification-modal--custom-exit",children:(0,d.jsx)(Ki,{onFinish:()=>{s(!1),c(!0)}})})}),(0,d.jsx)(n.MobileWrapper,{children:(0,d.jsx)(n.MobileDialog,{portal_element_id:"deriv_app",title:m,wrapper_classname:"verification-modal",visible:r,onClose:()=>s(!1),children:(0,d.jsx)(Ki,{onFinish:()=>{s(!1),c(!0)}})})})]})}))},205007:(e,t,i)=>{i.d(t,{A:()=>l});var o=i(649524),n=i.n(o),r=i(189137),a=i(286326);const s=e=>`Unable to read file ${e}`,l=()=>{const[e,t]=(0,a.useState)(null),i=(0,a.useMemo)((()=>new(n())({connection:r.WS.getSocket()})),[]),o=(0,a.useCallback)((async(e,o,n)=>null!=e&&e.length?new Promise(((a,l)=>{let c=!1,d=null;(async()=>{try{const t=await(0,r.compressImageFiles)(e),_=await(0,r.readFiles)(t,s,null!=o?o:{});var u;if(_.forEach((e=>{e&&"message"in e&&(c=!0,d=e.message,l(e.message))})),c||!_.length)return null==n||n(),l(new Error(null!==(u=d)&&void 0!==u?u:"Something went wrong!"));const m=await i.upload(_[0]);a(m)}catch(e){t(e),l(e)}})()})):Promise.reject(new Error("No files selected"))),[i]);return{error:e,upload:o,uploader_instance:i}}},751506:(e,t,i)=>{i.d(t,{A:()=>l});var o=i(286326),n=i(108340);const r=["data","mutate"];function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function s(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const l=()=>{const e=(0,n.A)("notification_event"),{data:t,mutate:i}=e,l=function(e,t){if(null==e)return{};var i,o,n=function(e,t){if(null==e)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.includes(o))continue;i[o]=e[o]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)i=r[o],t.includes(i)||{}.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}(e,r),c=o.useCallback((e=>i({payload:e})),[i]);return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({notification_event:null==t?void 0:t.notification_event,send:c},l)}},809003:(e,t,i)=>{i.d(t,{A:()=>l});var o=i(773835);const n=["data"];function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function a(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function s(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const l=e=>{var t;const i=(0,o.A)("residence_list",{options:a({staleTime:1/0},e)}),{data:r}=i,s=function(e,t){if(null==e)return{};var i,o,n=function(e,t){if(null==e)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.includes(o))continue;i[o]=e[o]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)i=r[o],t.includes(i)||{}.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}(i,n);return a({data:null!==(t=null==r?void 0:r.residence_list)&&void 0!==t?t:[]},s)}},539943:(e,t,i)=>{i.d(t,{A:()=>s});var o=i(773835);const n=["data"];function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function a(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const s=e=>{const t=(0,o.A)("service_token",{payload:e,options:{retry:3,enabled:Boolean(e)}}),{data:i}=t,s=function(e,t){if(null==e)return{};var i,o,n=function(e,t){if(null==e)return{};var i={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.includes(o))continue;i[o]=e[o]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)i=r[o],t.includes(i)||{}.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}(t,n);return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({service_token:null==i?void 0:i.service_token},s)}}}]);
//# sourceMappingURL=core.verification-modal.c513ddb0f21d20ba3a08.js.map