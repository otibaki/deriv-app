import { j as s } from "../jsx-runtime-B6kdoens.js";
import { createContext as i, useEffect as a, useCallback as l } from "react";
import { getOAuthLogoutUrl as m, getOAuthOrigin as c } from "../constants/urls.js";
const u = i(void 0), w = ({ children: r, WSLogoutAndRedirect: t }) => {
  a(() => {
    const e = async (o) => {
      c() === o.origin ? o.data === "logout_complete" ? t() : console.warn("Unexpected message received: ", o.data) : console.warn("Unexpected postmessage origin: ", o.origin);
    };
    return window.addEventListener("message", e), () => window.removeEventListener("message", e);
  }, [t]);
  const n = {
    OAuth2Logout: l(async () => {
      let e = document.getElementById("logout-iframe");
      e || (e = document.createElement("iframe"), e.id = "logout-iframe", e.style.display = "none", document.body.appendChild(e), setTimeout(() => {
        t();
      }, 1e4)), e.src = m(), e.onerror = (o) => {
        console.error("There has been a problem with the logout: ", o);
      };
    }, [t])
  };
  return /* @__PURE__ */ s.jsx(u.Provider, { value: n, children: r });
};
export {
  u as OAuth2Context,
  w as OAuth2Provider
};
