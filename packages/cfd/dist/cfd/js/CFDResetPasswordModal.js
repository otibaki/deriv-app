!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("@deriv/components"),require("@deriv/shared"),require("@deriv/stores"),require("@deriv/translations"),require("formik"),require("react")):"function"==typeof define&&define.amd?define(["@deriv/components","@deriv/shared","@deriv/stores","@deriv/translations","formik","react"],r):"object"==typeof exports?exports["@deriv/cfd"]=r(require("@deriv/components"),require("@deriv/shared"),require("@deriv/stores"),require("@deriv/translations"),require("formik"),require("react")):e["@deriv/cfd"]=r(e["@deriv/components"],e["@deriv/shared"],e["@deriv/stores"],e["@deriv/translations"],e.formik,e.react)}(self,((e,r,t,o,s,n)=>(()=>{"use strict";var a,i={"./src/Containers/cfd-reset-password-modal.tsx":(e,r,t)=>{t.d(r,{default:()=>E});var o=t("formik"),s=t("react"),n=t.n(s),a=t("@deriv/components"),i=t("@deriv/shared"),l=t("@deriv/translations"),c=t("./src/Stores/Modules/CFD/Helpers/cfd-config.ts"),d=t("@deriv/stores"),u=t("./src/Stores/Modules/CFD/Helpers/useCfdStores.tsx"),p=t("./src/Helpers/cfd-config.ts");function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}var _=["current_list","children","is_eu"];function m(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function v(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?m(Object(t),!0).forEach((function(r){w(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function w(e,r,t){return(r=function(e){var r=function(e,r){if("object"!=f(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,r||"default");if("object"!=f(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==f(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function g(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,s,n,a,i=[],l=!0,c=!1;try{if(n=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;l=!1}else for(;!(l=(o=n.call(t)).done)&&(i.push(o.value),i.length!==r);l=!0);}catch(e){c=!0,s=e}finally{try{if(!l&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw s}}return i}}(e,r)||function(e,r){if(e){if("string"==typeof e)return b(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?b(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,o=Array(r);t<r;t++)o[t]=e[t];return o}var y=function(e){var r,t,o,s,n,a=e.current_list,i=e.children,l=e.is_eu,d=function(e,r){if(null==e)return{};var t,o,s=function(e,r){if(null==e)return{};var t={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(r.includes(o))continue;t[o]=e[o]}return t}(e,r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)t=n[o],r.includes(t)||{}.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}(e,_),u=localStorage.getItem("cfd_reset_password_intent"),p=localStorage.getItem("cfd_reset_password_type")||"main";if(u&&/(real|demo)\.(gold_dml|gold_bvi|gold_v|gold|financial|financial_demo|financial_stp|financial_svg|financial_bvi|financial_fx|financial_v|synthetic|synthetic_svg|synthetic_bvi|synthetic_v|all_swap_free_svg|all_zero_spread_bvi|dxtrade|all)/.test(u)&&a){var f,m,w=g(u.split("."),3);n=w[0],r=w[1],t=w[2],o=a["mt5.".concat(r,".").concat(t,"@").concat(n)].login,s=null!==(f=null===(m=(0,c.bN)(l)[r][t])||void 0===m?void 0:m.title)&&void 0!==f?f:""}else if(a){var b,y,h,E,O,x,S=g(Object.keys(a).pop().split("."),3);n=S[0],r=S[1],t=S[2],o=null!==(b=null===(y=a["mt5.".concat(r,".").concat(t,"@").concat(n)])||void 0===y?void 0:y.login)&&void 0!==b?b:"",s=null!==(h=null===(E=(0,c.bN)(l))||void 0===E||null===(O=E[r])||void 0===O||null===(x=O[t])||void 0===x?void 0:x.title)&&void 0!==h?h:""}else o="",s="";return i(v({login:o,title:s,type:p},d))},h=(0,d.observer)((function(e){var r=e.platform,t=(0,d.useStore)(),s=t.client,c=t.ui,f=s.email,_=s.is_eu,m=s.is_logged_in,w=c.is_cfd_reset_password_modal_enabled,b=c.setCFDPasswordResetModal,h=(0,u.E)().current_list;n().useEffect((function(){/reset-password/.test(location.hash)&&b(!0)}),[b]);var E=g(n().useState({error_code:void 0,has_error:!1,error_message:void 0,is_finished:!1,changed_password_type:""}),2),O=E[0],x=E[1],S=function(){localStorage.removeItem("cfd_reset_password_intent"),localStorage.removeItem("cfd_reset_password_type"),localStorage.removeItem("cfd_reset_password_code")},j=function(e){var t={},o=r===p.$_.DXTRADE?25:16;return(0,i.validLength)(e.new_password,{min:8,max:o})?(0,i.validPassword)(e.new_password)?r===p.$_.DXTRADE||(0,i.validMT5Password)(e.new_password)||(t.new_password=(0,l.localize)("Please include at least 1 special character such as ( _ @ ? ! / # ) in your password.")):t.new_password=(0,i.getErrorMessages)().password():t.new_password=(0,l.localize)("You should enter {{min_number}}-{{max_number}} characters.",{min_number:8,max_number:o}),e.new_password.toLowerCase()===f.toLowerCase()&&(t.new_password=(0,l.localize)("Your password cannot be the same as your email address.")),t},P=function(e,r,t,o){var s=o.setSubmitting;s(!0);var n={account_id:t,platform:p.$_.MT5,new_password:e.new_password,verification_code:localStorage.getItem("cfd_reset_password_code")};i.WS.tradingPlatformInvestorPasswordReset(n).then((function(e){var t,o;null!=e&&null!==(t=e.error)&&void 0!==t&&t.code?(o=e.error,x(v(v({},O),{},{error_code:o.code,has_error:!0,error_message:o.message}))):(x(v(v({},O),{},{is_finished:!0,changed_password_type:r})),S()),s(!1)}))},k=function(){return 0!==Object.keys(h).length},z=!k()&&localStorage.getItem("cfd_reset_password_code");return n().createElement(a.Modal,{className:"cfd-reset-password-modal",is_open:w&&!z,toggleModal:function(){return b(!1)},title:r===p.$_.DXTRADE?(0,l.localize)("Reset Deriv X investor password"):(0,l.localize)("Reset Deriv MT5 investor password"),onMount:function(){return(0,i.redirectToLogin)(m,(0,l.getLanguage)(),!0)},should_header_stick_body:!1},!k()&&!O.has_error&&n().createElement(a.Loading,{is_fullscreen:!1}),k()&&!O.has_error&&!O.is_finished&&n().createElement(y,{current_list:h,is_eu:_},(function(e){var t=e.type,s=e.login;return n().createElement(o.Formik,{initialValues:{new_password:""},validate:j,onSubmit:function(e,r){return P(e,t,s,r)}},(function(e){var o=e.handleSubmit,s=e.errors,c=e.values,d=e.isSubmitting,u=e.handleChange,f=e.handleBlur,_=e.touched;return n().createElement("form",{autoComplete:"off",onSubmit:o},n().createElement("div",{className:"cfd-reset-password"},n().createElement("div",{className:"cfd-reset-password__container"},n().createElement("div",{className:"cfd-reset-password__password-area"},n().createElement(a.PasswordMeter,{input:c.new_password,has_error:!(!_.new_password||!s.new_password),custom_feedback_messages:(0,i.getErrorMessages)().password_warnings},(function(e){var r=e.has_warning;return n().createElement(a.PasswordInput,{autoComplete:"new-password",className:"cfd-reset-password__password-field",name:"new_password",label:(0,l.localize)("New {{type}} password",{type:t}),onChange:u,onBlur:f,error:_.new_password&&s.new_password,value:c.new_password,"data-lpignore":"true",required:!0,hint:!r&&(0,l.localize)("Strong passwords contain at least 8 characters, combine uppercase and lowercase letters, numbers, and symbols.")})}))),r!==p.$_.DXTRADE&&n().createElement("div",{className:"cfd-reset-password__password-area"},n().createElement(a.Text,{as:"p",size:"xs",align:"center",className:"cfd-reset-password__description2"},n().createElement(l.Localize,{i18n_default_text:"Your password must contain between 8-16 characters that include uppercase and lowercase letters, and at least one number and special character ( _ @ ? ! / # )."}))),d&&n().createElement(a.Loading,{is_fullscreen:!1}),!d&&n().createElement(a.FormSubmitButton,{is_disabled:d||!c.new_password||Object.keys(s).length>0,errors:s,is_center:!0,large:!0,label:(0,l.localize)("Create {{type}} password",{type:t})}))))}))})),O.has_error&&n().createElement("div",{className:"cfd-reset-password__error"},n().createElement(a.Icon,{icon:"IcMt5Expired",size:128}),n().createElement(a.Text,{as:"p",size:"xs",weight:"bold",align:"center",className:"cfd-reset-password__heading"},O.error_message),"InvalidToken"===O.error_code&&n().createElement(a.Text,{as:"p",color:"prominent",size:"xs",align:"center",className:"cfd-reset-password__description--is-centered"},n().createElement(l.Localize,{i18n_default_text:"Please request a new password and check your email for the new token."})),n().createElement(a.Button,{primary:!0,large:!0,className:"cfd-reset-password__confirm-button",onClick:function(){S(),b(!1)}},n().createElement(l.Localize,{i18n_default_text:"Ok"}))),O.is_finished&&n().createElement("div",{className:"cfd-reset-password__success"},n().createElement(a.Icon,{icon:"IcMt5PasswordUpdated",size:128}),n().createElement("div",{className:"cfd-reset-password__description"},n().createElement(a.Text,{as:"p",size:"xs",align:"center",weight:"bold",line_height:"xxl"},n().createElement(l.Localize,{i18n_default_text:"Password saved"})),n().createElement(l.Localize,{i18n_default_text:"Your {{account_type}} password has been changed.",values:{account_type:"main"===O.changed_password_type?(0,l.localize)("main"):(0,l.localize)("investor")}})),n().createElement(a.Button,{primary:!0,large:!0,onClick:function(){return b(!1)}},n().createElement(l.Localize,{i18n_default_text:"Ok"}))))}));const E=n().memo(h)},"@deriv/components":r=>{r.exports=e},"@deriv/shared":e=>{e.exports=r},"@deriv/stores":e=>{e.exports=t},"@deriv/translations":e=>{e.exports=o},formik:e=>{e.exports=s},react:e=>{e.exports=n}},l={};function c(e){var r=l[e];if(void 0!==r)return r.exports;var t=l[e]={exports:{}};return i[e](t,t.exports,c),t.exports}c.m=i,a=[],c.O=(e,r,t,o)=>{if(!r){var s=1/0;for(d=0;d<a.length;d++){for(var[r,t,o]=a[d],n=!0,i=0;i<r.length;i++)(!1&o||s>=o)&&Object.keys(c.O).every((e=>c.O[e](r[i])))?r.splice(i--,1):(n=!1,o<s&&(s=o));if(n){a.splice(d--,1);var l=t();void 0!==l&&(e=l)}}return e}o=o||0;for(var d=a.length;d>0&&a[d-1][2]>o;d--)a[d]=a[d-1];a[d]=[r,t,o]},c.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return c.d(r,{a:r}),r},c.d=(e,r)=>{for(var t in r)c.o(r,t)&&!c.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},c.e=()=>Promise.resolve(),c.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),c.j="CFDResetPasswordModal",(()=>{var e={CFDResetPasswordModal:0};c.O.j=r=>0===e[r];var r=(r,t)=>{var o,s,[n,a,i]=t,l=0;if(n.some((r=>0!==e[r]))){for(o in a)c.o(a,o)&&(c.m[o]=a[o]);if(i)var d=i(c)}for(r&&r(t);l<n.length;l++)s=n[l],c.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return c.O(d)},t=self.webpackChunk_deriv_cfd=self.webpackChunk_deriv_cfd||[];t.forEach(r.bind(null,0)),t.push=r.bind(null,t.push.bind(t))})();var d=c.O(void 0,["internalCFDStoreUsage","utilities"],(()=>c("./src/Containers/cfd-reset-password-modal.tsx")));return d=(d=c.O(d)).default})()));
//# sourceMappingURL=CFDResetPasswordModal.js.map