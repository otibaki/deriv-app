"use strict";(self.webpackChunk_deriv_trader=self.webpackChunk_deriv_trader||[]).push([["contract","error-component"],{"./src/App/Components/Elements/Errors/index.ts":(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var a=r("react"),n=r.n(a),o=r("@deriv/components"),c=r("@deriv/shared"),i=r("@deriv/translations");const l=function(e){var t=e.header,r=e.message,a=e.is_dialog,l=e.redirect_label,s=e.redirectOnClick,u=e.should_show_refresh,d=void 0===u||u?(0,i.localize)("Please refresh this page to continue."):"";return a?n().createElement(o.Dialog,{title:t||(0,i.localize)("There was an error"),is_visible:!0,confirm_button_text:l||(0,i.localize)("Ok"),onConfirm:s||function(){return location.reload()}},r||(0,i.localize)("Sorry, an error occurred while processing your request.")):n().createElement(o.PageErrorContainer,{error_header:null!=t?t:"",error_messages:r?[r,d]:[],redirect_urls:[c.routes.trade],redirect_labels:[l||(0,i.localize)("Refresh")],buttonOnClick:s||function(){return location.reload()}})}},"./src/Modules/Contract/Containers/contract-replay-widget.tsx":(e,t,r)=>{r.d(t,{dO:()=>x,fy:()=>k,$i:()=>E,WN:()=>C});var a=r("react"),n=r.n(a),o=r("./src/Modules/Contract/Components/Digits/index.ts"),c=r("./src/App/Components/Animations/index.ts"),i=r("../../node_modules/classnames/index.js"),l=r.n(i),s=r("@deriv/components"),u=r("@deriv/translations"),d=r("@deriv/shared"),m=r("mobx-react-lite"),_=r("../stores/src/useStore.ts");function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,o,c,i=[],l=!0,s=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=o.call(r)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,n=e}finally{try{if(!l&&null!=r.return&&(c=r.return(),Object(c)!==c))return}finally{if(s)throw n}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}const b=(0,m.observer)((function(e){var t=e.contract_info,r=(0,_.A)().ui.is_mobile,a=r?47:150,o=p(n().useState(!0),2),c=o[0],i=o[1],m=function(e){e?(e.preventDefault(),("keydown"!==e.type||"keydown"===e.type&&"Enter"===e.key)&&i(!c)):i(!c)};return n().createElement("div",{className:"info-box-longcode"},n().createElement(s.Icon,{icon:"IcContractFlag",className:"info-box-longcode-icon",size:24}),n().createElement("div",{className:"info-box-longcode-wrapper",onClick:r?m:void 0,onKeyDown:m},n().createElement(s.Text,{size:"xs",className:l()("info-box-longcode-text",{"info-box-longcode-text--collapsed":c||r,"info-box-longcode-text--collapsed--fixed-height":!d.isTabletOs&&(c||r)})},t.longcode)," ",(null==t?void 0:t.longcode)&&t.longcode.length>a&&n().createElement(s.Text,{as:"a",href:"#",size:"xs",onClick:m,className:"info-box-longcode-text"},c||r?n().createElement(u.Localize,{i18n_default_text:"View more"}):n().createElement(u.Localize,{i18n_default_text:"View less"}))),n().createElement(s.Modal,{className:"info-box-longcode--modal",is_open:r&&!c,title:n().createElement(u.Localize,{i18n_default_text:"Trade info"}),has_close_icon:!1,should_close_on_click_outside:!0,small:!0,toggleModal:m},n().createElement(s.Modal.Body,null,n().createElement(s.Text,{size:"xs"},t.longcode)),n().createElement(s.Modal.Footer,null,n().createElement(s.Button,{className:"info-box-longcode--modal-button",primary:!0,large:!0,onClick:m},n().createElement(u.Localize,{i18n_default_text:"OK"})))))}));const v=function(e){var t=e.message,r=void 0===t?"":t,a=e.onClickClose;return r?n().createElement("div",{className:"message"},n().createElement("div",{className:"message-icon"},n().createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16"},n().createElement("g",{fill:"none",fillRule:"evenodd"},n().createElement("circle",{cx:"8",cy:"8",r:"8",fill:"#F44336"}),n().createElement("path",{fill:"#FFF",fillRule:"nonzero",d:"M8 7.293l3.146-3.147a.5.5 0 0 1 .708.708L8.707 8l3.147 3.146a.5.5 0 0 1-.708.708L8 8.707l-3.146 3.147a.5.5 0 0 1-.708-.708L7.293 8 4.146 4.854a.5.5 0 1 1 .708-.708L8 7.293z"})))),n().createElement("div",{className:"message-text"},r),n().createElement("div",{className:"message-close",onClick:a},n().createElement(s.Icon,{icon:"IcCross"}))):null};const y=function(e){var t=e.contract_info,r=e.error_message,a=e.removeError,o=!!t.longcode;return n().createElement(c.F,{is_visible:o,className:"info-box-container",keyname:"info-box-container"},!!t.contract_type&&n().createElement("div",{className:"info-box"},n().createElement(b,{contract_info:t})),n().createElement(v,{message:r,onClickClose:a}))};var g=r("./src/Modules/SmartChart/Components/bottom-widgets.tsx"),h=r("./src/Modules/SmartChart/Components/top-widgets.tsx"),E=(0,m.observer)((function(){var e=(0,_.A)(),t=e.contract_replay,r=e.ui.is_mobile,a=t.contract_store,c=a.contract_info,i=a.digits_info,l=a.display_status,s=a.is_digit_contract,u=a.is_ended;return n().createElement(o.A,{is_digit_contract:s,is_ended:u,is_mobile:r,contract_info:c,digits_info:i,display_status:l})})),C=(0,m.observer)((function(){var e=(0,_.A)().contract_replay,t=e.contract_store,r=e.removeErrorMessage,a=e.error_message,o=t.contract_info;return n().createElement(y,{contract_info:o,error_message:a,removeError:r})})),k=function(){return n().createElement(h.A,{InfoBox:n().createElement(C,null),is_title_enabled:!1})},x=function(){return n().createElement(g.A,{Widget:n().createElement(E,null)})}},"./src/Modules/Contract/Containers/replay-chart.tsx":(e,t,r)=>{r.d(t,{A:()=>b});var a=r("react"),n=r.n(a),o=r("@deriv/components"),c=r("@deriv/shared"),i=r("mobx-react-lite"),l=r("../stores/src/useStore.ts"),s=r("./src/Stores/useTraderStores.tsx"),u=r("./src/Modules/Contract/Containers/contract-replay-widget.tsx"),d=r("./src/Modules/SmartChart/Components/Markers/marker.tsx"),m=function(e){var t=e.contract_info,r=null!=t?t:{},a=r.contract_type,o=r.entry_spot,c=r.reset_time,i=r.reset_barrier,l=/CALL/i.test(null!=a?a:""),s=Math.max(Number(o),Number(i));return l&&(s=Math.min(Number(o),Number(i))),n().createElement(n().Fragment,null,n().createElement(d.A,{is_positioned_behind:!0,marker_config:{ContentComponent:"div",x:Number(c),y:s},marker_content_props:{className:"sc-barrier_gradient sc-barrier_gradient--".concat(l?"to-bottom":"to-top")}}),n().createElement(d.A,{is_positioned_behind:!0,marker_config:{ContentComponent:"div",x:Number(c),y:Number(i)},marker_content_props:{className:"sc-reset_barrier"}}))};const _=n().memo(m);var p=r("./src/Modules/SmartChart/index.js"),f=r("../../node_modules/@deriv-com/ui/dist/hooks/useDevice.js");const b=(0,i.observer)((function(e){var t,r=e.is_dark_theme_prop,a=e.is_accumulator_contract,i=e.is_reset_contract,m=e.is_vertical_scroll_disabled,b=(0,s.P)(),v=(0,l.A)(),y=v.contract_replay,g=v.common,h=v.ui,E=(0,f.Y)().isMobile,C=y.contract_store,k=y.chart_state,x=y.chartStateChange,w=y.margin,S=C.contract_config,N=C.is_digit_contract,T=C.barriers_array,A=C.getContractsArray,z=C.markers_array,I=C.contract_info,O=I.underlying,M=I.audit_details,D=I.barrier_count,L="READY"===k||"SCROLL_TO_LEFT"===k,j=g.app_routing_history,F=g.current_language,P=g.is_socket_opened,H=h.is_chart_layout_default,R=h.is_chart_countdown_visible,B=S||{},U=B.end_epoch,W=B.chart_type,q=B.start_epoch,Y=B.granularity,V=r||h.is_dark_mode_on,G=!(null==I||!I.is_forward_starting||(0,c.hasContractStarted)(I)||!I.is_sold),$="DBot"===(0,c.getPlatformRedirect)(j).name,K={language:F,theme:V&&!$?"dark":"light",position:H?"bottom":"left",countdown:R,assetInformation:!1,isHighestLowestMarkerEnabled:!1},Q=L&&S?S.scroll_to_epoch:void 0,X=M?M.all_ticks:[],J=b.wsForget,Z=b.wsSubscribe,ee=b.wsSendRequest,te=b.wsForgetStream,re=function(){return!E&&N},ae=(0,o.usePrevious)(q),ne=!!(0,c.getEndTime)(I),oe=(0,c.isDtraderV2DesktopEnabled)(h.is_desktop)||(0,c.isDtraderV2MobileEnabled)(h.is_mobile);return n().createElement(p.GR,{id:"replay",barriers:T,bottomWidgets:re()?u.dO:void 0,chartControlsWidgets:null,chartType:W,endEpoch:U,margin:w,isMobile:E,enabledNavigationWidget:!E,enabledChartFooter:!1,granularity:Y,requestAPI:ee,requestForget:J,requestForgetStream:te,crosshair:E?0:void 0,maxTick:E?8:void 0,requestSubscribe:Z,settings:K,startEpoch:G?I.purchase_time:q,scrollToEpoch:Q,stateChangeListener:x,symbol:O,allTicks:X,topWidgets:oe?function(){return n().createElement(n().Fragment,null)}:u.fy,isConnectionOpened:P,isStaticChart:!!a&&!!U&&Number(q)<Number(ae),shouldFetchTradingTimes:!1,should_zoom_out_on_yaxis:a,yAxisMargin:(t={top:E?96:148,bottom:re()?128:112},E&&(t.bottom=48,t.top=48),t),anchorChartToLeft:E,shouldFetchTickHistory:"seconds"!==(0,c.getDurationUnitText)((0,c.getDurationPeriod)(I))||"open"===I.status,shouldDrawTicksFromContractInfo:a,contractInfo:I,contracts_array:A(),isLive:!ne,isVerticalScrollEnabled:!m,startWithDataFitMode:!0},z.map((function(e){var t=e.content_config,r=e.marker_config,a=e.react_key,o=e.type;return n().createElement(d.A,{key:a,marker_config:r,marker_content_props:t,is_positioned_before:("SPOT_ENTRY"===o||"SPOT_EXIT"===o)&&2===D})})),i&&(null==I?void 0:I.reset_time)&&n().createElement(_,{contract_info:I}))}))},"./src/Modules/Contract/index.ts":(e,t,r)=>{r.r(t),r.d(t,{default:()=>re});var a=r("react"),n=r.n(a),o=r("react-router"),c=r("../../node_modules/react-transition-group/esm/CSSTransition.js"),i=r("@deriv/shared"),l=r("./src/App/Components/Elements/Errors/index.ts"),s=r("@deriv/translations"),u=r("../../node_modules/classnames/index.js"),d=r.n(u),m=r("react-router-dom"),_=r("@deriv/components"),p=r("../stores/src/useStore.ts");function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=f(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=f(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==f(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const g=function(){var e=(0,p.A)().feature_flags;return(0,a.useMemo)((function(){var t,r=null!==(t=e.data)&&void 0!==t?t:{};return Object.keys(r).reduce((function(e,t){return v(v({},e),{},y({},"is_".concat(t,"_enabled"),Boolean(r[t])))}),{})}),[e.data])};var h=r("../../node_modules/@deriv-com/ui/dist/hooks/useDevice.js"),E=r("./src/App/Components/Elements/chart-loader.tsx"),C=r("@deriv-com/analytics"),k=r("./src/App/Components/Elements/PositionsDrawer/helpers/index.ts");const x=function(e){var t=e.additional_info,r=e.icon,a=e.id,o=e.label,c=e.timestamp,l=e.value,s=e.value2;return n().createElement("div",{id:a,className:"contract-audit__grid","data-testid":a},r&&n().createElement("div",{className:"contract-audit__icon"},r),n().createElement("div",{className:"contract-audit__item"},n().createElement(_.Text,{size:"xxxs",styles:{lineHeight:"unset"},className:"contract-audit__label"},o),n().createElement("div",{className:"contract-audit__value-wrapper"},n().createElement(_.Text,{weight:"bold",size:"xxs",line_height:"m",color:"prominent",className:"contract-audit__value"},l),s&&n().createElement(_.Text,{weight:"bold",size:"xxs",line_height:"m",color:"prominent",className:"contract-audit__value2"},s),t&&n().createElement(_.Text,{size:"xxxs",line_height:"s",color:"less-prominent",className:"contract-audit__timestamp-value"},t))),c&&n().createElement("div",{className:"contract-audit__timestamp"},n().createElement(_.Text,{size:"xxxs",align:"right",line_height:"xs",className:"contract-audit__timestamp-value"},(0,i.formatDate)(c)),n().createElement(_.Text,{size:"xxxs",align:"right",line_height:"xs",className:"contract-audit__timestamp-value"},(0,i.formatTime)(c))))};var w=r("./src/Stores/Modules/Trading/Helpers/logic.ts");const S=function(e){var t=e.contract_end_time,r=e.contract_info,a=e.duration,o=e.duration_unit,c=e.exit_spot,l=e.is_vanilla,u=r.barrier,m=r.commission,p=r.contract_type,f=r.currency,b=r.date_start,v=r.display_number_of_contracts,y=r.entry_spot_display_value,g=r.entry_tick_time,E=r.exit_tick_time,S=r.high_barrier,N=r.is_sold,T=r.low_barrier,A=r.profit,z=r.selected_tick,I=r.status,O=r.tick_count,M=r.tick_passed,D=r.transaction_ids,L=void 0===D?{}:D,j=L.buy,F=L.sell,P=r.reset_barrier,H=r.reset_time,R=r.underlying,B=(0,h.Y)().isMobile,U=Number(A)>=0,W=(0,i.getCancellationPrice)(r),q=!l&&!(0,i.isAccumulatorContract)(p)&&!(0,i.isSmartTraderContract)(p),Y=!(0,i.isAccumulatorContract)(p)||!isNaN(Number(t)),V=(0,i.isTurbosContract)(p)||l,G=Number(O)<2?(0,s.localize)("tick"):(0,s.localize)("ticks"),$=l||(0,i.isAsiansContract)(p)||(0,i.isResetContract)(p),K=(0,i.isAccumulatorContract)(p)?"".concat(M,"/").concat(O," ").concat((0,s.localize)("ticks")):"".concat(O," ").concat(G),Q=(0,i.isResetContract)(p)?n().createElement(s.Localize,{i18n_default_text:"The reset time is {{ reset_time }}",values:{reset_time:Number(O)>0?"".concat(Math.floor(Number(O)/2)," ").concat(G):(0,i.formatResetDuration)(r)}}):"",X=function(e){var t=N?n().createElement(s.Localize,{i18n_default_text:"Low spot"}):n().createElement(s.Localize,{i18n_default_text:"Indicative low spot"}),r=N?n().createElement(s.Localize,{i18n_default_text:"High spot"}):n().createElement(s.Localize,{i18n_default_text:"Indicative high spot"});return{label:"L"===e?t:r,icon:n().createElement("div",{className:"lookbacks-marker__wrapper"},n().createElement(_.Text,{color:"colored-background",size:"xxxs",className:"lookbacks-marker__asset"},e))}},J=X(p===i.CONTRACT_TYPES.LB_PUT?"H":"L"),Z=(0,i.isVanillaFxContract)(p,R)?(0,i.getLocalizedBasis)().payout_per_pip:(0,i.getLocalizedBasis)().payout_per_point;return n().useEffect((function(){C.Analytics.trackEvent("ce_reports_form",{action:"open_contract_details",form_name:"default",form_source:"deriv_trader"})}),[]),n().createElement(_.ThemedScrollbars,{is_bypassed:B},n().createElement("div",{className:"contract-audit__tabs-content"},n().createElement(x,{id:"dt_id_label",icon:n().createElement(_.Icon,{icon:"IcContractId",size:24}),label:(0,s.localize)("Reference ID"),value:(0,s.localize)("{{buy_value}} (Buy)",{buy_value:j}),value2:F?(0,s.localize)("{{sell_value}} (Sell)",{sell_value:F}):void 0}),(0,i.isMultiplierContract)(p)?n().createElement(n().Fragment,null,n().createElement(x,{id:"dt_commission_label",icon:n().createElement(_.Icon,{icon:"IcContractCommission",size:24}),label:(0,s.localize)("Commission"),value:n().createElement(_.Money,{amount:null!=m?m:"",currency:f,show_currency:!0})}),!!W&&n().createElement(x,{id:"dt_cancellation_label",icon:n().createElement(_.Icon,{icon:"IcContractSafeguard",size:24}),label:(0,i.isUserSold)(r)&&(0,i.isEndedBeforeCancellationExpired)(r)?(0,s.localize)("Deal cancellation"):(0,i.isUserCancelled)(r)?(0,s.localize)("Deal cancellation (executed)"):(0,w.d)(r)?(0,s.localize)("Deal cancellation (expired)"):(0,s.localize)("Deal cancellation (active)"),value:n().createElement(_.Money,{amount:W,currency:f})})):n().createElement(n().Fragment,null,Y&&n().createElement(x,{id:"dt_duration_label",icon:n().createElement(_.Icon,{icon:"IcContractDuration",size:24}),label:(0,s.localize)("Duration"),value:Number(O)>0?K:"".concat(a," ").concat(o),additional_info:Q}),$&&n().createElement(n().Fragment,null,n().createElement(x,{id:"dt_bt_label",icon:n().createElement(_.Icon,{icon:"IcContractStrike",size:24}),label:(0,k.iQ)(r),value:((0,i.isResetContract)(p)?(0,i.addComma)(y):(0,k.Vb)(r))||" - "}),H&&n().createElement(n().Fragment,null,n().createElement(x,{id:"dt_reset_barrier_label",icon:n().createElement(_.Icon,{icon:"IcContractResetBarrier",size:24}),label:(0,s.localize)("Reset barrier"),value:P?(0,i.addComma)(P):" - "}),n().createElement(x,{id:"dt_reset_time_label",icon:n().createElement(_.Icon,{icon:"IcContractResetTime",size:24}),label:(0,s.localize)("Reset time"),value:(0,i.toGMTFormat)((0,i.epochToMoment)(H))}))),q&&n().createElement(x,{id:"dt_bt_label",icon:(0,k.km)(p)?n().createElement(_.Icon,{icon:"IcContractTarget",size:24}):n().createElement(_.Icon,{icon:"IcContractBarrier",size:24}),label:(0,k.iQ)(r),value:(0,k.Vb)(r)||" - "}),(0,i.hasTwoBarriers)(p)&&n().createElement(n().Fragment,null,[S,T].map((function(e,t){return n().createElement(x,{id:"dt_bt_label_".concat(t+1),icon:n().createElement(_.Icon,{icon:"IcContractStrike",size:24}),key:e,label:S===e?(0,s.localize)("High barrier"):(0,s.localize)("Low barrier"),value:e})}))),V&&n().createElement(x,{id:"dt_bt_label",icon:n().createElement(_.Icon,{icon:"IcContractPayout",size:24}),label:Z,value:v?"".concat(v," ").concat((0,i.getCurrencyDisplayCode)(f)):" - "})),(0,i.isTicksContract)(p)&&n().createElement(x,{id:"dt_entry_spot_label",icon:n().createElement("div",{className:"contract-audit__selected-tick"},n().createElement("div",{className:d()("contract-audit__selected-tick--marker","contract-audit__selected-tick--marker--".concat(I))},z)),label:(0,s.localize)("Selected tick"),value:u||"----"}),n().createElement(x,{id:"dt_start_time_label",icon:n().createElement(_.Icon,{icon:"IcContractStartTime",size:24}),label:(0,s.localize)("Start time"),value:(0,i.toGMTFormat)((0,i.epochToMoment)(Number(b)))||" - "}),(0,i.isLookBacksContract)(p)&&n().createElement(n().Fragment,null,p===i.CONTRACT_TYPES.LB_HIGH_LOW?n().createElement(n().Fragment,null,[S,T].map((function(e,t){var r=X(0===t?"H":"L");return n().createElement(x,{id:"dt_bt_label_".concat(t+1),icon:r.icon,key:e,label:r.label,value:e})}))):n().createElement(x,{id:"dt_indicative_high_spot",icon:J.icon,label:J.label,value:null==r?void 0:r.barrier})),!(0,k.km)(p)&&n().createElement(x,{id:"dt_entry_spot_label",icon:n().createElement(_.Icon,{icon:"IcContractEntrySpot",size:24}),label:(0,s.localize)("Entry spot"),value:y?(0,i.addComma)(y):" - ",value2:g?(0,i.toGMTFormat)((0,i.epochToMoment)(g)):" - ",additional_info:(0,i.isTicksContract)(p)&&(0,s.localize)("The entry spot is the first tick for High/Low Ticks.")}),!isNaN(Number(c))&&n().createElement(x,{id:"dt_exit_spot_label",icon:n().createElement(_.Icon,{icon:"IcContractExitSpot",size:24}),label:(0,s.localize)("Exit spot"),value:c?(0,i.addComma)(c):" - ",value2:(0,i.toGMTFormat)((0,i.epochToMoment)(Number(E)))||" - "}),!isNaN(Number(t))&&n().createElement(x,{id:"dt_exit_time_label",icon:n().createElement(_.Icon,{icon:"IcContractExitTime",color:U?"green":"red",size:24}),label:(0,s.localize)("Exit time"),value:(0,i.toGMTFormat)((0,i.epochToMoment)(Number(t)))||" - "})))};const N=function(e){var t=e.currency,r=e.history,a=void 0===r?[]:r;return a.length?n().createElement(_.ThemedScrollbars,{is_bypassed:(0,i.isMobile)()},n().createElement("div",{className:"contract-audit__tabs-content"},a.map((function(e,r){return n().createElement(x,{key:"".concat(r,"-").concat(e.order_date),id:"dt_history_label_".concat(r),label:e.display_name,timestamp:Number(null==e?void 0:e.order_date),value:0!==Math.abs(Number(e.order_amount))?n().createElement(n().Fragment,null,Number(e.order_amount)<0&&n().createElement("strong",null,"-"),n().createElement(_.Money,{amount:e.order_amount,currency:t}),e.value&&n().createElement(n().Fragment,null,n().createElement("br",null),n().createElement("span",null,"(",e.value,")"))):(0,s.localize)("Cancelled")})})))):n().createElement("div",{className:"contract-audit__empty"},n().createElement(_.Icon,{icon:"IcBox",size:48,color:"secondary"}),n().createElement("h4",{className:"contract-audit__empty-header"},(0,s.localize)("No history")),n().createElement(_.Text,{align:"center",line_height:"s",color:"less-prominent",size:"xxs"},(0,s.localize)("You have yet to update either take profit or stop loss")))};var T=["contract_update_history","current_language","is_accumulator","is_history_tab_active","is_multiplier","is_turbos","toggleHistoryTab"];function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,o,c,i=[],l=!0,s=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=o.call(r)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,n=e}finally{try{if(!l&&null!=r.return&&(c=r.return(),Object(c)!==c))return}finally{if(s)throw n}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return z(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?z(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}const I=function(e){var t=e.contract_update_history,r=e.current_language,a=e.is_accumulator,o=e.is_history_tab_active,c=e.is_multiplier,l=e.is_turbos,u=e.toggleHistoryTab,d=function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.includes(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,T),m=d.contract_info,p=m.contract_id,f=m.currency,b=A(n().useState([]),2),v=b[0],y=b[1],g=function(e){return e.sort((function(e,t){return Number(null==t?void 0:t.order_date)-Number(null==e?void 0:e.order_date)}))},h=n().useCallback((function(e){e&&i.WS.contractUpdateHistory(e).then((function(e){y(g(e.contract_update_history))})).catch((function(){return null}))}),[]);n().useEffect((function(){t.length&&t.length>v.length&&y(g(t))}),[t,v]),n().useEffect((function(){o&&r&&h(p)}),[p,o,r,h]);return c||a||l?n().createElement("div",{className:"contract-audit__wrapper"},n().createElement(_.Tabs,{top:!0,className:"contract-audit__tabs",onTabItemClick:function(e){u(!!e),e&&h(p)}},n().createElement("div",{label:(0,s.localize)("Details")},n().createElement(S,d)),n().createElement("div",{label:(0,s.localize)("History")},n().createElement(N,{currency:f,history:v})))):n().createElement("div",{className:"contract-audit__wrapper"},n().createElement(S,d))};var O=r("./src/App/Components/Elements/ContentLoader/index.ts"),M=r("react-dom"),D=r.n(M);function L(){return L=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},L.apply(null,arguments)}var j=function(e){var t=e.is_multiplier,r=e.children,a=e.onSwipedDown,o=_.SwipeableWrapper.useSwipeable({onSwipedDown:a}),c=document.getElementById("dt_contract_drawer_audit");return c?D().createPortal(n().createElement("div",{className:"contract-audit-card"},n().createElement("div",L({},o,{className:d()("contract-audit-card__container",{"contract-audit-card__container--is-multiplier":t})}),r)),c):null},F=function(e){var t=e.children,r=e.onSwipedDown,a=e.onSwipedUp,o=_.SwipeableWrapper.useSwipeable({onSwipedDown:r,onSwipedUp:a});return n().createElement("div",o,t)};const P=function(e){var t=e.validation_error;return n().createElement("div",{className:"contract-card__market-closed"},n().createElement(_.Text,{align:"center",as:"p",className:"contract-card__market-closed__title",weight:"bold"},t))};var H=r("./src/Stores/useTraderStores.tsx"),R=r("mobx-react-lite");function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,o,c,i=[],l=!0,s=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=o.call(r)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,n=e}finally{try{if(!l&&null!=r.return&&(c=r.return(),Object(c)!==c))return}finally{if(s)throw n}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return U(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?U(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}const W=(0,R.observer)((function(e){var t=e.contract_info,r=e.contract_update,a=e.currency,o=void 0===a?"":a,c=e.is_accumulator,l=e.is_collapsed,s=e.is_market_closed,u=e.is_mobile,m=e.is_multiplier,f=e.is_vanilla,b=e.is_sell_requested,v=e.is_turbos,y=e.is_lookbacks,g=e.onClickCancel,E=e.onClickSell,C=e.onSwipedUp,k=e.onSwipedDown,x=e.result,w=e.server_time,S=void 0===w?(0,i.toMoment)():w,N=e.toggleContractAuditDrawer,T=(0,p.A)(),A=T.ui,z=T.contract_trade,I=(0,H.P)().active_symbols,O=A.addToast,M=A.current_focus,D=A.removeToast,L=A.should_show_cancellation_warning,j=A.setCurrentFocus,R=A.toggleCancellationWarning,U=z.getContractById,W=B((0,_.useHover)(),2),q=W[0],Y=W[1],V=(0,h.Y)().isMobile,G=t.profit,$=t.validation_error,K=!!(0,i.getEndTime)(t),Q=(0,i.getSymbolDisplayName)(I,(0,i.getMarketInformation)(t.shortcode||"").underlying),X=(0,i.isCryptoContract)(t.underlying),J=!m||X&&m,Z=n().createElement(_.ContractCard.Header,{contract_info:t,display_name:Q,getCardLabels:i.getCardLabels,getContractTypeDisplay:i.getContractTypeDisplay,has_progress_slider:(0,i.isDesktop)()&&J,is_mobile:u,is_sell_requested:b,is_sold:K,onClickSell:E,server_time:S}),ee=n().createElement(_.ContractCard.Body,{addToast:O,contract_info:t,contract_update:r,currency:o,current_focus:null!=M?M:"",getCardLabels:i.getCardLabels,getContractById:U,is_accumulator:c,is_mobile:u,is_multiplier:m,is_sold:K,is_turbos:v,is_vanilla:f,is_lookbacks:y,has_progress_slider:u&&J,removeToast:D,server_time:S,setCurrentFocus:j,should_show_cancellation_warning:L,toggleCancellationWarning:R}),te=n().createElement(_.ContractCard.Footer,{contract_info:t,getCardLabels:i.getCardLabels,is_multiplier:m,is_lookbacks:y,is_sell_requested:b,onClickCancel:g,onClickSell:E,server_time:S}),re=n().createElement(n().Fragment,null,Z,ee),ae=n().createElement(_.ContractCard,{contract_info:t,getCardLabels:i.getCardLabels,is_multiplier:m,profit_loss:Number(G),should_show_result_overlay:!1},n().createElement("div",{className:d()("dc-contract-card",{"dc-contract-card--green":Number(G)>0&&!x,"dc-contract-card--red":Number(G)<0&&!x,"contract-card__market-closed--disabled":s&&Y}),ref:q},s&&!(0,i.getEndTime)(t)&&n().createElement("div",{className:d()({"contract-card__market-closed--hidden":(0,i.isDesktop)()&&Y})},n().createElement(P,{validation_error:$})),re,te));return V?n().createElement(F,{onSwipedUp:C,onSwipedDown:k},n().createElement(_.Collapsible.ArrowButton,{onClick:N,is_collapsed:l}),ae):ae}));function q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,o,c,i=[],l=!0,s=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=o.call(r)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,n=e}finally{try{if(!l&&null!=r.return&&(c=r.return(),Object(c)!==c))return}finally{if(s)throw n}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Y(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Y(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}var V=["iOS","unknown"].includes((0,i.mobileOSDetect)())?0:13,G=(0,R.observer)((function(e){var t,r=e.contract_info,a=void 0===r?{}:r,o=e.contract_update,l=e.contract_update_history,s=e.is_accumulator,u=e.is_sell_requested,m=e.is_dark_theme,f=e.is_market_closed,b=e.is_multiplier,v=e.is_turbos,y=e.is_vanilla,g=e.is_lookbacks,E=e.onClickCancel,C=e.onClickSell,k=e.toggleHistoryTab,x=(0,p.A)(),w=x.common,S=x.ui,N=w.current_language,T=w.is_language_changing,A=w.server_time,z=S.is_history_tab_active,M=a.currency,D=a.exit_tick_display_value,L=n().useRef(null),F=n().useRef(null),P=q(n().useState(!1),2),H=P[0],R=P[1],B=(0,h.Y)().isMobile,U=n().createElement(I,{contract_end_time:(0,i.getEndTime)(a),contract_info:a,contract_update_history:l,duration_unit:null!==(t=(0,i.getDurationUnitText)((0,i.getDurationPeriod)(a)))&&void 0!==t?t:"",duration:(0,i.getDurationTime)(a),exit_spot:D,is_accumulator:s,is_dark_theme:m,is_history_tab_active:z,is_multiplier:b,is_open:!0,is_turbos:v,is_vanilla:y,current_language:T?"":N,toggleHistoryTab:k});if((0,i.isEmptyObject)(a))return null;var Y,G=a.status||a.is_expired?n().createElement(n().Fragment,null,n().createElement(W,{contract_info:a,contract_update:o,currency:M,is_accumulator:s,is_mobile:B,is_market_closed:f,is_multiplier:b,is_turbos:v,is_vanilla:y,is_sell_requested:u,is_lookbacks:g,is_collapsed:H,onClickCancel:E,onClickSell:C,onSwipedUp:function(){return R(!0)},onSwipedDown:function(){return R(!1)},server_time:A,toggleContractAuditDrawer:function(){return R(!H)}}),!B&&U):n().createElement("div",{className:"contract-card"},n().createElement(O.Y,{speed:2})),$=n().createElement(c.A,{in:H,timeout:250,classNames:"contract-drawer__transition"},n().createElement("div",{id:"dt_contract_drawer",className:d()("contract-drawer",{"contract-drawer--with-collapsible-btn":!!(0,i.getEndTime)(a)||B,"contract-drawer--is-multiplier":b&&B,"contract-drawer--is-multiplier-sold":b&&B&&(0,i.getEndTime)(a)}),style:{transform:H&&L.current&&F.current&&"translateY(calc(".concat(F.current.clientHeight,"px - ").concat(L.current.clientHeight,"px + ").concat(V,"px))")},ref:L},n().createElement("div",{className:"contract-drawer__body",ref:F},G),H&&B&&n().createElement("div",{id:"dt_contract_drawer_audit"},n().createElement(j,{is_multiplier:b},U))));return B?n().createElement("div",{style:{height:null===(Y=F.current)||void 0===Y?void 0:Y.clientHeight}},n().createElement(_.Div100vhContainer,{height_offset:"40px",is_bypassed:!F.current},$)):$}));const $=(0,o.withRouter)(G);var K=r("./src/Modules/Contract/Containers/contract-replay-widget.tsx"),Q=r("./src/Modules/Contract/Containers/replay-chart.tsx");function X(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,o,c,i=[],l=!0,s=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=o.call(r)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){s=!0,n=e}finally{try{if(!l&&null!=r.return&&(c=r.return(),Object(c)!==c))return}finally{if(s)throw n}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return J(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?J(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}const Z=(0,R.observer)((function(e){var t,r=e.contract_id,a=(0,m.useLocation)().state,o=(0,p.A)(),c=o.common,l=o.contract_replay,u=o.ui,f=X(n().useState(0),2),b=f[0],v=f[1],y=l.contract_store,C=l.is_market_closed,k=l.is_sell_requested,x=l.onClickCancel,w=l.onClickSell,S=l.onMount,N=l.onUnmount,T=l.is_chart_loading,A=y.contract_info,z=y.contract_update,I=y.contract_update_history,O=y.is_digit_contract,M=c.routeBackInApp,D=u.is_dark_mode_on,L=u.is_mobile,j=u.notification_messages_ui,F=u.toggleHistoryTab,P=A.shortcode&&(0,i.getContractTypeFeatureFlag)(null!==(t=A.contract_type)&&void 0!==t?t:"",(0,i.isHighLow)(A)),H=!1===g()["is_".concat(P,"_enabled")],R=X(n().useState(!1),2),B=R[0],U=R[1],W=(0,m.useHistory)(),q=(0,h.Y)().isMobile;n().useEffect((function(){var e=/[^/]*$/.exec(location.pathname),t=e?+e[0]:void 0;return S(r||t),U(!0),function(){U(!1),N()}}),[r,location,S,N]);var Y=n().useCallback((function(){return U(!1),!(0,i.isEmptyObject)(a)&&a.from_table_row?W.goBack():M(W)}),[W,M]);n().useEffect((function(){H&&B&&Y()}),[H,B,Y]);if(!A.underlying)return null;var V=(0,i.isAccumulatorContract)(A.contract_type),G=(0,i.isMultiplierContract)(A.contract_type),J=(0,i.isTurbosContract)(A.contract_type),Z=(0,i.isVanillaContract)(A.contract_type),ee=(0,i.isResetContract)(A.contract_type),te=(0,i.isLookBacksContract)(A.contract_type),re=n().createElement($,{contract_info:A,contract_update:z,contract_update_history:I,is_accumulator:V,is_dark_theme:D,is_market_closed:C,is_multiplier:G,is_turbos:J,is_sell_requested:k,is_vanilla:Z,is_lookbacks:te,onClickCancel:x,onClickSell:w,toggleHistoryTab:F});return q?n().createElement(_.FadeWrapper,{is_visible:B,className:"contract-details-wrapper",keyname:"contract-details-wrapper"},n().createElement(j,null),n().createElement(_.PageOverlay,{id:"dt_contract_replay_container",header:n().createElement(s.Localize,{i18n_default_text:"Contract details"}),onClickClose:Y},n().createElement(_.Div100vhContainer,{className:"trade-container__replay",height_offset:"80px"},n().createElement("div",{className:d()("contract-drawer__mobile-wrapper",{"contract-drawer__mobile-wrapper--is-multiplier":L&&G}),"data-testid":"dt_contract_drawer_mobile_wrapper"},re),n().createElement(n().Suspense,{fallback:n().createElement("div",null)},n().createElement("div",{className:d()("replay-chart__container",{"replay-chart__container--is-multiplier":L&&G,"vanilla-trade-chart":Z}),"data-testid":"dt_replay_chart_container"},n().createElement(E.A,{is_dark:D,is_visible:T}),O?n().createElement(n().Fragment,null,n().createElement(K.WN,null),n().createElement(_.SwipeableWrapper,{className:"replay-chart__container-swipeable-wrapper","data-testid":"dt_replay_chart_swipeable_wrapper",is_swipe_disabled:1===b,onChange:function(e){v(e)}},n().createElement(K.$i,null),n().createElement(Q.A,null))):n().createElement(Q.A,{is_dark_theme_prop:D,is_accumulator_contract:V,is_reset_contract:ee})))))):n().createElement(_.FadeWrapper,{is_visible:B,className:"contract-details-wrapper",keyname:"contract-details-wrapper"},n().createElement(_.PageOverlay,{id:"dt_contract_replay_container",header:n().createElement(s.Localize,{i18n_default_text:"Contract details"}),onClickClose:Y},n().createElement("div",{className:"trade-container__replay"},re,n().createElement(n().Suspense,{fallback:n().createElement("div",null)},n().createElement("div",{className:d()("replay-chart__container",{"replay-chart__container--is-multiplier":L&&G,"vanilla-trade-chart":Z}),"data-testid":"dt_replay_chart_container"},n().createElement(j,null),n().createElement(E.A,{is_dark:D,is_visible:T}),n().createElement(Q.A,{is_dark_theme_prop:D,is_accumulator_contract:V,is_reset_contract:ee}))))))}));var ee=["GetProposalFailure","ContractValidationError"],te=(0,R.observer)((function(e){var t=e.match,r=e.history,a=(0,p.A)().contract_replay,u=a.removeErrorMessage,d=a.error_message,m=a.error_code,_=a.has_error,f=a.removeAccountSwitcherListener,b=a.setAccountSwitcherListener;return n().useEffect((function(){return b(+t.params.contract_id,r),function(){u(),f()}}),[b,f,u,r,t.params.contract_id]),isNaN(Number(t.params.contract_id))?n().createElement(o.Redirect,{to:"/404"}):n().createElement(n().Fragment,null,_?n().createElement(l.default,{"data-testid":"dt_error_component",message:d,is_dialog:ee.includes(null!=m?m:""),redirect_label:ee.includes(null!=m?m:"")?(0,s.localize)("Ok"):(0,s.localize)("Go back to trading"),redirectOnClick:function(){return r.push(i.routes.trade)},should_show_refresh:!1}):n().createElement(c.A,{in:!_,timeout:400,classNames:{enter:"contract--enter",enterDone:"contract--enter-done",exit:"contract--exit"},unmountOnExit:!0},n().createElement(Z,{contract_id:+t.params.contract_id,key:+t.params.contract_id})))}));const re=(0,o.withRouter)(te)},"./src/Stores/Modules/Trading/Helpers/logic.ts":(e,t,r)=>{r.d(t,{d:()=>n});var a=r("./src/_common/base/server_time.ts"),n=function(e){var t;return!(null===(t=e.cancellation)||void 0===t||!t.date_expiry)&&e.cancellation.date_expiry<a.A.get().unix()}}}]);
//# sourceMappingURL=trader.contract.8180b7d5db63af441096.js.map